<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-144561796-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-144561796-1');
    </script>
    
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    <title>3. Azure Kubernetes Service &#8212; Documentation  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fe63c2af" />
    <link rel="stylesheet" type="text/css" href="../../_static/option.css?v=49ab891d" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/tabs.css?v=a5c4661c" />
    <link rel="stylesheet" type="text/css" href="../../_static/exastro_documents.css?v=99e5f627" />
    <link rel="stylesheet" type="text/css" href="../../_static/swagger/swagger-ui.css?v=ab82c586" />
    
    <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=3e58b9f8"></script>
    <script src="../../_static/jquery-3.6.3.min.js?v=25455f10"></script>
    <script src="../../_static/exastro_documents.js?v=ff50fb31"></script>
    <script src="../../_static/swagger/swagger-ui-bundle.js?v=ec73a32a"></script>
    <script src="../../_static/swagger/swagger-ui-standalone-preset.js?v=88d26966"></script>
    <link rel="icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Ansible" href="../ansible/index.html" />
    <link rel="prev" title="2. Kubernetes cluster" href="kubernetes.html" /> 
  </head>
<body id="page" class="en">


<div id="container">

<div id="header">
  <header class="divInner">
    <!-- Exastro logo -->
    <div id="logo"><a href="https://ita.exastro.org/"><img src="../../_static/img/exastro.svg" alt="Exastro"></a></div>
    <!-- Project name -->
    <div id="projectName"><a href="../../index.html">Documentation</a></div>
    <!-- Heaedr navigation -->
    <div id="headerSearch">
      <form class="search" action="../../search.html" method="get">
        <input type="text" name="q" aria-labelledby="searchlabel">
        <button type="submit" value="Go"><img src="../../_static/img/search.png" alt="Go"></button>
      </form>
    </div>
  </header>
</div><!-- End #header -->


<div id="toolbar">
  <div class="divInner">
    
    <div id="documentVersion">
      <dl>
        <dt>Document version</dt>
        <dd>
          <div>
            <select name="version" style="height: 20px;" onchange="location.href=value;">
              <option value="../../../../en/2.7/configuration/kubernetes/aks.html">current</option>
              <option value="../../../../en/2.7/configuration/kubernetes/aks.html">2.7(current)</option>
              <option value="../../../../en/2.6/configuration/kubernetes/aks.html">2.6</option>
              <option value="../../../../en/2.5/configuration/kubernetes/aks.html" selected>2.5</option>
              <option value="../../../../en/2.4/configuration/kubernetes/aks.html">2.4</option>
              <option value="../../../../en/2.3/configuration/kubernetes/aks.html">2.3</option>
              <option value="../../../../en/2.2/configuration/kubernetes/aks.html">2.2</option>
              <option value="../../../../en/2.1/configuration/kubernetes/aks.html">2.1</option>
              <option value="../../../../en/2.0/configuration/kubernetes/aks.html">2.0</option>
            </select>
          </div>
        </dd>
      </dl>
    </div>

    <div id="documentLanguage">
      <dl>
        <dt>Language</dt>
        <dd>
          <div>
            <select name="lang" style="height: 20px;" onchange="location.href=value;">
              <option value="../../../../ja/2.5/configuration/kubernetes/aks.html">日本語</option>
              <option value="../../../../en/2.5/configuration/kubernetes/aks.html" selected>English</option>
            </select>
          </div>
        </dd>
      </dl>
    </div>
    <div id="toolbarNavigation">
      <ul>
        <li class="prev"><a href="kubernetes.html" title="Previous topic"><span class="section-number">2. </span>Kubernetes cluster</a></li>
        <li class="next"><a href="../ansible/index.html" title="Next topic">Ansible</a></li>
      </ul>
    </div>
  </div>
</div><!-- End #toolbar -->

<div id="sideMenu">

  <div id="menuButton"></div>
  
  <aside class="divInner">
    <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Configuration and Construction guides</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Kubernetes</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="overview.html">1. Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="kubernetes.html">2. Kubernetes cluster</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">3. Azure Kubernetes Service</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#introduction">3.1. Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="#prerequisites">3.2. Prerequisites</a></li>
<li class="toctree-l4"><a class="reference internal" href="#aks-cluster-configuration">3.3. AKS cluster configuration</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#aks-cluster-example">3.3.1. AKS cluster example</a></li>
<li class="toctree-l5"><a class="reference internal" href="#confirm-domain-name">3.3.2. Confirm Domain name</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../ansible/index.html">Ansible</a></li>
<li class="toctree-l2"><a class="reference internal" href="../terraform/index.html">Terraform</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../installation/index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../learn/index.html">Learn</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../glossary/index.html">Glossary</a></li>
</ul>

    <!-- <ul>
      <li class="toctree-l1"><a class="reference internal" href="../../../../genindex.html">索引</a></li>
    </ul> -->
    
  </aside>
</div><!-- End #sideMenu -->


<div id="tableOfContents">
  <div id="tocButton"></div>
  <ul>
<li><a class="reference internal" href="#">3. Azure Kubernetes Service</a><ul>
<li><a class="reference internal" href="#introduction">3.1. Introduction</a></li>
<li><a class="reference internal" href="#prerequisites">3.2. Prerequisites</a></li>
<li><a class="reference internal" href="#aks-cluster-configuration">3.3. AKS cluster configuration</a><ul>
<li><a class="reference internal" href="#aks-cluster-example">3.3.1. AKS cluster example</a></li>
<li><a class="reference internal" href="#confirm-domain-name">3.3.2. Confirm Domain name</a></li>
</ul>
</li>
</ul>
</li>
</ul>

</div>


<div id="contents">
<main class="divInner">

 <div id="breadcrumbs">
  <ul>
    <li><a href="../../index.html">HOME</a></li>
    <li><a href="../index.html">Configuration and Construction guides</a></li>
    <li><a href="index.html">Kubernetes</a></li>
    
    <li><span class="section-number">3. </span>Azure Kubernetes Service</li>
  </ul>
</div>

<div id="article">
<article class="divInner">
<div class="body" role="main">

  <section id="azure-kubernetes-service">
<h1><span class="section-number">3. </span>Azure Kubernetes Service<a class="headerlink" href="#azure-kubernetes-service" title="Link to this heading">¶</a></h1>
<section id="introduction">
<h2><span class="section-number">3.1. </span>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">¶</a></h2>
<div class="line-block">
<div class="line">This guide aims to explain how to set up Azure Kubernetes Service (AKS) cluster where Exastro IT Automation will be deployed.</div>
</div>
</section>
<section id="prerequisites">
<h2><span class="section-number">3.2. </span>Prerequisites<a class="headerlink" href="#prerequisites" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>Azure CLI must be available.</p></li>
<li><p>The user must have permission to do the actions written in this manual.</p></li>
</ul>
</section>
<section id="aks-cluster-configuration">
<h2><span class="section-number">3.3. </span>AKS cluster configuration<a class="headerlink" href="#aks-cluster-configuration" title="Link to this heading">¶</a></h2>
<section id="aks-cluster-example">
<h3><span class="section-number">3.3.1. </span>AKS cluster example<a class="headerlink" href="#aks-cluster-example" title="Link to this heading">¶</a></h3>
<div class="line-block">
<div class="line">This section serves as an example on how to create an AKS cluster in order to connect to the Exastro Suite deployed to the AKS environment</div>
<div class="line">Make sure to check settings and input values suited for your own environment.</div>
</div>
<ol class="arabic">
<li><p>Start</p>
<div class="line-block">
<div class="line">This section explains how to configure External IP and register DNS to the Exastro Platform service so it access through the internet.</div>
<div class="line">This guide will also contain steps on how to create a Public IP prefix, as it is required in order to confiure External IPs.</div>
<div class="line">While there are way to create Public IP Prefixes using GUI, this guide will show you how to do it using Azure CLI.</div>
</div>
</li>
<li><p>Configure Variables</p>
<div class="line-block">
<div class="line">Define parameters when creating the clsuter.</div>
</div>
<table class="docutils align-default">
<colgroup>
<col style="width: 50.0%" />
<col style="width: 50.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Variable</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>RESOURCE_GROUP</p></td>
<td><p>Name of the resource group</p></td>
</tr>
<tr class="row-odd"><td><p>CLUSTER_NAME</p></td>
<td><p>Name of AKS cluster</p></td>
</tr>
<tr class="row-even"><td><p>PUBLIC_IP_PREFIX_NAME</p></td>
<td><p>Public IP Prefix name</p></td>
</tr>
<tr class="row-odd"><td><p>AUTHORIZED_IP_RANGES</p></td>
<td><p>Set Source IP Address</p></td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line">Configure the variables needed in order to run commands.</div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<div class="line-block">
<div class="line">The following parameters are examples. Change the values to fit your environment.</div>
</div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Name of the resource group</span>
<span class="nv">RESOURCE_GROUP</span><span class="o">=</span>exastro-suite-group
<span class="c1"># Name of AKS cluster</span>
<span class="nv">CLUSTER_NAME</span><span class="o">=</span>exastro-suite

<span class="c1"># Public IP Prefix name</span>
<span class="nv">PUBLIC_IP_PREFIX_NAME</span><span class="o">=</span><span class="si">${</span><span class="nv">CLUSTER_NAME</span><span class="si">}</span>-ipprefix
<span class="c1"># Set Source IP Address</span>
<span class="nv">AUTHORIZED_IP_RANGES</span><span class="o">=</span>xxx.xxx.xxx.xxx/31
</pre></div>
</div>
</li>
<li><p>Create Public IP Prefix.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Issue Public IP Address</span>
az<span class="w"> </span>network<span class="w"> </span>public-ip<span class="w"> </span>prefix<span class="w"> </span>create<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--resource-group<span class="w"> </span><span class="si">${</span><span class="nv">RESOURCE_GROUP</span><span class="si">}</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--name<span class="w"> </span><span class="si">${</span><span class="nv">PUBLIC_IP_PREFIX_NAME</span><span class="si">}</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--length<span class="w"> </span><span class="m">31</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--location<span class="w"> </span>japaneast

<span class="c1"># Store Public IP Prefix results in Variables</span>
<span class="nv">PUBLIC_IP_PREFIX_ID</span><span class="o">=</span><span class="k">$(</span>az<span class="w"> </span>network<span class="w"> </span>public-ip<span class="w"> </span>prefix<span class="w"> </span>show<span class="w"> </span>--resource-group<span class="w"> </span><span class="si">${</span><span class="nv">RESOURCE_GROUP</span><span class="si">}</span><span class="w"> </span>--name<span class="w"> </span><span class="si">${</span><span class="nv">PUBLIC_IP_PREFIX_NAME</span><span class="si">}</span><span class="w"> </span>--query<span class="w"> </span>id<span class="w"> </span>--output<span class="w"> </span>tsv<span class="k">)</span>
<span class="nv">AUTHORIZED_IP_RANGES</span><span class="o">+=</span>,<span class="k">$(</span>az<span class="w"> </span>network<span class="w"> </span>public-ip<span class="w"> </span>prefix<span class="w"> </span>show<span class="w"> </span>--resource-group<span class="w"> </span><span class="si">${</span><span class="nv">RESOURCE_GROUP</span><span class="si">}</span><span class="w"> </span>--name<span class="w"> </span><span class="si">${</span><span class="nv">PUBLIC_IP_PREFIX_NAME</span><span class="si">}</span><span class="w"> </span>--query<span class="w"> </span>ipPrefix<span class="w"> </span>--output<span class="w"> </span>tsv<span class="k">)</span>
</pre></div>
</div>
</li>
<li><p>Create AKS cluster</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create AKS cluster</span>
az<span class="w"> </span>aks<span class="w"> </span>create<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--resource-group<span class="w"> </span><span class="si">${</span><span class="nv">RESOURCE_GROUP</span><span class="si">}</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--name<span class="w"> </span><span class="si">${</span><span class="nv">CLUSTER_NAME</span><span class="si">}</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--generate-ssh-keys<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--kubernetes-version<span class="w"> </span><span class="m">1</span>.23.8<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--node-count<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--node-vm-size<span class="w"> </span>Standard_D4a_v4<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--os-sku<span class="w"> </span>Ubuntu<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--enable-node-public-ip<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--node-public-ip-prefix-id<span class="w"> </span><span class="si">${</span><span class="nv">PUBLIC_IP_PREFIX_ID</span><span class="si">}</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--enable-addons<span class="w"> </span>http_application_routing<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--api-server-authorized-ip-ranges<span class="w"> </span><span class="si">${</span><span class="nv">AUTHORIZED_IP_RANGES</span><span class="si">}</span>
</pre></div>
</div>
</li>
</ol>
</section>
<section id="confirm-domain-name">
<span id="aks-dns"></span><h3><span class="section-number">3.3.2. </span>Confirm Domain name<a class="headerlink" href="#confirm-domain-name" title="Link to this heading">¶</a></h3>
<div class="line-block">
<div class="line">Check the domain name in order to connect to the AKS cluster from the internet.</div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Gather domain name configured to AKS cluster</span>
az<span class="w"> </span>aks<span class="w"> </span>show<span class="w"> </span>-g<span class="w"> </span><span class="si">${</span><span class="nv">RESOURCE_GROUP</span><span class="si">}</span><span class="w"> </span>-n<span class="w"> </span><span class="si">${</span><span class="nv">CLUSTER_NAME</span><span class="si">}</span><span class="w"> </span>--query<span class="w"> </span>addonProfiles.httpApplicationRouting.config.HTTPApplicationRoutingZoneName<span class="w"> </span>-o<span class="w"> </span>table
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Result</span>
<span class="o">----------------------------------------</span>
<span class="n">xxxxxxx</span><span class="o">.</span><span class="n">japaneast</span><span class="o">.</span><span class="n">aksapp</span><span class="o">.</span><span class="n">io</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">※The output domain will also be used in configurations when using Ingress.</div>
</div>
<div class="line-block">
<div class="line">When the AKS cluster configuration has finished, follow the  <a class="reference internal" href="../../installation/online/exastro/kubernetes.html"><span class="doc">Helm chart (Kubernetes) - Online</span></a> manual and install Exastro IT Automation.</div>
</div>
</section>
</section>
</section>


</div>


<div id="articleNavigation">
  <ul>
    <li class="prev"><a href="kubernetes.html" title="Previous topic"><span>Previous topic</span><span class="section-number">2. </span>Kubernetes cluster</a></li>
    <li class="next"><a href="../ansible/index.html" title="Next topic"><span>Next topic</span>Ansible</a></li>
  </ul>
</div>


<div id="pageTopLink">
  <a href="#container"><i>↑</i> Page Top</a>
</div>

</article>
</div>
</main>
</div><!-- End #contents -->
<div id="footer">
  <footer class="divInner">
    <small>Copyright © 2019-2025 NEC Corporation</small>
    <small><a href="/en/2.5/terms/en.html">サイト規約</a></small>
  </footer>
</div><!-- End #footer -->

<div id="overlay"></div>
<div id="grayBack"></div>

</div><!-- End #container -->
  </body>
</html>