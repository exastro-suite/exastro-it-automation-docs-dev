<!DOCTYPE html>

<html lang="ja" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-144561796-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-144561796-1');
    </script>
    
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    <title>1. Ansible共通 &#8212; Documentation  ドキュメント</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fe63c2af" />
    <link rel="stylesheet" type="text/css" href="../../_static/option.css?v=49ab891d" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/tabs.css?v=a5c4661c" />
    <link rel="stylesheet" type="text/css" href="../../_static/exastro_documents.css?v=99e5f627" />
    <link rel="stylesheet" type="text/css" href="../../_static/swagger/swagger-ui.css?v=ab82c586" />
    
    <script src="../../_static/documentation_options.js?v=c033477b"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=3e58b9f8"></script>
    <script src="../../_static/translations.js?v=4755f45a"></script>
    <script src="../../_static/jquery-3.6.3.min.js?v=25455f10"></script>
    <script src="../../_static/exastro_documents.js?v=ff50fb31"></script>
    <script src="../../_static/swagger/swagger-ui-bundle.js?v=ec73a32a"></script>
    <script src="../../_static/swagger/swagger-ui-standalone-preset.js?v=88d26966"></script>
    <link rel="icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="検索" href="../../search.html" />
    <link rel="next" title="2. Ansible-Legacy" href="ansible_legacy.html" />
    <link rel="prev" title="Ansible ドライバ" href="index.html" /> 
  </head>
<body id="page" class="ja">


<div id="container">

<div id="header">
  <header class="divInner">
    <!-- Exastro logo -->
    <div id="logo"><a href="https://ita.exastro.org/"><img src="../../_static/img/exastro.svg" alt="Exastro"></a></div>
    <!-- Project name -->
    <div id="projectName"><a href="../../index.html">Documentation</a></div>
    <!-- Heaedr navigation -->
    <div id="headerSearch">
      <form class="search" action="../../search.html" method="get">
        <input type="text" name="q" aria-labelledby="searchlabel">
        <button type="submit" value="検索"><img src="../../_static/img/search.png" alt="検索"></button>
      </form>
    </div>
  </header>
</div><!-- End #header -->


<div id="toolbar">
  <div class="divInner">
    
    <div id="documentVersion">
      <dl>
        <dt>Document version</dt>
        <dd>
          <div>
            <select name="version" style="height: 20px;" onchange="location.href=value;">
              <option value="../../../../ja/2.6/manuals/ansible-driver/ansible_common.html">current</option>
              <option value="../../../../ja/2.6/manuals/ansible-driver/ansible_common.html">2.6(current)</option>
              <option value="../../../../ja/2.5/manuals/ansible-driver/ansible_common.html" selected>2.5</option>
              <option value="../../../../ja/2.4/manuals/ansible-driver/ansible_common.html">2.4</option>
              <option value="../../../../ja/2.3/manuals/ansible-driver/ansible_common.html">2.3</option>
              <option value="../../../../ja/2.2/manuals/ansible-driver/ansible_common.html">2.2</option>
              <option value="../../../../ja/2.1/manuals/ansible-driver/ansible_common.html">2.1</option>
              <option value="../../../../ja/2.0/manuals/ansible-driver/ansible_common.html">2.0</option>
            </select>
          </div>
        </dd>
      </dl>
    </div>

    <div id="documentLanguage">
      <dl>
        <dt>Language</dt>
        <dd>
          <div>
            <select name="lang" style="height: 20px;" onchange="location.href=value;">
              <option value="../../../../ja/2.5/manuals/ansible-driver/ansible_common.html" selected>日本語</option>
              <option value="../../../../en/2.5/manuals/ansible-driver/ansible_common.html">English</option>
            </select>
          </div>
        </dd>
      </dl>
    </div>
    <div id="toolbarNavigation">
      <ul>
        <li class="prev"><a href="index.html" title="前のトピックへ">Ansible ドライバ</a></li>
        <li class="next"><a href="ansible_legacy.html" title="次のトピックへ"><span class="section-number">2. </span>Ansible-Legacy</a></li>
      </ul>
    </div>
  </div>
</div><!-- End #toolbar -->

<div id="sideMenu">

  <div id="menuButton"></div>
  
  <aside class="divInner">
    <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../configuration/index.html">構成・構築ガイド</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation/index.html">インストール</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../learn/index.html">Learn</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">マニュアル</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../client_requirements/index.html">クライアント動作要件</a></li>
<li class="toctree-l2"><a class="reference internal" href="../platform_management/index.html">システム管理</a></li>
<li class="toctree-l2"><a class="reference internal" href="../organization_management/index.html">オーガナイゼーション管理</a></li>
<li class="toctree-l2"><a class="reference internal" href="../it_automation_base/index.html">基本操作</a></li>
<li class="toctree-l2"><a class="reference internal" href="../create_param/index.html">パラメータ管理</a></li>
<li class="toctree-l2"><a class="reference internal" href="../host_group/index.html">ホストグループ</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Ansible ドライバ</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">1. Ansible共通</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">1.1. はじめに</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ansible-driver">1.2. Ansible driver概要</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#ansible-core">1.2.1. Ansible Coreについて</a></li>
<li class="toctree-l5"><a class="reference internal" href="#ansible-automation-controller">1.2.2. Ansible Automation Controllerについて</a></li>
<li class="toctree-l5"><a class="reference internal" href="#ansible-execution-agent">1.2.3. Ansible Execution Agentについて</a></li>
<li class="toctree-l5"><a class="reference internal" href="#id2">1.2.4. Ansible driverについて</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#ansible-common-variable-handling">1.3. Ansible driverでの変数取り扱い</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#id4">1.3.1. 変数の種類</a></li>
<li class="toctree-l5"><a class="reference internal" href="#id14">1.3.2. 変数の抜出および具体値登録</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#id19">1.4. Ansible共通メニュー構成</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#id20">1.4.1. メニュー/画面一覧</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#id21">1.5. メニュー操作方法説明</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#ansible-common-device-list">1.5.1. 機器一覧</a></li>
<li class="toctree-l5"><a class="reference internal" href="#ansible-common-interface-information">1.5.2. インターフェース情報</a></li>
<li class="toctree-l5"><a class="reference internal" href="#ansible-common-ansible-automation-controller-hosts">1.5.3. Ansible Automation Controller ホスト一覧</a></li>
<li class="toctree-l5"><a class="reference internal" href="#ansible-common-global-variable-list">1.5.4. グローバル変数管理</a></li>
<li class="toctree-l5"><a class="reference internal" href="#ansible-common-file-list">1.5.5. ファイル管理</a></li>
<li class="toctree-l5"><a class="reference internal" href="#ansible-common-template-list">1.5.6. テンプレート管理</a></li>
<li class="toctree-l5"><a class="reference internal" href="#ansible-execution-environment-definition-template-list">1.5.7. 実行環境定義テンプレート管理</a></li>
<li class="toctree-l5"><a class="reference internal" href="#ansible-execution-environment-list">1.5.8. 実行環境管理</a></li>
<li class="toctree-l5"><a class="reference internal" href="#ansible-agent-list">1.5.9. エージェント管理</a></li>
<li class="toctree-l5"><a class="reference internal" href="#ansible-common-unmanaged-var-list">1.5.10. 管理対象外変数リスト</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#id32">1.6. 付録</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#ansible-common-environment-definition-make">1.6.1. <span class="menuselection">Ansible共通 ▶ 実行環境定義テンプレート管理</span> に登録するテンプレートファイルと <span class="menuselection">パラメータシート「実行環境パラメータ定義」</span> の使用方法</a></li>
<li class="toctree-l5"><a class="reference internal" href="#backyard">1.6.2. BackYardコンテンツ</a></li>
<li class="toctree-l5"><a class="reference internal" href="#ansible-common-inventory-file">1.6.3. ITAが作成するインベントリファイル</a></li>
<li class="toctree-l5"><a class="reference internal" href="#ansible-common-option-parameter-list">1.6.4. オプションパラメータ一覧</a></li>
<li class="toctree-l5"><a class="reference internal" href="#ansible-common-aac-resources-list">1.6.5. 実行時データ削除で削除されるデータリソース</a></li>
<li class="toctree-l5"><a class="reference internal" href="#ansible-automation-controllerita">1.6.6. Ansible Automation ControllerでITA独自変数を利用する場合の留意事項</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ansible_legacy.html">2. Ansible-Legacy</a></li>
<li class="toctree-l3"><a class="reference internal" href="ansible_pioneer.html">3. Ansible-Pioneer</a></li>
<li class="toctree-l3"><a class="reference internal" href="ansible_legacyrole.html">4. Ansible-LegacyRole</a></li>
<li class="toctree-l3"><a class="reference internal" href="collect.html">5. 収集機能</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../terraform_driver/index.html">Terraform ドライバ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../export_import/index.html">エクスポート・インポート</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cicd_for_iac/index.html">CI/CD for IaC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../oase/index.html">OASE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/index.html">API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../maintenance/index.html">メンテナンス</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../templates/index.html">テンプレート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/index.html">リファレンス</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contribute/index.html">貢献</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../kb/index.html">ナレッジベース</a></li>
</ul>

    <!-- <ul>
      <li class="toctree-l1"><a class="reference internal" href="../../../../genindex.html">索引</a></li>
    </ul> -->
    
  </aside>
</div><!-- End #sideMenu -->


<div id="tableOfContents">
  <div id="tocButton"></div>
  <ul>
<li><a class="reference internal" href="#">1. Ansible共通</a><ul>
<li><a class="reference internal" href="#id1">1.1. はじめに</a></li>
<li><a class="reference internal" href="#ansible-driver">1.2. Ansible driver概要</a><ul>
<li><a class="reference internal" href="#ansible-core">1.2.1. Ansible Coreについて</a></li>
<li><a class="reference internal" href="#ansible-automation-controller">1.2.2. Ansible Automation Controllerについて</a></li>
<li><a class="reference internal" href="#ansible-execution-agent">1.2.3. Ansible Execution Agentについて</a></li>
<li><a class="reference internal" href="#id2">1.2.4. Ansible driverについて</a></li>
</ul>
</li>
<li><a class="reference internal" href="#ansible-common-variable-handling">1.3. Ansible driverでの変数取り扱い</a><ul>
<li><a class="reference internal" href="#id4">1.3.1. 変数の種類</a><ul>
<li><a class="reference internal" href="#id5">通常変数</a></li>
<li><a class="reference internal" href="#id6">複数具体値変数</a></li>
<li><a class="reference internal" href="#id7">多段変数</a></li>
<li><a class="reference internal" href="#id8">グローバル変数</a></li>
<li><a class="reference internal" href="#id9">テンプレート埋込変数</a></li>
<li><a class="reference internal" href="#id10">ファイル埋込変数</a></li>
<li><a class="reference internal" href="#ita">ITA独自変数</a><ul>
<li><a class="reference internal" href="#id11">機器一覧</a></li>
<li><a class="reference internal" href="#movement-id">Movement ID</a></li>
<li><a class="reference internal" href="#id12">オペレーション</a></li>
<li><a class="reference internal" href="#id">作業インスタンスID</a></li>
<li><a class="reference internal" href="#conductorid">ConductorインスタンスID</a></li>
<li><a class="reference internal" href="#id13">データ連携</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#id14">1.3.2. 変数の抜出および具体値登録</a><ul>
<li><a class="reference internal" href="#ansible-common-var-listup">変数抜出対象資材</a><ul>
<li><a class="reference internal" href="#playbook">Playbook素材で変数抜出の対象となる変数の種類と書式</a></li>
<li><a class="reference internal" href="#ansible-common-pioneer-var-listup">対話ファイル素材で変数抜出の対象となる変数の種類と書式</a></li>
<li><a class="reference internal" href="#zip">ロールパッケージファイル（ZIP形式）で変数抜出の対象となる変数の種類と書式</a></li>
<li><a class="reference internal" href="#ansible-common-option-var-listup">インベントリファイル追加オプションとヘッダセクションのパラメータ値で変数抜出の対象となる変数の種類と書式</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id18">変数の具体値</a><ul>
<li><a class="reference internal" href="#ansible-legacy">Ansible-Legacy</a></li>
<li><a class="reference internal" href="#ansible-pioneer">Ansible-Pioneer</a></li>
<li><a class="reference internal" href="#ansible-legacyrole">Ansible-LegacyRole</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#id19">1.4. Ansible共通メニュー構成</a><ul>
<li><a class="reference internal" href="#id20">1.4.1. メニュー/画面一覧</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id21">1.5. メニュー操作方法説明</a><ul>
<li><a class="reference internal" href="#ansible-common-device-list">1.5.1. 機器一覧</a></li>
<li><a class="reference internal" href="#ansible-common-interface-information">1.5.2. インターフェース情報</a></li>
<li><a class="reference internal" href="#ansible-common-ansible-automation-controller-hosts">1.5.3. Ansible Automation Controller ホスト一覧</a></li>
<li><a class="reference internal" href="#ansible-common-global-variable-list">1.5.4. グローバル変数管理</a></li>
<li><a class="reference internal" href="#ansible-common-file-list">1.5.5. ファイル管理</a></li>
<li><a class="reference internal" href="#ansible-common-template-list">1.5.6. テンプレート管理</a></li>
<li><a class="reference internal" href="#ansible-execution-environment-definition-template-list">1.5.7. 実行環境定義テンプレート管理</a></li>
<li><a class="reference internal" href="#ansible-execution-environment-list">1.5.8. 実行環境管理</a></li>
<li><a class="reference internal" href="#ansible-agent-list">1.5.9. エージェント管理</a></li>
<li><a class="reference internal" href="#ansible-common-unmanaged-var-list">1.5.10. 管理対象外変数リスト</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id32">1.6. 付録</a><ul>
<li><a class="reference internal" href="#ansible-common-environment-definition-make">1.6.1. <span class="menuselection">Ansible共通 ▶ 実行環境定義テンプレート管理</span> に登録するテンプレートファイルと <span class="menuselection">パラメータシート「実行環境パラメータ定義」</span> の使用方法</a></li>
<li><a class="reference internal" href="#backyard">1.6.2. BackYardコンテンツ</a><ul>
<li><a class="reference internal" href="#ansible-common-aac-sync">Ansible Automation Controllerデータ同期</a></li>
</ul>
</li>
<li><a class="reference internal" href="#ansible-common-inventory-file">1.6.3. ITAが作成するインベントリファイル</a></li>
<li><a class="reference internal" href="#ansible-common-option-parameter-list">1.6.4. オプションパラメータ一覧</a></li>
<li><a class="reference internal" href="#ansible-common-aac-resources-list">1.6.5. 実行時データ削除で削除されるデータリソース</a><ul>
<li><a class="reference internal" href="#ansible-ansible-automation-controller"><span class="menuselection">Ansible共通 ▶ インターフェース情報</span> の <span class="menuselection">実行エンジン</span> が「Ansible Automation Controller」の場合</a></li>
<li><a class="reference internal" href="#ansible-ansible-execution-agent"><span class="menuselection">Ansible共通 ▶ インターフェース情報</span> の <span class="menuselection">実行エンジン</span> が「Ansible Execution Agent」の場合</a></li>
</ul>
</li>
<li><a class="reference internal" href="#ansible-automation-controllerita">1.6.6. Ansible Automation ControllerでITA独自変数を利用する場合の留意事項</a><ul>
<li><a class="reference internal" href="#id38">ITA独自変数を利用して作成したファイルの取り扱い</a></li>
<li><a class="reference internal" href="#id39">留意事項</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

</div>


<div id="contents">
<main class="divInner">

 <div id="breadcrumbs">
  <ul>
    <li><a href="../../index.html">HOME</a></li>
    <li><a href="../index.html">マニュアル</a></li>
    <li><a href="index.html">Ansible ドライバ</a></li>
    
    <li><span class="section-number">1. </span>Ansible共通</li>
  </ul>
</div>

<div id="article">
<article class="divInner">
<div class="body" role="main">

  <section id="ansible">
<h1><span class="section-number">1. </span>Ansible共通<a class="headerlink" href="#ansible" title="Link to this heading">¶</a></h1>
<section id="id1">
<h2><span class="section-number">1.1. </span>はじめに<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h2>
<div class="line-block">
<div class="line">本書では、Ansible driverの共通機能および操作方法について説明します。</div>
</div>
</section>
<section id="ansible-driver">
<h2><span class="section-number">1.2. </span>Ansible driver概要<a class="headerlink" href="#ansible-driver" title="Link to this heading">¶</a></h2>
<div class="line-block">
<div class="line">本章では、Ansible Core、Ansible Automation Controller、Ansible Execution AgentおよびAnsible driverについて説明します。</div>
</div>
<section id="ansible-core">
<h3><span class="section-number">1.2.1. </span>Ansible Coreについて<a class="headerlink" href="#ansible-core" title="Link to this heading">¶</a></h3>
<div class="line-block">
<div class="line">Ansible Coreとは、多数の構築管理対象に対して、アプリーケーション/システムのデプロイ作業を容易にするPF構築自動化ツールです。</div>
<div class="line">Ansible Coreは、PlaybookというYAML形式のテキストファイルに定型処理をタスクとして記述し、それをAnsible Coreに実行させることにより、さまざまな処理を実現できます。</div>
<div class="line">タスクはモジュールと呼ばれる処理プログラムと紐付いており、さまざまな機器に対する制御を行うことができます。</div>
<div class="line">Ansible Coreの詳細情報については、Ansible公式マニュアルを参照してください。</div>
</div>
</section>
<section id="ansible-automation-controller">
<h3><span class="section-number">1.2.2. </span>Ansible Automation Controllerについて<a class="headerlink" href="#ansible-automation-controller" title="Link to this heading">¶</a></h3>
<div class="line-block">
<div class="line">Ansible Automation Controllerとは、PF構築自動化ツールであるAnsibleにアクセスコントロール、ジョブスケジューリング、タスクの可視化などの機能を拡張した管理プラットフォームです。</div>
<div class="line">“プロジェクト”、”インベントリ”、”認証情報”の組合せで”ジョブテンプレート”を作成しAnsibleを実行できます。</div>
<div class="line">複数の“ジョブテンプレート”を組み合せて”ワークフロージョブテンプレート”を作成することによって、より多彩な作業フローを表現することができます。</div>
<div class="line">Ansible Automation Controllerの詳細情報については、Ansible Automation Controller公式マニュアルを参照してください。</div>
<div class="line">ITAで対応可能なAnsible Automation Controllerのバージョンは、 <a class="reference internal" href="../../configuration/ansible/ansible_automation_platform.html"><span class="doc">Ansible Automation Platform</span></a> を参照してください。</div>
<div class="line">最新のバージョンに対応した記法は使えないことがありますので、ご注意ください。</div>
</div>
</section>
<section id="ansible-execution-agent">
<h3><span class="section-number">1.2.3. </span>Ansible Execution Agentについて<a class="headerlink" href="#ansible-execution-agent" title="Link to this heading">¶</a></h3>
<div class="line-block">
<div class="line">Ansible Execution Agentとは、ITAとは独立したAnsible実行専用のサーバーです。</div>
<div class="line">ITAと連携しPlaybookを実行する為に必要な実行環境(コンテナ)をAnsible-builderで構築し、Ansible-runnerより実行環境(コンテナ)を介しPlaybookを実行するものです。</div>
<div class="line">Ansible Execution Agentはワークスペース単位に用意します。</div>
<div class="line">同じワークスペースに複数のAnsible Execution Agentを用意することで、冗長化構成を組むことが出来ます。</div>
</div>
<a class="reference internal image-reference" href="../../_images/ansible_agent_overview.png"><img alt="Ansible Execution Agentの構成図" src="../../_images/ansible_agent_overview.png" style="width: 6.68819in; height: 3.35972in;" />
</a>
</section>
<section id="id2">
<h3><span class="section-number">1.2.4. </span>Ansible driverについて<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h3>
<div class="line-block">
<div class="line">Ansible driverは、ITAの機能で、ITAで登録した作業対象のサーバ・ストレージ・ネットワーク各機器に対し、Ansible Core、Ansible Automation Controller、Ansible Execution Agentのどれを経由するかを選択し、Playbookの処理を自動的に行います。</div>
</div>
<a class="reference internal image-reference" href="../../_images/ansible_overview.png"><img alt="Exastro概要" src="../../_images/ansible_overview.png" style="width: 6.68819in; height: 3.35972in;" />
</a>
<div class="line-block">
<div class="line">Ansible driverには用途に応じて以下の3つのモードを用意しています。</div>
</div>
<ol class="arabic">
<li><div class="line-block">
<div class="line"><strong>Legacy モード</strong></div>
<div class="line">Ansible標準の機能を用いて各種ホストへ設定を投入します。</div>
<div class="line">構築コードを単体YAMLファイルとして登録し、作業パターンをその組み合わせで構成します。</div>
<div class="line">サーバ・ストレージ・ネットワーク各機器の環境設定などの作業用に使われることを想定します。</div>
</div>
</li>
<li><div class="line-block">
<div class="line"><strong>Legacy Role モード</strong></div>
<div class="line">Legacyモードと同じく、Ansible標準の機能を用いて各種ホストへ設定を投入します。</div>
<div class="line">構築コードをパッケージとして登録し、作業パターンをRoleの組み合わせで構成します。</div>
<div class="line">製品部門などが提供するRoleパッケージを用いて、製品のインストール、環境構築などを行う際に使われることを想定します。</div>
</div>
</li>
<li><div class="line-block">
<div class="line"><strong>Pioneer モード</strong></div>
<div class="line">Ansibleに独自モジュールを追加し、対話形式による設定投入を可能とします。</div>
<div class="line">Telnet, SSHでログイン可能なサーバ・ストレージ・ネットワーク各機器に対応しています。作業対象と直接やり取りが必要となるため、相応のITスキルが必要となります。</div>
</div>
</li>
</ol>
</section>
</section>
<section id="ansible-common-variable-handling">
<span id="id3"></span><h2><span class="section-number">1.3. </span>Ansible driverでの変数取り扱い<a class="headerlink" href="#ansible-common-variable-handling" title="Link to this heading">¶</a></h2>
<div class="line-block">
<div class="line">Ansible driverでは、Playbook中の変数の具体値をITAから設定することができます。</div>
</div>
<section id="id4">
<h3><span class="section-number">1.3.1. </span>変数の種類<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h3>
<div class="line-block">
<div class="line">Playbook中の変数で、ITAの変数として扱える変数は以下の7種類があります。</div>
</div>
<section id="id5">
<h4>通常変数<a class="headerlink" href="#id5" title="Link to this heading">¶</a></h4>
<div class="line-block">
<div class="line">変数名に対して具体値を1つ定義できる変数です。</div>
<div class="line"><br /></div>
<div class="line">e.g.) Playbook内での記述例</div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ansible-LegacyRoleでの変数定義例</span>
<span class="nt">user</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">user1</span>

<span class="c1"># Playbook内での記述例</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Create user</span>
<span class="w">  </span><span class="nt">user</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">user</span><span class="nv"> </span><span class="s">}}&quot;</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<section id="id6">
<h4>複数具体値変数<a class="headerlink" href="#id6" title="Link to this heading">¶</a></h4>
<div class="line-block">
<div class="line">変数名に対して具体値を複数定義できる変数です。</div>
<div class="line"><br /></div>
<div class="line">e.g.) Playbook内での記述例</div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ansible-LegacyRoleでの変数定義例</span>
<span class="nt">users</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">user1</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">user2</span>

<span class="c1"># Playbook内での記述例</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Create user</span>
<span class="w">  </span><span class="nt">user</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">item</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">  </span><span class="nt">with_items</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">users</span><span class="nv"> </span><span class="s">}}&quot;</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<section id="id7">
<h4>多段変数<a class="headerlink" href="#id7" title="Link to this heading">¶</a></h4>
<div class="line-block">
<div class="line">階層化された変数です。</div>
<div class="line">多段変数はAnsible-LegacyRoleでしか扱えません。</div>
<div class="line"><br /></div>
<div class="line">e.g.) Playbook内での記述例</div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ansible-LegacyRoleでの変数定義例</span>
<span class="nt">users</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">user3</span>
<span class="w">    </span><span class="nt">groups</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">root</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">user4</span>
<span class="w">    </span><span class="nt">groups</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">root</span>

<span class="c1"># Playbook内での記述例</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Create user</span>
<span class="w">  </span><span class="nt">user</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">item.name</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">  </span><span class="nt">with_items</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">users</span><span class="nv"> </span><span class="s">}}&quot;</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<section id="id8">
<h4>グローバル変数<a class="headerlink" href="#id8" title="Link to this heading">¶</a></h4>
<div class="line-block">
<div class="line"><span class="menuselection">Ansible共通 ▶ グローバル変数管理</span> から登録する変数です。</div>
</div>
<div class="line-block">
<div class="line">e.g.) Playbook内での記述例</div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">echo {{ GBL_user }}</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<section id="id9">
<h4>テンプレート埋込変数<a class="headerlink" href="#id9" title="Link to this heading">¶</a></h4>
<div class="line-block">
<div class="line"><span class="menuselection">Ansible共通 ▶ テンプレート管理</span> から登録する変数です。</div>
</div>
<div class="line-block">
<div class="line">e.g.) Playbook内での記述例</div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">template</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">src={{ TPF_SAMPLE }} dest=/tmp/SAMPLE.txt</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<section id="id10">
<h4>ファイル埋込変数<a class="headerlink" href="#id10" title="Link to this heading">¶</a></h4>
<div class="line-block">
<div class="line"><span class="menuselection">Ansible共通 ▶ ファイル管理</span> から登録する変数です。</div>
</div>
<div class="line-block">
<div class="line">e.g.) Playbook内での記述例</div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">copy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">src={{ CPF_SAMPLE }} dest=/tmp/SAMPLE.txt</span>
</pre></div>
</div>
</section>
<section id="ita">
<span id="ansible-common-ita-original-variable"></span><h4>ITA独自変数<a class="headerlink" href="#ita" title="Link to this heading">¶</a></h4>
<div class="line-block">
<div class="line">ITA 独自で定義している変数です。</div>
</div>
<section id="id11">
<h5>機器一覧<a class="headerlink" href="#id11" title="Link to this heading">¶</a></h5>
<div class="line-block">
<div class="line"><span class="menuselection">基本コンソール ▶ 機器一覧</span> の下記項目を変数として扱えます。</div>
</div>
<table class="docutils align-left">
<colgroup>
<col style="width: 38.5%" />
<col style="width: 61.5%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>項目名</p></th>
<th class="head"><p>変数名</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ホスト名</p></td>
<td><p>__inventory_hostname__</p></td>
</tr>
<tr class="row-odd"><td><p>DNSホスト名</p></td>
<td><p>__dnshostname__</p></td>
</tr>
<tr class="row-even"><td><p>IPアドレス</p></td>
<td><p>__ipaddress__</p></td>
</tr>
<tr class="row-odd"><td><p>プロトコル</p></td>
<td><p>__loginprotocol__</p></td>
</tr>
<tr class="row-even"><td><p>ログインユーザID</p></td>
<td><p>__loginuser__</p></td>
</tr>
<tr class="row-odd"><td><p>ログインパスワード</p></td>
<td><p>__loginpassword__</p></td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<div class="line-block">
<div class="line">変数名の前後の「__」は半角アンダーバー2文字です。</div>
</div>
</div>
<div class="line-block">
<div class="line"><span class="menuselection">Ansible共通 ▶ 機器一覧</span> の項目が設定されている場合に使用可能な変数です。項目が未設定で <span class="menuselection">各モード ▶ 作業実行</span> から作業実行した場合はエラーになります。</div>
</div>
</section>
<section id="movement-id">
<h5>Movement ID<a class="headerlink" href="#movement-id" title="Link to this heading">¶</a></h5>
<div class="line-block">
<div class="line">作業実行時に選択された <span class="menuselection">各モード ▶ Movement一覧</span> の <span class="menuselection">Movement ID</span> を変数として扱えます。</div>
</div>
<table class="docutils align-left">
<colgroup>
<col style="width: 38.5%" />
<col style="width: 61.5%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>項目名</p></th>
<th class="head"><p>変数名</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Movemebt ID</p></td>
<td><p>__movement_id__</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id12">
<h5>オペレーション<a class="headerlink" href="#id12" title="Link to this heading">¶</a></h5>
<div class="line-block">
<div class="line">作業実行時に選択された <span class="menuselection">基本コンソール ▶ オペレーション一覧</span> の  <span class="menuselection">オペレーションID</span> を変数として扱えます。</div>
</div>
<table class="docutils align-left">
<colgroup>
<col style="width: 38.5%" />
<col style="width: 61.5%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>項目名</p></th>
<th class="head"><p>変数名</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>オペレーション</p></td>
<td><p>__operation__</p></td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line">設定値 : 「YYYY/MM/DD HH:MM」_「オペレーションID」:「オペレーション名称」</div>
<div class="line">YYYY/MM/DD HH:MM: <span class="menuselection">基本コンソール ▶ オペレーション一覧</span> の <span class="menuselection">実施予定日時</span></div>
<div class="line">オペレーションID: <span class="menuselection">基本コンソール ▶ オペレーション一覧</span> の <span class="menuselection">オペレーションID</span></div>
<div class="line">オペレーション名称: <span class="menuselection">基本コンソール ▶ オペレーション一覧</span> の <span class="menuselection">オペレーション名称</span></div>
<div class="line"><br /></div>
</div>
</section>
<section id="id">
<h5>作業インスタンスID<a class="headerlink" href="#id" title="Link to this heading">¶</a></h5>
<div class="line-block">
<div class="line">作業実行時に生成される <span class="menuselection">各モード ▶ 作業状態確認</span> の <span class="menuselection">作業No．</span> を変数として扱えます。</div>
</div>
<table class="docutils align-left">
<colgroup>
<col style="width: 38.5%" />
<col style="width: 61.5%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>項目名</p></th>
<th class="head"><p>変数名</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>作業インスタンスID</p></td>
<td><p>__execution_no__</p></td>
</tr>
</tbody>
</table>
</section>
<section id="conductorid">
<h5>ConductorインスタンスID<a class="headerlink" href="#conductorid" title="Link to this heading">¶</a></h5>
<div class="line-block">
<div class="line">Conductor実行時に生成される <span class="menuselection">Conductor ▶ Conductor作業確認</span> の <span class="menuselection">ConductorインスタンスID</span> を変数として扱えます。</div>
<div class="line">Conductorについての詳細は「 <a class="reference internal" href="../it_automation_base/conductor.html"><span class="doc">Conductor</span></a> 」を参照してください。</div>
</div>
<table class="docutils align-left">
<colgroup>
<col style="width: 38.5%" />
<col style="width: 61.5%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>項目名</p></th>
<th class="head"><p>変数名</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ConductorインスタンスID</p></td>
<td><p>__conductor_id__</p></td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line">__conductor_id__はConductor実行の場合に使用可能な変数です。</div>
<div class="line-block">
<div class="line"><span class="menuselection">各モード ▶ 作業実行</span> から作業実行した場合はエラーになります。</div>
<div class="line"><br /></div>
</div>
</div>
</section>
<section id="id13">
<h5>データ連携<a class="headerlink" href="#id13" title="Link to this heading">¶</a></h5>
<div class="line-block">
<div class="line">作業実行時の作業ディレクトリパスを下記の変数として扱えます。</div>
</div>
<table class="docutils align-left">
<colgroup>
<col style="width: 38.5%" />
<col style="width: 61.5%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>項目名</p></th>
<th class="head"><p>変数名</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>作業ディレクトリパス</p></td>
<td><p>__workflowdir__</p></td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line">Playbook内で作業ディレクトリパス配下にファイルを作成することで、 <span class="menuselection">各モード ▶ 作業管理</span> の <span class="menuselection">結果データ</span> からファイルをダウンロードすることができます。</div>
<div class="line"><br /></div>
</div>
<div class="line-block">
<div class="line">Conductor実行時の各Movementで共有するディレクトリパスを下記の変数として扱えます。</div>
</div>
<table class="docutils align-left">
<colgroup>
<col style="width: 38.5%" />
<col style="width: 61.5%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>項目名</p></th>
<th class="head"><p>変数名</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Conductor作業ディレクトリパス</p></td>
<td><p>__conductor_workflowdir__</p></td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line">Playbook内でConductor作業ディレクトリパス配下にファイルを作成することで、Conductor内の各Movement間でファイルを共有することが出来ます。</div>
<div class="line">また、 <span class="menuselection">各モード ▶ 作業実行</span> から作業実行した場合は、__workflowdir__と同じパスが設定されます。</div>
<div class="line"><br /></div>
</div>
<div class="line-block">
<div class="line"><span class="menuselection">Conductor ▶ Conductor編集/作業実行</span> の <span class="menuselection">Status file branchノード</span> で参照するステータスファイルのファイルパスを下記の変数として扱えます。</div>
<div class="line"><span class="menuselection">Status file branchノード</span> についての詳細は「 <a class="reference internal" href="../it_automation_base/conductor.html"><span class="doc">Conductor</span></a> 」を参照してください。</div>
</div>
<table class="docutils align-left">
<colgroup>
<col style="width: 38.5%" />
<col style="width: 61.5%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>項目名</p></th>
<th class="head"><p>変数名</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ステータスファイルパス</p></td>
<td><p>__movement_status_filepath__</p></td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="line-block">
<div class="line">収集機能で使用する各ファイルパスを下記の変数として扱えます。</div>
<div class="line">収集機能についての詳細は「 <a class="reference internal" href="collect.html"><span class="doc">収集機能</span></a> 」を参照してください。</div>
</div>
<table class="docutils align-left">
<colgroup>
<col style="width: 38.5%" />
<col style="width: 61.5%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>項目名</p></th>
<th class="head"><p>変数名</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>作業ディレクトリ（in）の「_parameters」のパス</p></td>
<td><p>__parameters_dir_for_epc__</p></td>
</tr>
<tr class="row-odd"><td><p>作業ディレクトリ（in）の「_parameters_file」のパス</p></td>
<td><p>__parameters_file_dir_for_epc__</p></td>
</tr>
<tr class="row-even"><td><p>作業結果ディレクトリ（out）の「_parameters」のパス</p></td>
<td><p>__parameter_dir__</p></td>
</tr>
<tr class="row-odd"><td><p>作業結果ディレクトリ（out）の「_parameters_file」のパス</p></td>
<td><p>__parameters_file_dir__</p></td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line">「_parameters」：ソースファイル（パラメータ）格納先用</div>
<div class="line">「_parameters_file」：収集したファイルの格納先用</div>
<div class="line">※パラメータの対象がファイルアップロードカラムの場合のファイル配置</div>
<div class="line"><br /></div>
</div>
</section>
</section>
</section>
<section id="id14">
<h3><span class="section-number">1.3.2. </span>変数の抜出および具体値登録<a class="headerlink" href="#id14" title="Link to this heading">¶</a></h3>
<section id="ansible-common-var-listup">
<span id="id15"></span><h4>変数抜出対象資材<a class="headerlink" href="#ansible-common-var-listup" title="Link to this heading">¶</a></h4>
<div class="line-block">
<div class="line">変数抜出対象の資材を登録した場合、登録された情報から変数を抜出します。</div>
</div>
<table class="docutils align-left" id="id40">
<caption><span class="caption-number">表 1.118 </span><span class="caption-text">変数抜出対象のメニュー・項目</span><a class="headerlink" href="#id40" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 11.1%" />
<col style="width: 22.2%" />
<col style="width: 11.1%" />
<col style="width: 11.1%" />
<col style="width: 11.1%" />
<col style="width: 33.3%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>メニュー</p></th>
<th class="head" rowspan="2"><p>項目</p></th>
<th class="head" colspan="3"><p>モード</p></th>
<th class="head" rowspan="2"><p>変数抜出の書式</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Ansible-Legacy</p></th>
<th class="head"><p>Ansible-Pioneer</p></th>
<th class="head"><p>Ansible-LegacyRole</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>Playbook素材集</p></td>
<td><p>Playbook素材</p></td>
<td><p>〇</p></td>
<td><p>×</p></td>
<td><p>×</p></td>
<td><p>詳細は「 <a class="reference internal" href="#ansible-common-legacy-var-listup"><span class="std std-ref">Playbook素材で変数抜出の対象となる変数の種類と書式</span></a> 」を参照してください。</p></td>
</tr>
<tr class="row-even"><td><p>対話ファイル素材集</p></td>
<td><p>対話ファイル素材</p></td>
<td><p>×</p></td>
<td><p>〇</p></td>
<td><p>×</p></td>
<td><p>詳細は「 <a class="reference internal" href="#ansible-common-pioneer-var-listup"><span class="std std-ref">対話ファイル素材で変数抜出の対象となる変数の種類と書式</span></a> 」を参照してください 。</p></td>
</tr>
<tr class="row-odd"><td><p>ロールパッケージ管理</p></td>
<td><p>ロールパッケージファイル（ZIP形式）</p></td>
<td><p>×</p></td>
<td><p>×</p></td>
<td><p>〇</p></td>
<td><p>詳細は「 <a class="reference internal" href="#ansible-common-legacyrole-var-listup"><span class="std std-ref">ロールパッケージファイル（ZIP形式）で変数抜出の対象となる変数の種類と書式</span></a> 」を参照してください 。</p></td>
</tr>
<tr class="row-even"><td><p>テンプレート管理</p></td>
<td><p>変数定義</p></td>
<td><p>〇</p></td>
<td><p>〇</p></td>
<td><p>〇</p></td>
<td><p>詳細は「 <a class="reference internal" href="#ansible-common-template-list"><span class="std std-ref">テンプレート管理</span></a> 」を参照してください 。</p></td>
</tr>
<tr class="row-odd"><td><p>機器一覧</p></td>
<td><p>インベントリファイル追加オプション</p></td>
<td><p>〇</p></td>
<td><p>×</p></td>
<td><p>〇</p></td>
<td><p>詳細は「 <a class="reference internal" href="#ansible-common-option-var-listup"><span class="std std-ref">インベントリファイル追加オプションとヘッダセクションのパラメータ値で変数抜出の対象となる変数の種類と書式</span></a> 」を参照してください 。</p></td>
</tr>
<tr class="row-even"><td><p>Movement一覧</p></td>
<td><p>ヘッダセクション</p></td>
<td><p>〇</p></td>
<td><p>×</p></td>
<td><p>〇</p></td>
<td><p>詳細は「 <a class="reference internal" href="#ansible-common-option-var-listup"><span class="std std-ref">インベントリファイル追加オプションとヘッダセクションのパラメータ値で変数抜出の対象となる変数の種類と書式</span></a> 」を参照してください 。</p></td>
</tr>
<tr class="row-odd"><td><p>パラメータシート</p></td>
<td><p>プルダウン選択でテンプレート管理を選択している項目</p></td>
<td><p>〇</p></td>
<td><p>〇</p></td>
<td><p>〇</p></td>
<td><p>詳細は「 <a class="reference internal" href="#ansible-common-template-list"><span class="std std-ref">テンプレート管理</span></a> 」を参照してください 。</p></td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<div class="line-block">
<div class="line">〇：抜出対象  ×：抜出対象外</div>
</div>
</div>
<section id="playbook">
<span id="ansible-common-legacy-var-listup"></span><h5>Playbook素材で変数抜出の対象となる変数の種類と書式<a class="headerlink" href="#playbook" title="Link to this heading">¶</a></h5>
<div class="line-block">
<div class="line"><span class="menuselection">Ansible-Legacy ▶ Playbook素材集</span> の <span class="menuselection">Playbook素材</span> で変数抜出の対象となる変数の種類と書式は、以下の図のとおりです。</div>
</div>
<table class="docutils align-left" id="id41">
<caption><span class="caption-number">表 1.119 </span><span class="caption-text">Playbook素材で変数抜出の対象となる変数の種類と書式</span><a class="headerlink" href="#id41" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 14.3%" />
<col style="width: 28.6%" />
<col style="width: 57.1%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>変数</p></th>
<th class="head"><p>書式</p></th>
<th class="head"><p>具体値の設定</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>通常変数</p>
<p>複数具体値変数</p>
</td>
<td><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{{</span><span class="nv">△vvv△</span><span class="p p-Indicator">}}</span>

<span class="p p-Indicator">{{</span><span class="nv">△vvv△|△フィルタ△</span><span class="p p-Indicator">}}</span>
</pre></div>
</div>
</td>
<td><p>具体値の登録は <span class="menuselection">Ansible-Legacy ▶ 代入値自動登録設定</span> より行います。
<span class="menuselection">Ansible-Legacy ▶ 代入値自動登録設定</span> の <span class="menuselection">代入順序</span> が入力されている場合、複数具体値変数として扱います。</p></td>
</tr>
<tr class="row-odd"><td><p>グローバル変数</p></td>
<td><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{{</span><span class="nv">△GBL_xxx△</span><span class="p p-Indicator">}}</span>

<span class="p p-Indicator">{{</span><span class="nv">△GBL_xxx△|△フィルタ△</span><span class="p p-Indicator">}}</span>
</pre></div>
</div>
</td>
<td><p>具体値の登録は <span class="menuselection">Ansible共通 ▶ グローバル変数管理</span> より行います。</p></td>
</tr>
<tr class="row-even"><td><p>テンプレート埋込変数</p></td>
<td><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{{</span><span class="nv">△TPF_xxx△</span><span class="p p-Indicator">}}</span>

<span class="p p-Indicator">{{</span><span class="nv">△TPF_xxx△|△フィルタ△</span><span class="p p-Indicator">}}</span>
</pre></div>
</div>
</td>
<td><p>具体値の登録は <span class="menuselection">Ansible共通 ▶ テンプレート管理</span> より行います。</p></td>
</tr>
<tr class="row-odd"><td><p>ファイル埋込変数</p></td>
<td><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{{</span><span class="nv">△CPF_xxx△</span><span class="p p-Indicator">}}</span>

<span class="p p-Indicator">{{</span><span class="nv">△CPF_xxx△|△フィルタ△</span><span class="p p-Indicator">}}</span>
</pre></div>
</div>
</td>
<td><p>具体値の登録は <span class="menuselection">Ansible共通 ▶ ファイル管理</span> より行います。</p></td>
</tr>
<tr class="row-even"><td><p>ITA独自変数</p></td>
<td></td>
<td><p>詳細は「 <a class="reference internal" href="#ansible-common-ita-original-variable"><span class="std std-ref">ITA独自変数</span></a> 」を参照してください。</p></td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<div class="line-block">
<div class="line">各変数名についての補足</div>
<div class="line">△：半角スペース</div>
<div class="line">vvv: 255バイト以内の半角英数字とアンダースコア（ _ ）</div>
<div class="line">xxx: 251バイト以内の半角英数字とアンダースコア（ _ ）</div>
</div>
</div>
</section>
<section id="ansible-common-pioneer-var-listup">
<span id="id16"></span><h5>対話ファイル素材で変数抜出の対象となる変数の種類と書式<a class="headerlink" href="#ansible-common-pioneer-var-listup" title="Link to this heading">¶</a></h5>
<div class="line-block">
<div class="line"><span class="menuselection">Ansible-Pioneer ▶ 対話ファイル素材集</span> の <span class="menuselection">対話ファイル素材</span> で変数抜出の対象となる変数の種類と書式は、以下の図のとおりです。</div>
</div>
<table class="docutils align-left" id="id42">
<caption><span class="caption-number">表 1.120 </span><span class="caption-text">対話ファイル素材で変数抜出の対象となる変数の種類と書式</span><a class="headerlink" href="#id42" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 14.3%" />
<col style="width: 28.6%" />
<col style="width: 57.1%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>変数</p></th>
<th class="head"><p>書式</p></th>
<th class="head"><p>具体値の設定</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>通常変数</p>
<p>複数具体値変数</p>
</td>
<td><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{{</span><span class="nv">△vvv△</span><span class="p p-Indicator">}}</span>
</pre></div>
</div>
</td>
<td><p>具体値の登録は <span class="menuselection">Ansible-Pioneer ▶ 代入値自動登録設定</span> より行います。
<span class="menuselection">Ansible-Pioneer ▶ 代入値自動登録設定</span> の <span class="menuselection">代入順序</span> が入力されている場合、複数具体値変数として扱います。</p></td>
</tr>
<tr class="row-odd"><td><p>グローバル変数</p></td>
<td><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{{</span><span class="nv">△GBL_xxx△</span><span class="p p-Indicator">}}</span>
</pre></div>
</div>
</td>
<td><p>具体値の登録は <span class="menuselection">Ansible共通 ▶ グローバル変数管理</span> より行います。</p></td>
</tr>
<tr class="row-even"><td><p>テンプレート埋込変数</p></td>
<td><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{{</span><span class="nv">△TPF_xxx△</span><span class="p p-Indicator">}}</span>
</pre></div>
</div>
</td>
<td><p>具体値の登録は <span class="menuselection">Ansible共通 ▶ テンプレート管理</span> より行います。</p></td>
</tr>
<tr class="row-odd"><td><p>ファイル埋込変数</p></td>
<td><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{{</span><span class="nv">△CPF_xxx△</span><span class="p p-Indicator">}}</span>
</pre></div>
</div>
</td>
<td><p>具体値の登録は <span class="menuselection">Ansible共通 ▶ ファイル管理</span> より行います。</p></td>
</tr>
<tr class="row-even"><td><p>ITA独自変数</p></td>
<td></td>
<td><p>詳細は「 <a class="reference internal" href="#ansible-common-ita-original-variable"><span class="std std-ref">ITA独自変数</span></a> 」を参照してください。</p></td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<div class="line-block">
<div class="line">各変数名についての補足</div>
<div class="line">△：半角スペース</div>
<div class="line">vvv: 255バイト以内の半角英数字とアンダースコア（ _ ）</div>
<div class="line">xxx: 251バイト以内の半角英数字とアンダースコア（ _ ）</div>
</div>
</div>
</section>
<section id="zip">
<span id="ansible-common-legacyrole-var-listup"></span><h5>ロールパッケージファイル（ZIP形式）で変数抜出の対象となる変数の種類と書式<a class="headerlink" href="#zip" title="Link to this heading">¶</a></h5>
<div class="line-block">
<div class="line"><span class="menuselection">Ansible-LegacyRole ▶ ロールパッケージ管理</span> の <span class="menuselection">ロールパッケージファイル（ZIP形式）</span> で変数抜出の対象となる変数の種類と書式は、以下の図のとおりです。</div>
</div>
<table class="docutils align-left" id="id43">
<caption><span class="caption-number">表 1.121 </span><span class="caption-text">ロールパッケージファイル（ZIP形式）で変数抜出の対象となる変数の種類と書式</span><a class="headerlink" href="#id43" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 8.0%" />
<col style="width: 16.0%" />
<col style="width: 4.0%" />
<col style="width: 8.0%" />
<col style="width: 8.0%" />
<col style="width: 8.0%" />
<col style="width: 48.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>変数名</p></th>
<th class="head" rowspan="2"><p>書式</p></th>
<th class="head" rowspan="2"><p>ITA readme</p></th>
<th class="head" colspan="3"><p>ロールパッケージ内のディレクトリ</p></th>
<th class="head" rowspan="2"><p>具体値の設定</p></th>
</tr>
<tr class="row-even"><th class="head"><p>defaults</p></th>
<th class="head"><p>tasks</p>
<p>templates</p>
<p>handlers</p>
<p>meta</p>
</th>
<th class="head"><p>その他</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>通常変数</p></td>
<td><p>e.g.)</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">vvv</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
</pre></div>
</div>
<p>具体値は省略可能です。</p>
</td>
<td rowspan="3"><p>〇</p></td>
<td rowspan="3"><p>〇</p></td>
<td rowspan="3"><p>×</p></td>
<td rowspan="3"><p>×</p></td>
<td rowspan="3"><p>具体値の登録は <span class="menuselection">Ansible-LegacyRole ▶ 代入値自動登録設定</span> より行います。</p></td>
</tr>
<tr class="row-even"><td><p>複数具体値変数</p></td>
<td><p>e.g.)</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">vvv</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="nt">vvv</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span>
</pre></div>
</div>
<p>具体値は省略可能です。</p>
</td>
</tr>
<tr class="row-odd"><td><p>多段変数</p></td>
<td><p>e.g.)</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">vvv</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">item1</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value1  ←メンバー変数</span>
<span class="w">    </span><span class="nt">item2</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value2  ←メンバー変数</span>
<span class="nt">vvv</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">array</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">item1</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value1 ←メンバー変数</span>
<span class="w">        </span><span class="nt">item2</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value2 ←メンバー変数</span>
</pre></div>
</div>
<p>具体値は省略可能です。</p>
</td>
</tr>
<tr class="row-even"><td><p>グローバル変数</p></td>
<td><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{{</span><span class="nv">△GBL_xxx△</span><span class="p p-Indicator">}}</span>

<span class="p p-Indicator">{{</span><span class="nv">△GBL_xxx△|△フィルタ△</span><span class="p p-Indicator">}}</span>
</pre></div>
</div>
</td>
<td rowspan="4"><p>×</p></td>
<td rowspan="4"><p>×</p></td>
<td rowspan="4"><p>○</p></td>
<td rowspan="4"><p>×</p></td>
<td><p>具体値の登録は <span class="menuselection">Ansible共通 ▶ グローバル変数管理</span> より行います。</p></td>
</tr>
<tr class="row-odd"><td><p>テンプレート埋込変数</p></td>
<td><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{{</span><span class="nv">△TPF_xxx△</span><span class="p p-Indicator">}}</span>

<span class="p p-Indicator">{{</span><span class="nv">△TPF_xxx△|△フィルタ△</span><span class="p p-Indicator">}}</span>
</pre></div>
</div>
</td>
<td><p>具体値の登録は <span class="menuselection">Ansible共通 ▶ テンプレート管理</span> より行います。</p></td>
</tr>
<tr class="row-even"><td><p>ファイル埋込変数</p></td>
<td><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{{</span><span class="nv">△CPF_xxx△</span><span class="p p-Indicator">}}</span>

<span class="p p-Indicator">{{</span><span class="nv">△CPF_xxx△|△フィルタ△</span><span class="p p-Indicator">}}</span>
</pre></div>
</div>
</td>
<td><p>具体値の登録は <span class="menuselection">Ansible共通 ▶ ファイル管理</span> より行います。</p></td>
</tr>
<tr class="row-odd"><td><p>ITA独自変数</p></td>
<td></td>
<td><p>詳細は「 <a class="reference internal" href="#ansible-common-ita-original-variable"><span class="std std-ref">ITA独自変数</span></a> 」をを参照してください。</p></td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<div class="line-block">
<div class="line">〇：変数定義抜出対象   ×：変数定義抜出対象外</div>
</div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<div class="line-block">
<div class="line">各変数名についての補足</div>
<div class="line">△：半角スペース</div>
<div class="line">vvv: 255バイト以内の半角英数字とアンダースコア（ _ ）</div>
<div class="line">xxx: 251バイト以内の半角英数字とアンダースコア（ _ ）</div>
<div class="line">メンバー変数は、下記の7文字を除くascii文字(0x20～0x7e)が使用出来ます。</div>
<div class="line">&quot; . [ ] ' \ :</div>
<div class="line">尚、コーテーションで囲ないと変数名の先頭に使用出来ない文字がいくつかあります。</div>
<div class="line">詳細は、Ansible公式マニュアルのYaml syntaxを参照してください。</div>
</div>
</div>
</section>
<section id="ansible-common-option-var-listup">
<span id="id17"></span><h5>インベントリファイル追加オプションとヘッダセクションのパラメータ値で変数抜出の対象となる変数の種類と書式<a class="headerlink" href="#ansible-common-option-var-listup" title="Link to this heading">¶</a></h5>
<div class="line-block">
<div class="line"><span class="menuselection">Ansible共通 ▶ 機器一覧</span> の <span class="menuselection">インベントリファイル追加オプション</span> と <span class="menuselection">各モード ▶ Movement一覧</span> の <span class="menuselection">ヘッダセクション</span> のパラメータ値で変数抜出の対象となる変数の種類と書式は、以下の図のとおりです。</div>
</div>
<table class="docutils align-left" id="id44">
<caption><span class="caption-number">表 1.122 </span><span class="caption-text">パラメータ値で変数抜出の対象となる変数の種類と書式</span><a class="headerlink" href="#id44" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 16.7%" />
<col style="width: 10.0%" />
<col style="width: 20.0%" />
<col style="width: 53.3%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>種類</p></th>
<th class="head"><p>利用可否</p></th>
<th class="head"><p>書式</p></th>
<th class="head"><p>具体値の設定</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>通常変数</p>
<p>複数具体値変数</p>
<p>多段変数</p>
</td>
<td><p>〇</p></td>
<td><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{{</span><span class="nv">△vvv△</span><span class="p p-Indicator">}}</span>

<span class="p p-Indicator">{{</span><span class="nv">△vvv△|△フィルタ△</span><span class="p p-Indicator">}}</span>
</pre></div>
</div>
</td>
<td><p>・Ansible-Legacyの場合</p>
<p>通常変数と複数具体値変数が扱えます。</p>
<p><span class="menuselection">Ansible-Legacy ▶ 代入値自動登録設定</span> の <span class="menuselection">代入順序</span> が入力されている場合、複数具体値変数として扱います。</p>
<p>・Ansible-LegacyRoleの場合</p>
<p>通常変数と複数具体値変数と多段変数が扱えます。</p>
<p><span class="menuselection">Ansible-LegacyRole ▶ ロールパッケージ管理</span> の <span class="menuselection">ロールパッケージファイル（ZIP形式）</span> で登録したロールパッケージか、 <span class="menuselection">Ansible共通 ▶ テンプレート管理</span> の <span class="menuselection">変数定義</span> で同名の変数が定義されている場合は、定義されている種類の変数として扱います。</p>
<p>変数が定義されていない場合、通常変数として扱います。</p>
<p>具体値の登録は <span class="menuselection">Ansible-LegacyRole ▶ 代入値自動登録設定</span> より行います。</p>
</td>
</tr>
<tr class="row-odd"><td><p>グローバル変数</p></td>
<td><p>×</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>ファイル埋込変数</p></td>
<td><p>×</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>テンプレート埋込変数</p></td>
<td><p>×</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>ITA独自変数</p></td>
<td><p>〇</p></td>
<td></td>
<td><p>詳細は「 <a class="reference internal" href="#ansible-common-ita-original-variable"><span class="std std-ref">ITA独自変数</span></a> 」を参照してください。</p></td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<div class="line-block">
<div class="line">各変数名についての補足</div>
<div class="line">△：半角スペース</div>
<div class="line">vvv: 255バイト以内の半角英数字とアンダースコア（ _ ）</div>
</div>
</div>
</section>
</section>
<section id="id18">
<h4>変数の具体値<a class="headerlink" href="#id18" title="Link to this heading">¶</a></h4>
<section id="ansible-legacy">
<h5>Ansible-Legacy<a class="headerlink" href="#ansible-legacy" title="Link to this heading">¶</a></h5>
<div class="line-block">
<div class="line">抜出された変数の具体値はパラメータシートの項目に具体値を設定し <span class="menuselection">Ansible-Legacy ▶ 代入値自動登録設定</span> で各変数に紐付けを行うことで設定され、作業実行時にホスト変数ファイルに出力されます。</div>
<div class="line">作業実行時に <span class="menuselection">Ansible-Legacy ▶ 代入値管理</span> を介してホスト変数ファイルに変数の具体値が出力されるまでの関係を、以下の図に示します。</div>
<div class="line">パラメータシートについての詳細は、「 <a class="reference internal" href="../create_param/menu_creation.html"><span class="doc">パラメータシート作成機能</span></a> 」を参照してください。</div>
</div>
<figure class="align-default" id="id45">
<a class="reference internal image-reference" href="../../_images/hensuu_nukidashi_legacy.png"><img alt="Ansible-Legacy ホスト変数ファイルに変数の具体値が出力されるまでの流れ" src="../../_images/hensuu_nukidashi_legacy.png" style="width: 800px;" />
</a>
<figcaption>
<p><span class="caption-number">図 1.87 </span><span class="caption-text">Ansible-Legacy ホスト変数ファイルに変数の具体値が出力されるまでの流れ</span><a class="headerlink" href="#id45" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<div class="line-block">
<div class="line">① 「 <a class="reference internal" href="#ansible-common-var-listup"><span class="std std-ref">変数抜出対象資材</span></a> 」により、変数抜出対象の資材より変数を抜出し、 <span class="menuselection">Ansible-Legacy ▶ 代入値自動登録設定</span> で変数が選択可能になります。</div>
<div class="line">② パラメータシートの項目に紐付する変数の具体値を登録します。</div>
<div class="line">③ <span class="menuselection">Ansible-Legacy ▶ 代入値自動登録設定</span> でパラメータシートの項目と変数の紐付を登録します。</div>
<div class="line">④ 作業実行により <span class="menuselection">Ansible-Legacy ▶ 代入値自動登録設定</span> で紐付ているパラメータシートの項目と変数の情報を <span class="menuselection">Ansible-Legacy ▶ 代入値管理</span> に反映し、ホスト変数ファイルに出力します。</div>
</div>
</section>
<section id="ansible-pioneer">
<h5>Ansible-Pioneer<a class="headerlink" href="#ansible-pioneer" title="Link to this heading">¶</a></h5>
<div class="line-block">
<div class="line">抜出された変数の具体値はパラメータシートの項目に具体値を設定し <span class="menuselection">Ansible-Pioneer ▶ 代入値自動登録設定</span> で各変数に紐付けを行うことで設定され、作業実行時にホスト変数ファイルへ出力されます。</div>
<div class="line">作業実行時に <span class="menuselection">Ansible-Pioneer ▶ 代入値管理</span> を介してホスト変数ファイルに変数の具体値が出力されるまでの関係を、以下の図に示します。</div>
</div>
<figure class="align-default" id="id46">
<a class="reference internal image-reference" href="../../_images/hensuu_nukidashi_pioneer.png"><img alt="Ansible-Pioneer ホスト変数ファイルに変数の具体値が出力されるまでの流れ" src="../../_images/hensuu_nukidashi_pioneer.png" style="width: 800px;" />
</a>
<figcaption>
<p><span class="caption-number">図 1.88 </span><span class="caption-text">Ansible-Pioneer ホスト変数ファイルに変数の具体値が出力されるまでの流れ</span><a class="headerlink" href="#id46" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<div class="line-block">
<div class="line">① 「 <a class="reference internal" href="#ansible-common-var-listup"><span class="std std-ref">変数抜出対象資材</span></a> 」により、変数抜出対象の資材より変数を抜出し、 <span class="menuselection">Ansible-Pioneer ▶ 代入値自動登録設定</span> で変数が選択可能になります。</div>
<div class="line">② パラメータシートの項目に紐付する変数の具体値を登録します。</div>
<div class="line">③ <span class="menuselection">Ansible-Pioneer ▶ 代入値自動登録設定</span> でパラメータシートの項目と変数の紐付を登録します。</div>
<div class="line">④ 作業実行により <span class="menuselection">Ansible-Pioneer ▶ 代入値自動登録設定</span> で紐付ているパラメータシートの項目と変数の情報を <span class="menuselection">Ansible-Pioneer ▶ 代入値管理</span> に反映し、ホスト変数ファイルに出力します。</div>
</div>
</section>
<section id="ansible-legacyrole">
<span id="ansible-common-legacy-role-var-value"></span><h5>Ansible-LegacyRole<a class="headerlink" href="#ansible-legacyrole" title="Link to this heading">¶</a></h5>
<div class="line-block">
<div class="line">抜出された変数の具体値はパラメータシートの項目に具体値を設定し <span class="menuselection">Ansible-LegacyRole ▶ 代入値自動登録設定</span> で各変数に紐付けを行うことで設定され、作業実行時にホスト変数ファイルへ出力されます。</div>
<div class="line">作業実行時に <span class="menuselection">Ansible-LegacyRole ▶ 代入値管理</span> を介してホスト変数ファイルに変数の具体値が出力されるまでの関係を、以下の図に示します。</div>
</div>
<figure class="align-default" id="id47">
<a class="reference internal image-reference" href="../../_images/hensuu_nukidashi_legacyrole.png"><img alt="Ansible-LegacyRole ホスト変数ファイルに変数の具体値が出力されるまでの流れ" src="../../_images/hensuu_nukidashi_legacyrole.png" style="width: 800px;" />
</a>
<figcaption>
<p><span class="caption-number">図 1.89 </span><span class="caption-text">Ansible-LegacyRole ホスト変数ファイルに変数の具体値が出力されるまでの流れ</span><a class="headerlink" href="#id47" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<div class="line-block">
<div class="line">① 「 <a class="reference internal" href="#ansible-common-var-listup"><span class="std std-ref">変数抜出対象資材</span></a> 」により、変数抜出対象の資材より変数を抜出し、 <span class="menuselection">Ansible-LegacyRole ▶ 代入値自動登録設定</span> で変数が選択可能になります。</div>
<div class="line">② パラメータシートの項目に紐付する変数の具体値を登録します。</div>
<div class="line">③ <span class="menuselection">Ansible-LegacyRole ▶ 代入値自動登録設定</span> でパラメータシートの項目と変数の紐付を登録します。</div>
<div class="line">④ 作業実行により <span class="menuselection">Ansible-LegacyRole ▶ 代入値自動登録設定</span> で紐付ているパラメータシートの項目と変数の情報を <span class="menuselection">Ansible-LegacyRole ▶ 代入値管理</span> に反映し、ホスト変数ファイルに出力します。</div>
</div>
<div class="line-block">
<div class="line-block">
<div class="line"><span class="menuselection">Ansible-LegacyRole ▶ 代入値自動登録設定</span> で登録した変数の具体値は、ホスト変数定義ファイル（host_vars）に出力されます。</div>
</div>
<div class="line">この結果、ansibleが扱う変数の具体値の優先順位は以下のようになります。</div>
</div>
<ol class="arabic">
<li><div class="line-block">
<div class="line">ホスト変数定義ファイルの値</div>
</div>
</li>
<li><div class="line-block">
<div class="line">defaults変数定義ファイルに定義した値</div>
</div>
</li>
</ol>
</section>
</section>
</section>
</section>
<section id="id19">
<h2><span class="section-number">1.4. </span>Ansible共通メニュー構成<a class="headerlink" href="#id19" title="Link to this heading">¶</a></h2>
<div class="line-block">
<div class="line">本章では、Ansible共通のメニュー構成について説明します。</div>
</div>
<section id="id20">
<h3><span class="section-number">1.4.1. </span>メニュー/画面一覧<a class="headerlink" href="#id20" title="Link to this heading">¶</a></h3>
<div class="line-block">
<div class="line">Ansible共通のメニュー一覧を以下に記述します。</div>
</div>
<table class="docutils align-left" id="id48">
<caption><span class="caption-number">表 1.123 </span><span class="caption-text">Ansible共通 メニュー/画面一覧</span><a class="headerlink" href="#id48" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 7.1%" />
<col style="width: 21.4%" />
<col style="width: 71.4%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>No</p></th>
<th class="head"><p>メニュー・画面</p></th>
<th class="head"><p>説明</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>機器一覧</p></td>
<td><p>作業対象の機器情報を管理します。</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>インターフェース情報</p></td>
<td><div class="line-block">
<div class="line">Ansible Core、Ansible Automation Controller、Ansible Execution Agentのいずれの実行エンジンを使用するかを選択し、実行エンジンのサーバへの接続インターフェース情報を管理します。</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>Ansible Automation Controllerホスト一覧</p></td>
<td><p>Ansible Automation ControllerのRestAPI実行に必要な情報、および構築資材をAnsible Automation Controllerにファイル転送するために必要な情報を管理します。</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>グローバル変数管理</p></td>
<td><p>各モードのPlaybookや対話ファイルで共通利用する変数と具体値を管理します。</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>ファイル管理</p></td>
<td><p>各モードのPlaybookや対話ファイルで共通利用する素材ファイルと埋込変数を管理します。</p></td>
</tr>
<tr class="row-odd"><td><p>6</p></td>
<td><p>テンプレート管理</p></td>
<td><p>各モードのPlaybookや対話ファイルで共通利用するテンプレートファイルと埋込変数を管理します。</p></td>
</tr>
<tr class="row-even"><td><p>7</p></td>
<td><p>実行環境定義テンプレート管理</p></td>
<td><p>Ansible Execution Agent内にansible-builderで実行環境（コンテナ）をbuildする際の実行環境定義ファイル(execution-environment.yml)のテンプレートファイルを管理します。</p></td>
</tr>
<tr class="row-odd"><td><p>8</p></td>
<td><p>実行環境管理</p></td>
<td><p>Ansible Execution Agent内にansible-builderで実行環境（コンテナ）をbuildする際の実行環境定義ファイル(execution-environment.yml)のテンプレートファイルと、テンプレートに埋め込むパラメータが定義されているパラメータシートの紐付を管理します。</p></td>
</tr>
<tr class="row-even"><td><p>9</p></td>
<td><p>エージェント管理</p></td>
<td><p>ITAと接続したAnsible Execution Agentのエージェント名とバージョン情報を閲覧できます。</p></td>
</tr>
<tr class="row-odd"><td><p>10</p></td>
<td><p>管理対象外変数リスト</p></td>
<td><p>「 変数抜出対象資材 」で抜出した変数で、 <span class="menuselection">各モード ▶ 代入値自動登録設定</span> の  <span class="menuselection">:menuselection:`Movement名:変数名</span> に表示したくない変数を管理します。</p></td>
</tr>
<tr class="row-even"><td><p>11</p></td>
<td><p>共通変数利用リスト (※1)</p></td>
<td><p><span class="menuselection">Ansible共通 ▶ グローバル変数管理</span> ・ <span class="menuselection">Ansible共通 ▶ ファイル管理</span> ・ <span class="menuselection">Ansible共通 ▶ テンプレート管理</span> に登録されている変数が、どの素材( <span class="menuselection">Ansible-Legacy ▶ Playbook素材集</span> ・ <span class="menuselection">Ansible-Pioneer ▶ 対話ファイル素材集</span> ・ <span class="menuselection">Ansible-LegacyRole ▶ ロールパッケージ管理</span> )で使用しているかを閲覧できます。</p></td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<div class="line-block">
<div class="line">※1 非表示メニューは、内部処理で使用するメニューです。</div>
<div class="line">ITAをインストールした状態では表示されないメニューに設定されています。</div>
<div class="line">非表示メニューを表示するには、<span class="menuselection">管理コンソール ▶ ロール・メニュー紐付管理</span> で各メニューの復活処理を行います。詳細は「 <a class="reference internal" href="../it_automation_base/management_console.html"><span class="doc">管理コンソール</span></a> 」を参照してください。</div>
<div class="line">内部処理で使用するメニューには、登録を行わないようにしてください。</div>
</div>
</div>
</section>
</section>
<section id="id21">
<h2><span class="section-number">1.5. </span>メニュー操作方法説明<a class="headerlink" href="#id21" title="Link to this heading">¶</a></h2>
<div class="line-block">
<div class="line">本章では、Ansible共通のメニューの操作について記載します。</div>
</div>
<section id="ansible-common-device-list">
<span id="id22"></span><h3><span class="section-number">1.5.1. </span>機器一覧<a class="headerlink" href="#ansible-common-device-list" title="Link to this heading">¶</a></h3>
<ol class="arabic">
<li><div class="line-block">
<div class="line">作業対象となる機器情報のメンテナンス（閲覧/登録/更新/廃止）を行います。</div>
<div class="line">ITAをインストールすると、ローカル実行用の機器「localhost」が機器一覧に登録されます。</div>
<div class="line">「localhost」を指定して作業実行するとansibleホスト内で作業が実行されます。</div>
<div class="line">pioneerで「localhost」は使用できません。</div>
</div>
<figure class="align-default" id="id49">
<a class="reference internal image-reference" href="../../_images/device_list_v2_5.png"><img alt="サブメニュー画面（機器一覧）" src="../../_images/device_list_v2_5.png" style="width: 800px;" />
</a>
<figcaption>
<p><span class="caption-number">図 1.90 </span><span class="caption-text">サブメニュー画面（機器一覧）</span><a class="headerlink" href="#id49" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</li>
<li><div class="line-block">
<div class="line"><span class="guilabel">登録</span> ボタンより、作業対象となる機器情報の登録を行います。</div>
</div>
<figure class="align-default" id="id50">
<a class="reference internal image-reference" href="../../_images/registration_device_list_v2_5.gif"><img alt="登録画面（機器一覧）" src="../../_images/registration_device_list_v2_5.gif" style="width: 800px;" />
</a>
<figcaption>
<p><span class="caption-number">図 1.91 </span><span class="caption-text">登録画面（機器一覧）</span><a class="headerlink" href="#id50" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</li>
<li><div class="line-block">
<div class="line">登録画面の項目一覧は以下のとおりです。</div>
</div>
<table class="docutils align-left" id="id51">
<caption><span class="caption-number">表 1.124 </span><span class="caption-text">登録画面項目一覧（機器一覧）</span><a class="headerlink" href="#id51" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 9.3%" />
<col style="width: 9.3%" />
<col style="width: 9.3%" />
<col style="width: 9.3%" />
<col style="width: 20.9%" />
<col style="width: 14.0%" />
<col style="width: 14.0%" />
<col style="width: 14.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" colspan="4"><p>項目</p></th>
<th class="head"><p>説明</p></th>
<th class="head"><p>入力必須</p></th>
<th class="head"><p>入力方法</p></th>
<th class="head"><p>制約事項</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td colspan="4"><p>管理システム項番</p></td>
<td><p>登録時に自動採番した36桁の文字列が表示されます。</p></td>
<td><p>ー</p></td>
<td><p>自動入力</p></td>
<td><p>ー</p></td>
</tr>
<tr class="row-odd"><td colspan="4"><p>HW機器種別</p></td>
<td><p>HW機器の種別を選択します。</p>
<ul>
<li><div class="line-block">
<div class="line">NW（ネットワーク）</div>
</div>
</li>
<li><div class="line-block">
<div class="line">ST（ストレージ）</div>
</div>
</li>
<li><div class="line-block">
<div class="line">SV（サーバー）</div>
</div>
</li>
</ul>
</td>
<td><p>ー</p></td>
<td><p>リスト選択</p></td>
<td><p>説明欄記載のとおり</p></td>
</tr>
<tr class="row-even"><td colspan="4"><p>ホスト名</p></td>
<td><p>ホスト名を入力します。</p>
<p>Ansible実行時のインベントリホストとして扱います。</p>
</td>
<td><p>○</p></td>
<td><p>手動入力</p></td>
<td><p>最大長255バイト</p></td>
</tr>
<tr class="row-odd"><td colspan="4"><p>DNSホスト名</p></td>
<td><p>DNSサーバーを使用してホスト名が解決できる名称を入力します。</p></td>
<td><p>ー</p></td>
<td><p>手動入力</p></td>
<td><p>最大長255バイト</p></td>
</tr>
<tr class="row-even"><td colspan="4"><p>IPアドレス</p></td>
<td><p>IPアドレス（xxx.xxx.xxx.xxxIPv4形式）を入力します。</p></td>
<td><p>ー</p></td>
<td><p>手動入力</p></td>
<td><p>最大長15バイト</p></td>
</tr>
<tr class="row-odd"><td colspan="2" rowspan="2"><p>ログインパスワード</p></td>
<td colspan="2"><p>ユーザ</p></td>
<td><p>ログインユーザを入力します。</p></td>
<td><p>ー</p></td>
<td><p>手動入力</p></td>
<td><p>最大長255バイト</p></td>
</tr>
<tr class="row-even"><td colspan="2"><p>パスワード</p></td>
<td><p>パスワードを入力します。</p></td>
<td><p>ー</p></td>
<td><p>手動入力</p></td>
<td><p>最大長255バイト</p></td>
</tr>
<tr class="row-odd"><td colspan="2" rowspan="2"><p>ssh鍵認証情報</p></td>
<td colspan="2"><p>ssh秘密鍵ファイル</p></td>
<td><p>ssh秘密鍵ファイルを指定して鍵認証する場合の秘密鍵ファイルを入力します。</p>
<p>アップロードしたファイルは暗号化されて保存されます。</p>
<p>※登録後はダウンロード不可となります。</p>
</td>
<td><p>ー</p></td>
<td><p>ファイル選択</p></td>
<td><p>最大サイズ100Mバイト</p></td>
</tr>
<tr class="row-even"><td colspan="2"><p>パスフレーズ</p></td>
<td><p>ssh秘密鍵ファイルにパスフレーズが設定されている場合、パスフレーズを入力します。</p></td>
<td><p>ー</p></td>
<td><p>手動入力</p></td>
<td><p>最大長255バイト</p></td>
</tr>
<tr class="row-odd"><td rowspan="11"><p>Ansible利用情報</p></td>
<td rowspan="4"><p>Legacy/Role利用情報</p></td>
<td colspan="2"><p>認証方式</p></td>
<td><p>Ansible core・Ansible Automation Controller ・Ansible Execution Agentから作業対象へ接続する際の認証方式を選択します。</p>
<ul>
<li><div class="line-block">
<div class="line">パスワード認証</div>
<div class="line">ログインパスワードの入力が必須です。</div>
</div>
</li>
<li><div class="line-block">
<div class="line">鍵認証（パスフレーズなし）</div>
<div class="line">ssh秘密鍵ファイル（id_ras）のアップロードが必須です。</div>
</div>
</li>
<li><div class="line-block">
<div class="line">鍵認証（パスフレーズあり）</div>
<div class="line">ssh秘密鍵ファイル（id_ras）のアップロードと、パスフレーズの入力が必須です。</div>
</div>
</li>
<li><div class="line-block">
<div class="line">パスワード認証（winrm）</div>
<div class="line">必要に応じてWinRM接続情報を入力します。</div>
</div>
</li>
<li><div class="line-block">
<div class="line">証明書認証(winrm)</div>
<div class="line">winrm公開鍵ファイルとwinrm秘密鍵ファイルのアップロードが必須です。</div>
</div>
</li>
</ul>
</td>
<td><p>ー</p></td>
<td><p>リスト選択</p></td>
<td><p>説明欄記載のとおり</p></td>
</tr>
<tr class="row-even"><td rowspan="3"><p>WinRM接続情報</p></td>
<td><p>ポート番号</p></td>
<td><p>WindowsServerにWinRM接続する際のポート番号を入力します。</p>
<p>未入力の場合はデフォルト（5985 :http）で接続します。</p>
</td>
<td><p>ー</p></td>
<td><p>手動入力</p></td>
<td><p>0～65,535</p></td>
</tr>
<tr class="row-odd"><td><p>winrm公開鍵ファイル</p></td>
<td><p>WindowsServerに証明書認証でWinRM接続する場合の公開鍵ファイル「ansible_winrm_cert_pem」を入力します。</p>
<p>※登録後はダウンロード不可となります。</p>
</td>
<td><p>ー</p></td>
<td><p>ファイル選択</p></td>
<td><p>最大サイズ100Mバイト</p></td>
</tr>
<tr class="row-even"><td><p>winrm秘密鍵ファイル</p></td>
<td><p>WindowsServerに証明書認証でWinRM接続する場合の秘密鍵ファイル「ansible_winrm_cert_key_pem」を入力します。</p>
<p>※登録後はダウンロード不可となります。</p>
</td>
<td><p>ー</p></td>
<td><p>ファイル選択</p></td>
<td><p>最大サイズ100Mバイト</p></td>
</tr>
<tr class="row-odd"><td rowspan="3"><p>Pioneer利用情報</p></td>
<td colspan="2"><p>プロトコル</p></td>
<td><p>Pioneerから作業対象に接続する際のプロトコルを選択します。</p>
<ul>
<li><div class="line-block">
<div class="line">ssh</div>
<div class="line"><span class="menuselection">認証方式</span> はパスワード認証（winrm）以外を選択
してださい。</div>
</div>
</li>
<li><div class="line-block">
<div class="line">telnet</div>
<div class="line"><span class="menuselection">認証方式</span> で選択した認証方式は使用せずにtelnetで接続します。</div>
<div class="line"><span class="menuselection">ユーザ</span> と <span class="menuselection">パスワード</span> の入力が必須です。</div>
</div>
</li>
</ul>
</td>
<td><p>ー</p></td>
<td><p>リスト選択</p></td>
<td><p>説明欄記載のとおり</p></td>
</tr>
<tr class="row-even"><td colspan="2"><p>OS種別</p></td>
<td><p>作業対象のOSを選択します。</p>
<p>OS種は <span class="menuselection">Ansible-Pioneer ▶ OS種別</span> から登録します。</p>
</td>
<td><p>ー</p></td>
<td><p>リスト選択</p></td>
<td><p>説明欄記載のとおり</p></td>
</tr>
<tr class="row-odd"><td colspan="2"><p>LANG</p></td>
<td><p><span class="menuselection">ログインユーザ</span> のLANGを選択します。</p>
<p>未選択の場合はデフォルト「utf-8」になります。</p>
</td>
<td><p>ー
ー</p></td>
<td><p>リスト選択</p></td>
<td><p>説明欄記載のとおり</p></td>
</tr>
<tr class="row-even"><td colspan="3"><p>接続オプション</p></td>
<td><p>作業対象に接続する際に設定したいオプションを入力します。</p>
<ul>
<li><div class="line-block">
<div class="line">ssh接続の場合</div>
<div class="line"><code class="file docutils literal notranslate"><span class="pre">/etc/ansible.cfg/ssh_args</span></code> や<code class="file docutils literal notranslate"><span class="pre">/etc/ansible/ansible.cfg</span></code> に設定しているsshオプション以外のオプションを入力します。</div>
</div>
</li>
<li><div class="line-block">
<div class="line">telnet接続の場合</div>
<div class="line">telnet接続時のオプションを入力します。</div>
</div>
</li>
</ul>
</td>
<td><p>ー</p></td>
<td><p>手動入力</p></td>
<td><p>最大長4000バイト</p></td>
</tr>
<tr class="row-odd"><td colspan="3"><p>インベントリファイル追加オプション</p></td>
<td><p>ITAが作成するインベントリファイルに追加するパラメータがある場合に、パラメータをyaml形式で入力します。</p>
<p>尚、Ansible-Pioneerでは適用しません。</p>
<p>ITAが作成するインベントリファイルについては「 <a class="reference internal" href="#ansible-common-inventory-file"><span class="std std-ref">ITAが作成するインベントリファイル</span></a> 」を参照してください。</p>
<p>e.g.)</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">ansible_connection</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network_cli</span>
<span class="nt">ansible_network_os</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ios</span>
<span class="nt">ansible_become</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
<span class="nt">ansible_become_method</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">enable</span>
</pre></div>
</div>
<p>各パラメータ値を変数で記述することも出来ます。</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">ansible_become_password</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{△vvv△}}&#39;</span>

<span class="l l-Scalar l-Scalar-Plain">△：半角スペース</span>
<span class="s">&#39;:シングル・ダブルコーテーションで必ず囲んで下さい。</span>
</pre></div>
</div>
<p>パラメータ値を変数で記述する場合の詳細は、「 <a class="reference internal" href="#ansible-common-option-var-listup"><span class="std std-ref">インベントリファイル追加オプションとヘッダセクションのパラメータ値で変数抜出の対象となる変数の種類と書式</span></a> 」を参照してください 。</p>
<p>変数の具体値は <span class="menuselection">各モード ▶ 代入値自動登録設定</span> から登録します。</p>
</td>
<td><p>ー</p></td>
<td><p>手動入力</p></td>
<td><p>最大長4000バイト</p></td>
</tr>
<tr class="row-even"><td rowspan="2"><p>Ansible Automation Controller 利用 情報</p></td>
<td colspan="2"><p>インスタンスグループ名※1</p></td>
<td><p>Ansible Automation Controllerがクラスタ構成の場合、どのインスタンスグループで実行するかを選択します。</p>
<p>未選択の場合はAnsible Automation Controllerに設定されているデフォルトのインスタンスグループになります。</p>
<p>Ansible Automation Controllerがクラスタ構成でない場合は、未選択で構いません。</p>
</td>
<td><p>ー</p></td>
<td><p>リスト選択</p></td>
<td><p>説明欄記載のとおり</p></td>
</tr>
<tr class="row-odd"><td colspan="2"><p>接続タイプ</p></td>
<td><p>Ansible Automation Controllerの認証情報の接続タイプを選択します。</p>
<p>通常は「machine」を選択します。</p>
<p>「ansible_connectionをlocal」に設定する必要があるNetwork OSなど場合に「Network」を選択します。</p>
<ul>
<li><div class="line-block">
<div class="line">「Network」を選択した場合</div>
<div class="line-block">
<div class="line"><span class="menuselection">インベントリファイル追加 オプション</span> にPlatform Options（ansible_connection以外）を設定する必要が あります。</div>
</div>
</div>
</li>
</ul>
<p>e.g.)</p>
<p>インベントリファイル追加オプションの設定例</p>
<p>Network OSが「ios」の場合の設定値</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">ansible_network_os</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ios</span>
<span class="nt">ansible_become</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
<span class="nt">ansible_become_method</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">enable</span>
</pre></div>
</div>
<p>接続タイプについての詳細は、Ansible Automation Controller公式マニュアルのユーザガイドを参照してください。</p>
<p>Network OSとansible_connectionの関連やPlatform Optionsについての詳細はAnsible公式ドキュメントのPlatform Optionsを参照してください。</p>
</td>
<td><p>○</p></td>
<td><p>リスト選択</p></td>
<td><p>説明欄記載のとおり</p></td>
</tr>
<tr class="row-even"><td colspan="4"><p>備考</p></td>
<td><p>自由記述欄です。</p></td>
<td><p>ー</p></td>
<td><p>手動入力</p></td>
<td><p>最大長4000バイト</p></td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<div class="line-block">
<div class="line">※1「 <a class="reference internal" href="#ansible-common-aac-sync"><span class="std std-ref">Ansible Automation Controllerデータ同期</span></a> 」で取得したデータから選択します。</div>
</div>
</div>
</li>
</ol>
</section>
<section id="ansible-common-interface-information">
<span id="id23"></span><h3><span class="section-number">1.5.2. </span>インターフェース情報<a class="headerlink" href="#ansible-common-interface-information" title="Link to this heading">¶</a></h3>
<ol class="arabic">
<li><div class="line-block">
<div class="line">Ansible Core、Ansible Automation Controller、Ansible Execution Agentのいずれの実行エンジンを使用するか選択し、実行エンジンのサーバへの接続インターフェース情報のメンテナンス（閲覧/更新）を行います。</div>
</div>
<figure class="align-default" id="id52">
<a class="reference internal image-reference" href="../../_images/interface_information_v2_5.png"><img alt="サブメニュー画面（インタフェース情報）" src="../../_images/interface_information_v2_5.png" style="width: 800px;" />
</a>
<figcaption>
<p><span class="caption-number">図 1.92 </span><span class="caption-text">サブメニュー画面（インタフェース情報）</span><a class="headerlink" href="#id52" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</li>
<li><div class="line-block">
<div class="line"><span class="guilabel">編集</span> ボタンより、インターフェース情報の更新を行います。</div>
</div>
<figure class="align-default" id="id53">
<a class="reference internal image-reference" href="../../_images/registration_interface_information_v2.5.gif"><img alt="登録画面（インタフェース情報）" src="../../_images/registration_interface_information_v2.5.gif" style="width: 800px;" />
</a>
<figcaption>
<p><span class="caption-number">図 1.93 </span><span class="caption-text">登録画面（インタフェース情報）</span><a class="headerlink" href="#id53" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</li>
<li><div class="line-block">
<div class="line">登録画面の項目一覧は以下のとおりです。</div>
</div>
<table class="docutils align-left" id="id54">
<caption><span class="caption-number">表 1.125 </span><span class="caption-text">登録画面項目一覧（インタフェース情報）</span><a class="headerlink" href="#id54" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 8.9%" />
<col style="width: 8.9%" />
<col style="width: 8.9%" />
<col style="width: 44.4%" />
<col style="width: 8.9%" />
<col style="width: 8.9%" />
<col style="width: 11.1%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" colspan="3"><p>項目</p></th>
<th class="head"><p>説明</p></th>
<th class="head"><p>入力必須</p></th>
<th class="head"><p>入力方法</p></th>
<th class="head"><p>制約事項</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td colspan="3"><p>項番</p></td>
<td><p>登録時に自動採番した36桁の文字列が表示されます。</p></td>
<td><p>ー</p></td>
<td><p>自動入力</p></td>
<td><p>ー</p></td>
</tr>
<tr class="row-odd"><td colspan="3"><p>実行エンジン</p></td>
<td><p>実行するエンジンを下記の3種類から選択します。</p>
<ul>
<li><div class="line-block">
<div class="line">Ansible Core</div>
</div>
</li>
<li><div class="line-block">
<div class="line">Ansible Automation Controller</div>
</div>
</li>
<li><div class="line-block">
<div class="line">Ansible Execution Agent</div>
</div>
</li>
</ul>
</td>
<td><p>○</p></td>
<td><p>リスト選択</p></td>
<td><p>説明欄記載のとおり。</p></td>
</tr>
<tr class="row-even"><td rowspan="6"><p>Ansible Automation Controller インターフェース</p></td>
<td colspan="2"><p>代表ホスト</p></td>
<td><p><span class="menuselection">Ansible共通 ▶ Ansible Automation Controllerホスト一覧</span> に登録されているハイブリットノードか制御ノードより、ITAと通信するAnsible Automation Controllerを選択します。</p></td>
<td><p>ー</p></td>
<td><p>リスト選択</p></td>
<td><p><span class="menuselection">実行エンジン</span> がAnsible Automation Controllerの場合に入力必須</p></td>
</tr>
<tr class="row-odd"><td colspan="2"><p>プロトコル</p></td>
<td><p>Ansible Automation Controllerとの接続プロトコルを「http」/「https」のどちらかで入力します。</p></td>
<td><p>ー</p></td>
<td><p>手動入力</p></td>
<td><p><span class="menuselection">実行エンジン</span> がAnsible Automation Controllerの場合に入力必須</p></td>
</tr>
<tr class="row-even"><td colspan="2"><p>ポート</p></td>
<td><p>Ansible Automation Controllerとの接続プロトコルのポートを入力します。</p>
<p>通常はhttps（443）を入力します。</p>
</td>
<td><p>ー</p></td>
<td><p>手動入力</p></td>
<td><p><span class="menuselection">実行エンジン</span> がAnsible Automation Controllerの場合に入力必須</p></td>
</tr>
<tr class="row-odd"><td colspan="2"><p>組織名
※1</p></td>
<td><p>Ansible Automation Controllerに登録されている組織名を選択します。</p></td>
<td><p>ー</p></td>
<td><p>リスト選択</p></td>
<td><p><span class="menuselection">実行エンジン</span> がAnsible Automation Controllerの場合に入力必須</p></td>
</tr>
<tr class="row-even"><td colspan="2"><p>認証トークン</p></td>
<td><p>Ansible Automation Controllerに接続するユーザの認証トークンを入力します。</p></td>
<td></td>
<td></td>
<td><p>最大長255バイト</p>
<p><span class="menuselection">実行エンジン</span> がAnsible Automation Controllerの場合に入力必須</p>
</td>
</tr>
<tr class="row-odd"><td colspan="2"><p>REST APIタイムアウト値（単位秒）</p></td>
<td><p>作業実行時にITAからAnsible Automation ControllerへRestAPI発行時のタイムアウト値を入力します。</p>
<p>通常は60秒程度が推奨値です。</p>
<p>未入力の場合は、デフォルト値（60）を使用します。</p>
</td>
<td><p>ー</p></td>
<td><p>手動入力</p></td>
<td><p>60～3,600</p></td>
</tr>
<tr class="row-even"><td rowspan="2"><p>Proxy</p></td>
<td colspan="2"><p>Address</p></td>
<td><p>プロキシサーバのアドレスを入力します。</p>
<p>ITAがプロキシ環境下にある場合、Ansible Automation Controllerまでの疎通のために設定が必要な場合があります。</p>
<p>プロキシサーバのURLが</p>
<p>http://proxy.gate.co.jp:8080の場合</p>
<p>Addressには<a class="reference external" href="http://proxy.gate.co.jp">http://proxy.gate.co.jp</a>を入力します。</p>
<p>Portには 8080を入力します。</p>
</td>
<td><p>ー</p></td>
<td><p>手動入力</p></td>
<td><p>最大255バイト</p></td>
</tr>
<tr class="row-odd"><td colspan="2"><p>Port</p></td>
<td><p>プロキシサーバのポートを入力します。</p></td>
<td><p>ー</p></td>
<td><p>手動入力</p></td>
<td><p>1～65,535</p></td>
</tr>
<tr class="row-even"><td colspan="3"><p>実行時データ削除</p></td>
<td><p>作業実行時にAnsible Automation Controller又はAnsible Execution Agent内に一時的に生成したデータリソースを作業終了後に削除するかを選択します。</p>
<p>「True」を選択した場合に削除します。</p>
<p>削除されるデータリソースについての詳細は「 <a class="reference internal" href="#ansible-common-aac-resources-list"><span class="std std-ref">実行時データ削除で削除されるデータリソース</span></a> 」を参照してください。</p>
</td>
<td><p>ー</p></td>
<td><p>リスト選択</p></td>
<td><p><span class="menuselection">実行エンジン</span> がAnsible Automation ControllerかAnsible Execution Agentの場合に入力必須</p></td>
</tr>
<tr class="row-odd"><td colspan="3"><p>Ansible-vaultパスワード</p></td>
<td><p>ansible-vaultコマンドで変数の具体値を暗号化する場合のパスワードを入力します。</p>
<p>未入力の場合は、デフォルト値を使用します。</p>
</td>
<td><p>ー</p></td>
<td><p>手動入力</p></td>
<td><p>最大長64バイト</p></td>
</tr>
<tr class="row-even"><td colspan="3"><p>オプションパラメータ</p></td>
<td><p>Movement共通のオプションパラメータを入力します。</p>
<p>オプションパラメータについての詳細は「 <a class="reference internal" href="#ansible-common-option-parameter-list"><span class="std std-ref">オプションパラメータ一覧</span></a> 」を参照してください。</p>
<ul>
<li><div class="line-block">
<div class="line"><span class="menuselection">実行エンジン</span> が「Ansible Core」か
「Ansible Execution Agent」の場合</div>
<div class="line">ansible-playbookコマンドの</div>
<div class="line">ansible-playbookコマンドのオプションパラメータを入力します。</div>
</div>
</li>
<li><div class="line-block">
<div class="line"><span class="menuselection">実行エンジン</span> が「Ansible Automation Controller」の場合</div>
<div class="line">ジョブテンプレートのパラメータを入力します。</div>
<div class="line">ジョブテンプレートについての詳細は、Ansible Automation Controller公式マニュアルのユーザガイドを参照してください。</div>
</div>
</li>
</ul>
<p>Movement固有のオプションパラメータは <span class="menuselection">各モード ▶ Movement一覧</span> から入力します。</p>
</td>
<td><p>ー</p></td>
<td><p>手動入力</p></td>
<td><p>最大長4000バイト</p></td>
</tr>
<tr class="row-odd"><td colspan="3"><p>NULL連携</p></td>
<td><p><span class="menuselection">各モード ▶ 代入値自動登録設定</span> で <span class="menuselection">パラメータシート</span> の具体値がNULL（空白）の場合に、 <span class="menuselection">各モード ▶ 代入値管理</span> にNULL（空白）の値を登録するかを選択します。</p>
<p><span class="menuselection">各モード ▶ 代入値自動登録設定</span> の <span class="menuselection">NULL連携</span> が未選択の場合、この値が適用されます。</p>
<ul>
<li><div class="line-block">
<div class="line">True</div>
<div class="line">パラメータシートの値がどのような値でも <span class="menuselection">各モード ▶ 代入値管理</span> に登録が行われます。</div>
</div>
</li>
<li><div class="line-block">
<div class="line">False</div>
<div class="line">パラメータシートに値が入力されていれば <span class="menuselection">各モード ▶ 代入値管理</span> に登録が行われます。</div>
</div>
</li>
</ul>
<p>未選択の場合「False」を適用します。</p>
</td>
<td><p>○</p></td>
<td><p>リスト選択</p></td>
<td><p>説明欄記載のとおり。</p></td>
</tr>
<tr class="row-even"><td colspan="3"><p>状態監視周期（単位ミリ秒）</p></td>
<td><p><span class="menuselection">各モード ▶ 作業状態確認</span> に表示される情報のリフレッシュ間隔を入力します。</p>
<p>通常は1000ミリ秒程度が推奨値です。</p>
</td>
<td><p>○</p></td>
<td><p>手動入力</p></td>
<td><p>1,000～2,147,483,647</p></td>
</tr>
<tr class="row-odd"><td colspan="3"><p>進行状態表示行数</p></td>
<td><p><span class="menuselection">各モード ▶ 作業状態確認</span> に表示する実行ログ・エラーログの最大表示行数を入力します。</p>
<p><span class="menuselection">ステータス</span> が以下の場合、ログの終端から入力した行数分を出力します。</p>
<ul>
<li><div class="line-block">
<div class="line">「未実行」</div>
</div>
</li>
<li><div class="line-block">
<div class="line">「準備中」</div>
</div>
</li>
<li><div class="line-block">
<div class="line">「準備完了」</div>
</div>
</li>
<li><div class="line-block">
<div class="line">「実行待ち」</div>
</div>
</li>
<li><div class="line-block">
<div class="line">「実行中」</div>
</div>
</li>
<li><div class="line-block">
<div class="line">「実行中（遅延）」</div>
</div>
</li>
</ul>
<p><span class="menuselection">ステータス</span> が以下の場合、すべてのログを出力します。</p>
<ul>
<li><div class="line-block">
<div class="line">「完了」</div>
</div>
</li>
<li><div class="line-block">
<div class="line">「完了（異常）」</div>
</div>
</li>
<li><div class="line-block">
<div class="line">「想定外エラー」</div>
</div>
</li>
<li><div class="line-block">
<div class="line">「緊急停止」</div>
</div>
</li>
<li><div class="line-block">
<div class="line">「未実行（予約）」</div>
</div>
</li>
<li><div class="line-block">
<div class="line">「予約取消」</div>
</div>
</li>
</ul>
<p>環境毎にチューニングを要しますが、通常は1000行程度が推奨値です。</p>
</td>
<td><p>○</p></td>
<td><p>手動入力</p></td>
<td><p>0～2,147,483,647</p></td>
</tr>
<tr class="row-even"><td colspan="3"><p>備考</p></td>
<td><p>自由記述欄です。</p></td>
<td><p>ー</p></td>
<td><p>手動入力</p></td>
<td><p>最大長4000バイト</p></td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<div class="line-block">
<div class="line">※1「 <a class="reference internal" href="#ansible-common-aac-sync"><span class="std std-ref">Ansible Automation Controllerデータ同期</span></a> 」で取得したデータから選択します。</div>
</div>
</div>
</li>
</ol>
</section>
<section id="ansible-common-ansible-automation-controller-hosts">
<span id="id24"></span><h3><span class="section-number">1.5.3. </span>Ansible Automation Controller ホスト一覧<a class="headerlink" href="#ansible-common-ansible-automation-controller-hosts" title="Link to this heading">¶</a></h3>
<ol class="arabic">
<li><div class="line-block">
<div class="line">Ansible Automation ControllerへのRestAPI実行に必要な情報、および構築資材をAnsible Automation Controllerにファイル転送するために必要な情報のメンテナンス(閲覧/登録/更新/廃止)を行います。</div>
<div class="line">クラスタ構成の場合は、構成している全てのホストを登録してください。</div>
<div class="line">ただし、Ansible Automation Controllerのhop nodeの登録は不要です。</div>
</div>
<figure class="align-default" id="id55">
<a class="reference internal image-reference" href="../../_images/ansible_automation_controller_host_list.png"><img alt="サブメニュー画面（Ansible Automation Controller ホスト一覧）" src="../../_images/ansible_automation_controller_host_list.png" style="width: 800px;" />
</a>
<figcaption>
<p><span class="caption-number">図 1.94 </span><span class="caption-text">サブメニュー画面（Ansible Automation Controller ホスト一覧）</span><a class="headerlink" href="#id55" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</li>
<li><div class="line-block">
<div class="line"><span class="guilabel">登録</span> ボタンより、Ansible Automation Controllerのホスト情報の登録を行います。</div>
</div>
<figure class="align-default" id="id56">
<a class="reference internal image-reference" href="../../_images/ansible_automation_controller_host_list.gif"><img alt="登録画面（Ansible Automation Controller ホスト一覧）" src="../../_images/ansible_automation_controller_host_list.gif" style="width: 800px;" />
</a>
<figcaption>
<p><span class="caption-number">図 1.95 </span><span class="caption-text">登録画面（Ansible Automation Controller ホスト一覧）</span><a class="headerlink" href="#id56" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</li>
<li><div class="line-block">
<div class="line">登録画面の項目一覧は以下のとおりです。</div>
</div>
<table class="docutils align-left" id="id57">
<caption><span class="caption-number">表 1.126 </span><span class="caption-text">登録画面項目一覧（Ansible Automation Controller ホスト一覧）</span><a class="headerlink" href="#id57" title="Link to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head" colspan="2"><p>項目</p></th>
<th class="head"><p>説明</p></th>
<th class="head"><p>入力必須</p></th>
<th class="head"><p>入力方法</p></th>
<th class="head"><p>制約事項</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td colspan="2"><p>項番</p></td>
<td><p>登録時に自動採番した36桁の文字列が表示されます。</p></td>
<td><p>ー</p></td>
<td><p>自動入力</p></td>
<td><p>ー</p></td>
</tr>
<tr class="row-odd"><td colspan="2"><p>ホスト</p></td>
<td><p>Ansible Automation Controllerのホスト名（またはIPアドレス）を入力します。</p></td>
<td><p>○</p></td>
<td><p>手動入力</p></td>
<td><p>最大長255バイト</p></td>
</tr>
<tr class="row-even"><td colspan="2"><p>認証方式</p></td>
<td><p>Ansible Automation Controllerへファイル転送(scp)で接続する際の認証方式を選択します。</p>
<ul>
<li><div class="line-block">
<div class="line">パスワード認証</div>
<div class="line">ログインユーザとパスワードの入力が必須です。</div>
</div>
</li>
<li><div class="line-block">
<div class="line">鍵認証（パスフレーズなし）</div>
<div class="line">ssh秘密鍵ファイル(id_ras)のアップロードが必須です。</div>
</div>
</li>
<li><div class="line-block">
<div class="line">鍵認証（パスフレーズあり）</div>
<div class="line">ssh秘密鍵ファイル(id_ras)のアップロードと、パスフレーズの入力が必須です。</div>
</div>
</li>
</ul>
</td>
<td><p>○</p></td>
<td><p>リスト選択</p></td>
<td><p>説明欄記載のとおり。</p></td>
</tr>
<tr class="row-odd"><td colspan="2"><p>ユーザ</p></td>
<td><p>Ansible Automation Controllerへファイル転送(scp)で接続する際のログインユーザを入力します。</p>
<p>ログインユーザは、Ansible Automation Controllerインストール時に生成されるawxユーザにパスワードを設定し、awxユーザを入力して下さい。</p>
</td>
<td><p>○</p></td>
<td><p>手動入力</p></td>
<td><p>最大長255バイト</p></td>
</tr>
<tr class="row-even"><td colspan="2"><p>パスワード</p></td>
<td><p><span class="menuselection">認証方式</span> でパスワード認証を選択した場合、必須入力となります。
ログインユーザのパスワードを入力します。</p></td>
<td><p>ー</p></td>
<td><p>手動入力</p></td>
<td><p>最大長4000バイト</p></td>
</tr>
<tr class="row-odd"><td rowspan="2"><p>ssh鍵認証情報</p></td>
<td><p>ssh秘密鍵ファイル</p></td>
<td><p><span class="menuselection">認証方式</span> で鍵認証を選択した場合、必須入力となります。ssh秘密鍵ファイルを入力します。</p>
<p>アップロードしたファイルは暗号化されて保存されます。</p>
<p>※登録後はダウンロード不可となります。</p>
</td>
<td><p>ー</p></td>
<td><p>ファイル選択</p></td>
<td><p>最大サイズ100Mバイト</p></td>
</tr>
<tr class="row-even"><td><p>パスフレーズ</p></td>
<td><p>ssh秘密鍵ファイルにパスフレーズが設定されている場合、パスフレーズを入力します。</p></td>
<td><p>ー</p></td>
<td><p>手動入力</p></td>
<td><p>最大長255バイト</p></td>
</tr>
<tr class="row-odd"><td colspan="2"><p>ポート</p></td>
<td><p>Ansible Automation Controllerにssh接続する際の、ポート番号を指定することができます。</p>
<p>デフォルトは22です。</p>
</td>
<td><p>ー</p></td>
<td><p>手動入力</p></td>
<td><p>数値項目</p></td>
</tr>
<tr class="row-even"><td colspan="2"><p>Execution node</p></td>
<td><p>クラスタ構成で構築されているAnsible Automation Controllerで対象ホストが「execution node」の場合に「True」を選択します。</p>
<p>「Execution node」が「True」の場合、<span class="menuselection">Ansible共通 ▶ インターフェース情報</span>の <span class="menuselection">代表ホスト</span> に表示されません。</p>
</td>
<td><p>ー</p></td>
<td><p>リスト選択</p></td>
<td><p>説明欄記載のとおり。</p></td>
</tr>
<tr class="row-odd"><td colspan="2"><p>備考</p></td>
<td><p>自由記述欄です。</p></td>
<td><p>ー</p></td>
<td><p>手動入力</p></td>
<td><p>最大長4000バイト</p></td>
</tr>
</tbody>
</table>
</li>
</ol>
</section>
<section id="ansible-common-global-variable-list">
<span id="id25"></span><h3><span class="section-number">1.5.4. </span>グローバル変数管理<a class="headerlink" href="#ansible-common-global-variable-list" title="Link to this heading">¶</a></h3>
<ol class="arabic">
<li><div class="line-block">
<div class="line">Playbookや対話ファイルで共通利用するグローバル変数名のメンテナンス(閲覧/登録/更新/廃止)を行います。</div>
</div>
<figure class="align-default" id="id58">
<a class="reference internal image-reference" href="../../_images/global_variable_list.png"><img alt="サブメニュー画面（グローバル変数管理）" src="../../_images/global_variable_list.png" style="width: 800px;" />
</a>
<figcaption>
<p><span class="caption-number">図 1.96 </span><span class="caption-text">サブメニュー画面（グローバル変数管理）</span><a class="headerlink" href="#id58" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</li>
<li><div class="line-block">
<div class="line"><span class="guilabel">登録</span> ボタンより、グローバル変数の登録を行います。</div>
</div>
<figure class="align-default" id="id59">
<a class="reference internal image-reference" href="../../_images/global_variable_list.gif"><img alt="登録画面（グローバル変数管理）" src="../../_images/global_variable_list.gif" style="width: 800px;" />
</a>
<figcaption>
<p><span class="caption-number">図 1.97 </span><span class="caption-text">登録画面（グローバル変数管理）</span><a class="headerlink" href="#id59" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</li>
<li><div class="line-block">
<div class="line">登録画面の項目一覧は以下のとおりです。</div>
</div>
<table class="docutils align-left" id="id60">
<caption><span class="caption-number">表 1.127 </span><span class="caption-text">登録画面項目一覧（グローバル変数管理）</span><a class="headerlink" href="#id60" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 15.4%" />
<col style="width: 61.5%" />
<col style="width: 7.7%" />
<col style="width: 7.7%" />
<col style="width: 7.7%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>項目</p></th>
<th class="head"><p>説明</p></th>
<th class="head"><p>入力必須</p></th>
<th class="head"><p>入力方法</p></th>
<th class="head"><p>制約事項</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>項番</p></td>
<td><div class="line-block">
<div class="line">登録時に自動採番した36桁の文字列が表示されます。</div>
</div>
</td>
<td><p>ー</p></td>
<td><p>自動入力</p></td>
<td><p>ー</p></td>
</tr>
<tr class="row-odd"><td><p>グローバル変数名</p></td>
<td><div class="line-block">
<div class="line">変数名を入力します。</div>
<div class="line">変数名は、「GBL_****」形式で入力します。</div>
<div class="line">****：半角英数字とアンダースコア（ _ ）が利用可能です。(最小値:1バイト、最大値:255バイト)</div>
</div>
</td>
<td><p>○</p></td>
<td><p>手動入力</p></td>
<td><p>説明欄記載のとおり。</p></td>
</tr>
<tr class="row-even"><td><p>具体値</p></td>
<td><p>具体値を入力します。複数行の具体値も入力できますが、Pioneerの対話ファイルで使用しているグローバル変数で複数行の具体値を設定すると、作業実行時にエラーとなります。</p></td>
<td><p>ー</p></td>
<td><p>手動入力</p></td>
<td><p>最大長4000バイト</p></td>
</tr>
<tr class="row-odd"><td><p>変数名説明</p></td>
<td><p>変数に対する説明・コメントを入力します。</p></td>
<td><p>ー</p></td>
<td><p>手動入力</p></td>
<td><p>最大長4000バイト</p></td>
</tr>
<tr class="row-even"><td><p>備考</p></td>
<td><p>自由記述欄です。</p></td>
<td><p>ー</p></td>
<td><p>手動入力</p></td>
<td><p>最大長4000バイト</p></td>
</tr>
</tbody>
</table>
</li>
</ol>
</section>
<section id="ansible-common-file-list">
<span id="id26"></span><h3><span class="section-number">1.5.5. </span>ファイル管理<a class="headerlink" href="#ansible-common-file-list" title="Link to this heading">¶</a></h3>
<ol class="arabic">
<li><div class="line-block">
<div class="line">Playbookや対話ファイルで共通利用するファイル素材とファイル埋込変数のメンテナンス（閲覧/登録/更新/廃止）を行います。</div>
<div class="line">ファイル素材を登録しておくことで、Playbook内で使用するファイル素材をファイル埋込変数名で指定することができます。</div>
</div>
<figure class="align-default" id="id61">
<a class="reference internal image-reference" href="../../_images/contents_list.png"><img alt="サブメニュー画面（ファイル管理）" src="../../_images/contents_list.png" style="width: 800px;" />
</a>
<figcaption>
<p><span class="caption-number">図 1.98 </span><span class="caption-text">サブメニュー画面（ファイル管理）</span><a class="headerlink" href="#id61" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</li>
<li><div class="line-block">
<div class="line"><span class="guilabel">登録</span> ボタンより、ファイル埋込変数の登録を行います。</div>
</div>
<figure class="align-default" id="id62">
<a class="reference internal image-reference" href="../../_images/contents_list.gif"><img alt="登録画面（ファイル管理）" src="../../_images/contents_list.gif" style="width: 800px;" />
</a>
<figcaption>
<p><span class="caption-number">図 1.99 </span><span class="caption-text">登録画面（ファイル管理）</span><a class="headerlink" href="#id62" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</li>
<li><div class="line-block">
<div class="line">登録画面の項目一覧は以下のとおりです。</div>
</div>
<table class="docutils align-left" id="id63">
<caption><span class="caption-number">表 1.128 </span><span class="caption-text">登録画面項目一覧（ファイル管理）</span><a class="headerlink" href="#id63" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 15.0%" />
<col style="width: 50.0%" />
<col style="width: 5.0%" />
<col style="width: 10.0%" />
<col style="width: 20.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>項目</p></th>
<th class="head"><p>説明</p></th>
<th class="head"><p>入力必須</p></th>
<th class="head"><p>入力方法</p></th>
<th class="head"><p>制約事項</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>素材ID</p></td>
<td><div class="line-block">
<div class="line">登録時に自動採番した36桁の文字列が表示されます。</div>
</div>
</td>
<td><p>ー</p></td>
<td><p>自動入力</p></td>
<td><p>ー</p></td>
</tr>
<tr class="row-odd"><td><p>ファイル埋込変数名</p></td>
<td><div class="line-block">
<div class="line">Playbookに埋め込む変数名を入力します。</div>
<div class="line">変数名は、「CPF_****」形式で入力します。</div>
<div class="line">****：半角英数字とアンダースコア（ _ ）が利用可能です。（最小値:1バイト、最大値:255バイト）</div>
</div>
</td>
<td><p>○</p></td>
<td><p>手動入力</p></td>
<td><p>説明欄記載のとおり。</p></td>
</tr>
<tr class="row-even"><td><p>ファイル素材</p></td>
<td><p>ファイル素材をアップロードします。</p></td>
<td><p>○</p></td>
<td><p>ファイル登録</p></td>
<td><p>最大サイズ100Mバイト</p></td>
</tr>
<tr class="row-odd"><td><p>備考</p></td>
<td><p>自由記述欄です。</p></td>
<td><p>ー</p></td>
<td><p>手動入力</p></td>
<td><p>最大長4000バイト</p></td>
</tr>
</tbody>
</table>
</li>
</ol>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<div class="line-block">
<div class="line"><strong>Ansible-Legacy・Ansible-LegacyRoleでのファイル埋込変数の使用例</strong></div>
<div class="line"><span class="menuselection">Ansible共通 ▶ ファイル管理</span> で登録したファイル素材をPlaybookに記述する場合、ファイル埋込変数名を記述します。</div>
<div class="line">※ファイル名にスペースなどが含まれている場合、適切にクォーテーションで囲まないと、作業実行時にエラーになる場合があります。</div>
</div>
<div class="line-block">
<div class="line">e.g.)</div>
</div>
<ul>
<li><div class="line-block">
<div class="line"><span class="menuselection">Ansible共通 ▶ ファイル管理</span> で登録したhostsファイルをファイル埋込変数を使用して作業対象サーバの/etc/配下にコピーする場合</div>
</div>
<ol class="arabic">
<li><div class="line-block">
<div class="line"><span class="menuselection">Ansible共通 ▶ ファイル管理</span> からhostsファイルを登録します。</div>
</div>
<table class="docutils align-left" id="id64">
<caption><span class="caption-number">表 1.129 </span><span class="caption-text">ファイル管理の登録内容</span><a class="headerlink" href="#id64" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 42.9%" />
<col style="width: 57.1%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>ファイル埋込変数名</p></th>
<th class="head"><p>ファイル素材</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>CPF_hosts</p></td>
<td><p>hosts</p></td>
</tr>
</tbody>
</table>
</li>
<li><div class="line-block">
<div class="line">下記のようにPlaybookを記述します。</div>
<div class="line">※destはファイル名も記述してください。ファイル名の指定がない場合、登録したファイル素材のファイル名の前にITAの管理番号が付与された名前のファイル名で処理されます。</div>
<div class="line">　たとえば、dest=/etc/ とした場合、ファイル名は/etc/36桁の文字列_hostsとなります。</div>
</div>
<div class="line-block">
<div class="line"><strong>Playbookの記述</strong></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">copy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">src=&#39;{{ CPF_hosts }}&#39; dest=/etc/hosts</span>
</pre></div>
</div>
</li>
</ol>
</li>
<li><div class="line-block">
<div class="line"><span class="menuselection">Ansible共通 ▶ ファイル管理</span> で登録したtool.tgzファイルをファイル埋込変数を使用して作業対象サーバの/usr/local/bin/配下に解凍する場合</div>
</div>
<ol class="arabic">
<li><div class="line-block">
<div class="line"><span class="menuselection">Ansible共通 ▶ ファイル管理</span> からtool.tgzファイルを登録します。</div>
</div>
<table class="docutils align-left" id="id65">
<caption><span class="caption-number">表 1.130 </span><span class="caption-text">ファイル管理の登録内容</span><a class="headerlink" href="#id65" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 42.9%" />
<col style="width: 57.1%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>ファイル埋込変数名</p></th>
<th class="head"><p>ファイル素材</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>CPF_tool_tgz</p></td>
<td><p>tool.tgz</p></td>
</tr>
</tbody>
</table>
</li>
<li><div class="line-block">
<div class="line">下記のようにPlaybookを記述します。</div>
</div>
<div class="line-block">
<div class="line"><strong>Playbookの記述</strong></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">unarchive</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">src={{ CPF_tool_tgz }} dest=/usr/local/bin</span>
</pre></div>
</div>
</li>
</ol>
</li>
</ul>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<div class="line-block">
<div class="line"><strong>Ansible-Pioneerでのファイル埋込変数の使用例</strong></div>
<div class="line"><span class="menuselection">Ansible共通 ▶ ファイル管理</span> で登録したファイル素材を対話ファイルに記述する場合、対話ファイルにファイル埋込変数名を記述します。</div>
<div class="line">※ファイル名にスペースなどが含まれている場合、適切にクォーテーションで囲まないと、作業実行時にエラーになる場合があります。</div>
</div>
<div class="line-block">
<div class="line">e.g.)</div>
</div>
<ul>
<li><div class="line-block">
<div class="line"><span class="menuselection">Ansible共通 ▶ ファイル管理</span> で登録したhostsファイルをファイル埋込変数を使用して作業対象サーバの/etc/配下にコピーする場合</div>
</div>
<ol class="arabic">
<li><div class="line-block">
<div class="line"><span class="menuselection">Ansible共通 ▶ ファイル管理</span> からhostsファイルを登録します。</div>
</div>
<table class="docutils align-left" id="id66">
<caption><span class="caption-number">表 1.131 </span><span class="caption-text">ファイル管理の登録内容</span><a class="headerlink" href="#id66" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 42.9%" />
<col style="width: 57.1%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>ファイル埋込変数名</p></th>
<th class="head"><p>ファイル素材</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>CPF_hosts</p></td>
<td><p>hosts</p></td>
</tr>
</tbody>
</table>
</li>
<li><div class="line-block">
<div class="line">下記のように対話ファイルを記述します。</div>
<div class="line">※転送先はファイル名も記述してください。ファイル名の指定がない場合、登録したファイル素材のファイル名の前にITAの管理番号が付与された名前のファイル名で処理されます。</div>
<div class="line">　たとえば、/etc/. とした場合、ファイル名は/etc/36桁の文字列_hostsとなります。</div>
</div>
<div class="line-block">
<div class="line"><strong>対話ファイルの記述</strong></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">conf</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># ファイルのサイズでタイマ値調整</span>
<span class="w">  </span><span class="nt">timeout</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">60</span>
<span class="nt">exec_list</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># 対象機器へのログインパスワード認証</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">expect</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;password:&#39;</span>
<span class="w">    </span><span class="nt">exec</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">__loginpassword__</span><span class="nv"> </span><span class="s">}}&#39;</span>
<span class="w">  </span><span class="c1"># 作業対象側よりscpコマンドでAAC側に配置されているファイルを作業対象にファイル転送</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">expect</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">__loginuser__</span><span class="nv"> </span><span class="s">}}@{{</span><span class="nv"> </span><span class="s">__dnshostname__</span><span class="nv"> </span><span class="s">}}&#39;</span>
<span class="w">    </span><span class="nt">exec</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;scp</span><span class="nv"> </span><span class="s">-o</span><span class="nv"> </span><span class="s">StrictHostKeyChecking=no</span><span class="nv"> </span><span class="s">-o</span><span class="nv"> </span><span class="s">UserKnownHostsFile=/dev/null</span><span class="nv"> </span><span class="s">{{</span><span class="nv"> </span><span class="s">VAR_scp_user</span><span class="nv"> </span><span class="s">}}@{{</span><span class="nv"> </span><span class="s">VAR_aac_host</span><span class="nv"> </span><span class="s">}}:{{</span><span class="nv"> </span><span class="s">CPF_hosts</span><span class="nv"> </span><span class="s">}}</span><span class="nv"> </span><span class="s">/etc/hosts&#39;</span>
<span class="w">  </span><span class="c1"># scpコマンドのパスワードログイン認証(AAC側)</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">expect</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;password:&#39;</span>
<span class="w">    </span><span class="nt">exec</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">VAR_scp_user_password</span><span class="nv"> </span><span class="s">}}&#39;</span>
<span class="w">  </span><span class="c1"># 対話ファイル終了</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">expect</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">__loginuser__</span><span class="nv"> </span><span class="s">}}@{{</span><span class="nv"> </span><span class="s">__dnshostname__</span><span class="nv"> </span><span class="s">}}&#39;</span>
<span class="w">    </span><span class="nt">exec</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">exit</span>
</pre></div>
</div>
<table class="docutils align-left" id="id67">
<caption><span class="caption-number">表 1.132 </span><span class="caption-text">変数の具体値</span><a class="headerlink" href="#id67" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 42.9%" />
<col style="width: 57.1%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>変数</p></th>
<th class="head"><p>具体値</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>VAR_scp_user</p></td>
<td><p>awx</p></td>
</tr>
<tr class="row-odd"><td><p>VAR_scp_user_password</p></td>
<td><p>awxユーザパスワード</p></td>
</tr>
<tr class="row-even"><td><p>VAR_aac_host</p></td>
<td><p>Ansible Automation Controller</p></td>
</tr>
</tbody>
</table>
</li>
</ol>
</li>
</ul>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<div class="line-block">
<div class="line"><strong>大容量ファイルのファイル登録</strong></div>
<div class="line">大容量のファイルを送信する際に、「認証に失敗しました。」というエラーメッセージが表示されることがあります。</div>
<div class="line">この事象は、以下のような複数の要因によって、ファイル登録の認証プロセスに遅延が発生し、アクセストークンの有効期限が切れたために発生します。</div>
<div class="line">　・ネットワーク回線の状態</div>
<div class="line">　・通信経路の途中にあるネットワーク機器による、セキュリティチェックやフィルタリング</div>
<div class="line"><br /></div>
<div class="line">このような場合には、<a class="reference internal" href="../platform_management/keycloak_console.html#access-token-lifespan-change"><span class="std std-ref">アクセストークン生存期間の変更</span></a> を確認し、必要に応じて生存期間の変更を実施してください。</div>
</div>
</div>
</section>
<section id="ansible-common-template-list">
<span id="id27"></span><h3><span class="section-number">1.5.6. </span>テンプレート管理<a class="headerlink" href="#ansible-common-template-list" title="Link to this heading">¶</a></h3>
<ol class="arabic">
<li><div class="line-block">
<div class="line">Playbookや対話ファイルで共通利用するテンプレートファイル素材とテンプレート埋込変数のメンテナンス（閲覧/登録/更新/廃止）を行います。</div>
<div class="line">テンプレートファイル素材を登録しておくことで、Playbook内で使用するテンプレートファイル素材をテンプレート埋込変数で指定することができます。</div>
</div>
<figure class="align-default" id="id68">
<a class="reference internal image-reference" href="../../_images/template_list.png"><img alt="サブメニュー画面（テンプレート管理）" src="../../_images/template_list.png" style="width: 800px;" />
</a>
<figcaption>
<p><span class="caption-number">図 1.100 </span><span class="caption-text">サブメニュー画面（テンプレート管理）</span><a class="headerlink" href="#id68" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</li>
<li><div class="line-block">
<div class="line"><span class="guilabel">登録</span> ボタンより、テンプレート埋込変数の登録を行います。</div>
</div>
<figure class="align-default" id="id69">
<a class="reference internal image-reference" href="../../_images/template_list.gif"><img alt="登録画面（テンプレート管理）" src="../../_images/template_list.gif" style="width: 800px;" />
</a>
<figcaption>
<p><span class="caption-number">図 1.101 </span><span class="caption-text">登録画面（テンプレート管理）</span><a class="headerlink" href="#id69" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</li>
<li><div class="line-block">
<div class="line">登録画面の項目一覧は以下のとおりです。</div>
</div>
<table class="docutils align-left" id="id70">
<caption><span class="caption-number">表 1.133 </span><span class="caption-text">登録画面項目一覧（テンプレート管理）</span><a class="headerlink" href="#id70" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 15.0%" />
<col style="width: 50.0%" />
<col style="width: 5.0%" />
<col style="width: 10.0%" />
<col style="width: 20.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>項目</p></th>
<th class="head"><p>説明</p></th>
<th class="head"><p>入力必須</p></th>
<th class="head"><p>入力方法</p></th>
<th class="head"><p>制約事項</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>素材ID</p></td>
<td><div class="line-block">
<div class="line">登録時に自動採番した36桁の文字列が表示されます。</div>
</div>
</td>
<td><p>ー</p></td>
<td><p>自動入力</p></td>
<td><p>ー</p></td>
</tr>
<tr class="row-odd"><td><p>テンプレート埋込変数名</p></td>
<td><div class="line-block">
<div class="line">Playbookに埋め込む変数名を入力します。</div>
<div class="line">変数名は、「TPF_****」形式で入力します。</div>
<div class="line">****：半角英数字とアンダースコア（ _ ）が利用可能です。（最小値:1バイト、最大値:255バイト）</div>
</div>
</td>
<td><p>○</p></td>
<td><p>手動入力</p></td>
<td><p>説明欄記載のとおり。</p></td>
</tr>
<tr class="row-even"><td><p>テンプレート素材</p></td>
<td><p>Playbookで使用するテンプレートファイル素材をアップロードします。</p></td>
<td><p>○</p></td>
<td><p>ファイル登録</p></td>
<td><div class="line-block">
<div class="line">テキスト形式</div>
<div class="line">最大サイズ100Mバイト</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>変数定義</p></td>
<td><div class="line-block">
<div class="line">テンプレートファイル素材内で使用している変数を定義します。</div>
<div class="line">テンプレートファイル素材内で使用出来る変数は5種類あります。※1</div>
</div>
</td>
<td><p>ー</p></td>
<td><p>手動入力</p></td>
<td><p>最大長4000バイト</p></td>
</tr>
<tr class="row-even"><td><p>備考</p></td>
<td><p>自由記述欄です。</p></td>
<td><p>ー</p></td>
<td><p>手動入力</p></td>
<td><p>最大長4000バイト</p></td>
</tr>
</tbody>
</table>
</li>
</ol>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<div class="line-block">
<div class="line"><strong>テンプレートの変数定義から変数を抽出するタイミング</strong></div>
<div class="line">内部の処理でテンプレートの変数定義から変数を抽出します。抽出した変数は、 <span class="menuselection">各モード ▶ 代入値自動登録設定</span> で具体値が登録可能になります。</div>
<div class="line">抽出のタイミングはリアルタイムではないので、 <span class="menuselection">各モード ▶ 代入値自動登録設定</span> で変数が扱えるまでに <strong>時間がかかる</strong> 場合があります。</div>
</div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<div class="line-block">
<div class="line">※1 <strong>変数定義の注意事項</strong></div>
<div class="line">テンプレートファイル内で使用する変数は、 <span class="menuselection">変数定義</span> に入力する必要があります。</div>
<div class="line">テンプレートファイル内で使用出来る変数は5種類あります。変数定義の注意事項は以下のとおりです。</div>
<div class="line">同名の変数をdefault変数定義ファイルなどに定義している場合は、変数構造を合わせる必要があります。変数構造が一致していない場合は登録でエラーとなります。</div>
</div>
<table class="docutils align-left" id="id71">
<caption><span class="caption-number">表 1.134 </span><span class="caption-text">変数定義の注意事項</span><a class="headerlink" href="#id71" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 25.0%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>種類</p></th>
<th class="head"><p>注意事項</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>通常変数</p></td>
<td><p>具体値は省略可能です。</p>
<p>e.g.)</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">vvv</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>複数具体値変数</p></td>
<td><p>具体値は省略可能です。</p>
<p>e.g.)</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">vvv</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vaule</span>
<span class="nt">vvv</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><p>多段変数</p></td>
<td><p>階層化された変数構造が定義出来ます。</p>
<p>e.g.)</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">vvv</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">item1</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value       ←メンバー変数</span>
<span class="w">    </span><span class="nt">item2</span><span class="p">:</span><span class="w">             </span><span class="l l-Scalar l-Scalar-Plain">←メンバー変数</span>
<span class="nt">vvv</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">array</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">item1</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value   ←メンバー変数</span>
<span class="w">        </span><span class="nt">item2</span><span class="p">:</span><span class="w">         </span><span class="l l-Scalar l-Scalar-Plain">←メンバー変数</span>
</pre></div>
</div>
<p>多段変数を定義したテンプレートは、Ansible-LegacyRoleでしか使用できません。</p>
<p>同名の変数をdefault変数定義ファイルなどに定義している場合は、変数構造を合わせる必要があります。変数構造が一致していない場合は登録でエラーとなります。</p>
</td>
</tr>
<tr class="row-odd"><td><p>グローバル変数</p></td>
<td><p>具体値は省略可能です。</p>
<p>e.g.)</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">GBL_xxx</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vaule</span>
<span class="nt">GBL_xxx_2</span><span class="p">:</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><p>ITA独自変数</p></td>
<td><p>変数の定義は不要です。</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<div class="line-block">
<div class="line">各変数名についての補足</div>
<div class="line">vvv: 255バイト以内の半角英数字とアンダースコア（ _ ）</div>
<div class="line">xxx: 251バイト以内の半角英数字とアンダースコア（ _ ）</div>
<div class="line">メンバー変数は、下記の7文字を除くascii文字(0x20～0x7e)が使用出来ます。</div>
<div class="line">&quot; . [ ] ' \ :</div>
<div class="line">尚、コーテーションで囲ないと変数名の先頭に使用出来ない文字がいくつかあります。</div>
<div class="line">詳細は、Ansible公式ドキュメントのYaml syntaxを参照してください。</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<div class="line-block">
<div class="line"><strong>Ansible-Legacy・Ansible-LegacyRoleでのテンプレート埋込変数の使用例</strong></div>
</div>
<div class="line-block">
<div class="line"><span class="menuselection">Ansible共通 ▶ テンプレート管理</span> で登録したテンプレート素材をPlaybookに記述する場合、テンプレート埋込変数名を記述します。</div>
</div>
<div class="line-block">
<div class="line">※ファイル名にスペースなどが含まれている場合、適切にクォーテーションで囲まないと、作業実行時にエラーになる場合があります。</div>
</div>
<div class="line-block">
<div class="line">e.g.) <span class="menuselection">Ansible共通 ▶ テンプレート管理</span> で登録したhostsファイルをテンプレート埋込変数を使用して作業対象サーバの/etc/配下に設置する場合</div>
</div>
<ol class="arabic">
<li><div class="line-block">
<div class="line"><span class="menuselection">Ansible共通 ▶ テンプレート管理</span> からhostsファイルを登録します。</div>
</div>
<table class="docutils align-left" id="id72">
<caption><span class="caption-number">表 1.135 </span><span class="caption-text">テンプレート管理の登録内容</span><a class="headerlink" href="#id72" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 42.9%" />
<col style="width: 57.1%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>テンプレート埋込変数名</p></th>
<th class="head"><p>テンプレート素材</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>TPF_hosts</p></td>
<td><p>hosts</p></td>
</tr>
</tbody>
</table>
</li>
<li><div class="line-block">
<div class="line">下記のようにPlaybookを記述します。</div>
<div class="line">※destはファイル名も記述してください。ファイル名の指定がない場合、登録したテンプレート素材のファイル名の前にITAの管理番号が付与された名前のファイル名で処理されます。</div>
<div class="line">　たとえば、dest=/etc/ とした場合、ファイル名は/etc/36桁の文字列_hostsとなります。</div>
</div>
<div class="line-block">
<div class="line"><strong>Playbookの記述</strong></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">template</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">src=&#39;{{ TPF_hosts }}&#39; dest=/etc/hosts</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<div class="line-block">
<div class="line"><strong>Ansible-Pioneerでのテンプレート埋込変数の使用例</strong></div>
</div>
<div class="line-block">
<div class="line"><span class="menuselection">Ansible共通 ▶ テンプレート管理</span> で登録したテンプレート素材を対話ファイルに記述する場合、テンプレート埋込変数名を記述します。</div>
</div>
<div class="line-block">
<div class="line">※ファイル名にスペースなどが含まれている場合、適切にクォーテーションで囲まないと、作業実行時にエラーになる場合があります。</div>
</div>
<div class="line-block">
<div class="line">e.g.) <span class="menuselection">Ansible共通 ▶ テンプレート管理</span> で登録したhostsファイルをテンプレート埋込変数を使用して作業対象サーバの/etc/配下に設置する場合</div>
</div>
<ol class="arabic">
<li><div class="line-block">
<div class="line"><span class="menuselection">Ansible共通 ▶ テンプレート管理</span> からhostsファイルを登録します。</div>
</div>
<table class="docutils align-left" id="id73">
<caption><span class="caption-number">表 1.136 </span><span class="caption-text">テンプレート管理の登録内容</span><a class="headerlink" href="#id73" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 42.9%" />
<col style="width: 57.1%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>テンプレート埋込変数名</p></th>
<th class="head"><p>テンプレート素材</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>TPF_hosts</p></td>
<td><p>hosts</p></td>
</tr>
</tbody>
</table>
</li>
<li><div class="line-block">
<div class="line">下記のように対話ファイルを記述します。</div>
<div class="line">※転送先はファイル名も記述してください。ファイル名の指定がない場合、登録したテンプレート素材のファイル名の前にITAの管理番号が付与された名前のファイル名で処理されます。</div>
<div class="line">　たとえば、/etc/. とした場合、ファイル名は/etc/36桁の文字列_hostsとなります。</div>
</div>
<div class="line-block">
<div class="line"><strong>対話ファイルの記述</strong></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">conf</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># ファイルのサイズでタイマ値調整</span>
<span class="w">  </span><span class="nt">timeout</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">60</span>
<span class="nt">exec_list</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># 対象機器へのログインパスワード認証</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">expect</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;password:&#39;</span>
<span class="w">    </span><span class="nt">exec</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">__loginpassword__</span><span class="nv"> </span><span class="s">}}&#39;</span>
<span class="w">  </span><span class="c1"># 作業対象側よりscpコマンドでAAC側に配置されているファイルを作業対象にファイル転送</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">expect</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">__loginuser__</span><span class="nv"> </span><span class="s">}}@{{</span><span class="nv"> </span><span class="s">__dnshostname__</span><span class="nv"> </span><span class="s">}}&#39;</span>
<span class="w">    </span><span class="nt">exec</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;scp</span><span class="nv"> </span><span class="s">-o</span><span class="nv"> </span><span class="s">StrictHostKeyChecking=no</span><span class="nv"> </span><span class="s">-o</span><span class="nv"> </span><span class="s">UserKnownHostsFile=/dev/null</span><span class="nv"> </span><span class="s">{{</span><span class="nv"> </span><span class="s">VAR_scp_user</span><span class="nv"> </span><span class="s">}}@{{</span><span class="nv"> </span><span class="s">VAR_aac_host</span><span class="nv"> </span><span class="s">}}:{{</span><span class="nv"> </span><span class="s">TPF_hosts</span><span class="nv"> </span><span class="s">}}</span><span class="nv"> </span><span class="s">/etc/hosts&#39;</span>
<span class="w">  </span><span class="c1"># scpコマンドのパスワードログイン認証(AAC側)</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">expect</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;password:&#39;</span>
<span class="w">    </span><span class="nt">exec</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">VAR_scp_user_password</span><span class="nv"> </span><span class="s">}}&#39;</span>
<span class="w">  </span><span class="c1"># 対話ファイル終了</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">expect</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">__loginuser__</span><span class="nv"> </span><span class="s">}}@{{</span><span class="nv"> </span><span class="s">__dnshostname__</span><span class="nv"> </span><span class="s">}}&#39;</span>
<span class="w">    </span><span class="nt">exec</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">exit</span>
</pre></div>
</div>
<table class="docutils align-left" id="id74">
<caption><span class="caption-number">表 1.137 </span><span class="caption-text">変数の具体値</span><a class="headerlink" href="#id74" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 42.9%" />
<col style="width: 57.1%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>変数</p></th>
<th class="head"><p>具体値</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>VAR_scp_user</p></td>
<td><p>awx</p></td>
</tr>
<tr class="row-odd"><td><p>VAR_scp_user_password</p></td>
<td><p>awxユーザパスワード</p></td>
</tr>
<tr class="row-even"><td><p>VAR_aac_host</p></td>
<td><p>Ansible Automation Controller</p></td>
</tr>
</tbody>
</table>
</li>
</ol>
</div>
</section>
<section id="ansible-execution-environment-definition-template-list">
<span id="id28"></span><h3><span class="section-number">1.5.7. </span>実行環境定義テンプレート管理<a class="headerlink" href="#ansible-execution-environment-definition-template-list" title="Link to this heading">¶</a></h3>
<ol class="arabic">
<li><div class="line-block">
<div class="line">Ansible Execution Agent内にansible-builderで実行環境（コンテナ）をbuildする際の実行環境定義ファイル(execution-environment.yml)のテンプレートファイルのメンテナンス(閲覧/登録/更新/廃止)を行います。</div>
<div class="line">テンプレートファイルについての詳細は、「 <a class="reference internal" href="#ansible-common-environment-definition-make"><span class="std std-ref">Ansible共通 ▶ 実行環境定義テンプレート管理 に登録するテンプレートファイルと パラメータシート「実行環境パラメータ定義」 の使用方法</span></a> 」を参照してください。</div>
<div class="line">尚、ITAをインストールすると、pythonモジュールやansible galaxyコレクションが追加できるテンプレートファイルが登録されます。</div>
</div>
<figure class="align-default" id="id75">
<a class="reference internal image-reference" href="../../_images/execution_environment_definition_template_list.png"><img alt="サブメニュー画面（実行環境定義テンプレート管理）" src="../../_images/execution_environment_definition_template_list.png" style="width: 800px;" />
</a>
<figcaption>
<p><span class="caption-number">図 1.102 </span><span class="caption-text">サブメニュー画面（実行環境定義テンプレート管理管理）</span><a class="headerlink" href="#id75" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</li>
<li><div class="line-block">
<div class="line"><span class="guilabel">登録</span> ボタンより、実行環境定義テンプレート管理の登録を行います。</div>
</div>
<figure class="align-default" id="id76">
<a class="reference internal image-reference" href="../../_images/execution_environment_definition_template_list.gif"><img alt="登録画面（実行環境定義テンプレート管理管理）" src="../../_images/execution_environment_definition_template_list.gif" style="width: 800px;" />
</a>
<figcaption>
<p><span class="caption-number">図 1.103 </span><span class="caption-text">登録画面（実行環境定義テンプレート管理管理）</span><a class="headerlink" href="#id76" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</li>
<li><div class="line-block">
<div class="line">登録画面の項目一覧は以下のとおりです。</div>
</div>
<table class="docutils align-left" id="id77">
<caption><span class="caption-number">表 1.138 </span><span class="caption-text">登録画面項目一覧（実行環境定義テンプレート管理）</span><a class="headerlink" href="#id77" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 15.4%" />
<col style="width: 61.5%" />
<col style="width: 7.7%" />
<col style="width: 7.7%" />
<col style="width: 7.7%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>項目</p></th>
<th class="head"><p>説明</p></th>
<th class="head"><p>入力必須</p></th>
<th class="head"><p>入力方法</p></th>
<th class="head"><p>制約事項</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>項番</p></td>
<td><div class="line-block">
<div class="line">登録時に自動採番した36桁の文字列が表示されます。</div>
</div>
</td>
<td><p>ー</p></td>
<td><p>自動入力</p></td>
<td><p>ー</p></td>
</tr>
<tr class="row-odd"><td><p>テンプレート名</p></td>
<td><div class="line-block">
<div class="line">テンプレート名を入力します。</div>
</div>
</td>
<td><p>○</p></td>
<td><p>手動入力</p></td>
<td><p>最大長255バイト</p></td>
</tr>
<tr class="row-even"><td><p>テンプレートファイル</p></td>
<td><div class="line-block">
<div class="line">ansible-builderで実行環境（コンテナ）をbuildする際に使用する実行環境定義ファイル(execution-environment.yml)のテンプレートファイルを入力します。</div>
</div>
</td>
<td><p>○</p></td>
<td><p>ファイル登録</p></td>
<td><div class="line-block">
<div class="line">Jinja2 template形式</div>
<div class="line">最大サイズ100Mバイト</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>備考</p></td>
<td><p>自由記述欄です。</p></td>
<td><p>ー</p></td>
<td><p>手動入力</p></td>
<td><p>最大長4000バイト</p></td>
</tr>
</tbody>
</table>
</li>
</ol>
</section>
<section id="ansible-execution-environment-list">
<span id="id29"></span><h3><span class="section-number">1.5.8. </span>実行環境管理<a class="headerlink" href="#ansible-execution-environment-list" title="Link to this heading">¶</a></h3>
<ol class="arabic">
<li><div class="line-block">
<div class="line"><span class="menuselection">Ansible共通 ▶ 実行環境定義テンプレート管理</span> より登録した実行環境定義ファイル(execution-environment.yml)のテンプレートファイルと <span class="menuselection">パラメータシート「実行環境定義テンプレート管理」</span> の紐付管理(閲覧/登録/更新/廃止)を行います。</div>
<div class="line"><span class="menuselection">パラメータシート「実行環境定義テンプレート管理」</span> については「 <a class="reference internal" href="#ansible-common-environment-definition-make"><span class="std std-ref">Ansible共通 ▶ 実行環境定義テンプレート管理 に登録するテンプレートファイルと パラメータシート「実行環境パラメータ定義」 の使用方法</span></a> 」を参照してください。</div>
<div class="line">尚、ITAをインストールすると、実行環境定義テンプレートファイルに埋め込むパラメータが登録された <span class="menuselection">パラメータシート「実行環境パラメータ定義」</span> が登録され、
<span class="menuselection">パラメータシート「実行環境パラメータ定義」</span> と <span class="menuselection">Ansible共通 ▶ 実行環境定義テンプレート管理</span> の紐付が登録されます。</div>
</div>
<figure class="align-default" id="id78">
<a class="reference internal image-reference" href="../../_images/execution_environment_list.png"><img alt="サブメニュー画面（実行環境管理）" src="../../_images/execution_environment_list.png" style="width: 800px;" />
</a>
<figcaption>
<p><span class="caption-number">図 1.104 </span><span class="caption-text">サブメニュー画面（実行環境管理）</span><a class="headerlink" href="#id78" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</li>
<li><div class="line-block">
<div class="line"><span class="guilabel">登録</span> ボタンより、実行環境定義テンプレート管理の登録を行います。</div>
</div>
<figure class="align-default" id="id79">
<a class="reference internal image-reference" href="../../_images/execution_environment_list.gif"><img alt="登録画面（実行環境管理）" src="../../_images/execution_environment_list.gif" style="width: 800px;" />
</a>
<figcaption>
<p><span class="caption-number">図 1.105 </span><span class="caption-text">登録画面（実行環境管理）</span><a class="headerlink" href="#id79" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</li>
<li><div class="line-block">
<div class="line">登録画面の項目一覧は以下のとおりです。</div>
</div>
<table class="docutils align-left" id="id80">
<caption><span class="caption-number">表 1.139 </span><span class="caption-text">登録画面項目一覧（実行環境管理）</span><a class="headerlink" href="#id80" title="Link to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>項目</p></th>
<th class="head"><p>説明</p></th>
<th class="head"><p>入力必須</p></th>
<th class="head"><p>入力方法</p></th>
<th class="head"><p>制約事項</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>項番</p></td>
<td><p>登録時に自動採番した36桁の文字列が表示されます。</p></td>
<td><p>ー</p></td>
<td><p>自動入力</p></td>
<td><p>ー</p></td>
</tr>
<tr class="row-odd"><td><p>実行環境名</p></td>
<td><p>実行環境名を入力します。</p></td>
<td><p>○</p></td>
<td><p>手動入力</p></td>
<td><p>最大長255バイト</p></td>
</tr>
<tr class="row-even"><td><p>実行環境構築方法</p></td>
<td><p>作業実行時にAnsible Execution Agent内でansible-builderで実行環境（コンテナ）をbuildするかどうかを選択します。</p>
<ul>
<li><div class="line-block">
<div class="line">ITA</div>
<div class="line">「ITA」を選択した場合には、ansible-builderで実行環境（コンテナ）をbuildします。</div>
<div class="line"><span class="menuselection">実行環境定義名</span> と <span class="menuselection">テンプレート名</span> は必須入力です。</div>
</div>
</li>
<li><div class="line-block">
<div class="line">Manual</div>
<div class="line">「Manual」を選択した場合には、ansible-builderで実行環境（コンテナ）をbuildしません。</div>
<div class="line">ITA外でbulidした実行環境（コンテナイメージ）を作業実行前にAnsible Execution Agent内にロードしておく必要があれます。</div>
</div>
</li>
</ul>
</td>
<td><p>○</p></td>
<td><p>リスト選択</p></td>
<td><p>説明欄記載のとおり。</p></td>
</tr>
<tr class="row-odd"><td><p>タグ名</p></td>
<td><p>ansible-builderで実行環境（コンテナ）をbuildされるイメージ名を入力します。</p>
<ul>
<li><div class="line-block">
<div class="line"><span class="menuselection">実行環境構築方法</span> で「ITA」を選択している場合</div>
<div class="line">イメージ名は以下の命名規則となります。</div>
<div class="line-block">
<div class="line">イメージ名の命名規則</div>
<div class="line">{{organization_id}}_{{workspace_id}}_&quot;入力したタグ名&quot;</div>
</div>
</div>
</li>
<li><div class="line-block">
<div class="line"><span class="menuselection">実行環境構築方法</span> で「Manual」を選択している場合</div>
<div class="line">イメージ名は入力したタグ名がイメージ名となります。</div>
</div>
</li>
</ul>
</td>
<td><p>○</p></td>
<td><p>手動入力</p></td>
<td><p>最大長255バイト</p></td>
</tr>
<tr class="row-even"><td><p>実行環境定義名</p></td>
<td><p><span class="menuselection">実行環境定義テンプレート管理</span> 用に作成されたパラメータシートに登録されている<span class="menuselection">パラメータシート「実行環境パラメータ定義」</span> のメニュー名とレコード名が表示されます。一覧より選択します。</p></td>
<td><p>○</p></td>
<td><p>リスト選択</p></td>
<td><p>説明欄記載のとおり。</p></td>
</tr>
<tr class="row-odd"><td><p>テンプレート名</p></td>
<td><p><span class="menuselection">実行環境定義テンプレート管理</span> に登録されている <span class="menuselection">テンプレート名</span> が表示されます。
テンプレート名を選択します。</p></td>
<td><p>○</p></td>
<td><p>リスト選択</p></td>
<td><p>説明欄記載のとおり。</p></td>
</tr>
<tr class="row-even"><td><p>備考</p></td>
<td><p>自由記述欄です。</p></td>
<td><p>○</p></td>
<td><p>手動入力</p></td>
<td><p>最大長255バイト</p></td>
</tr>
</tbody>
</table>
</li>
</ol>
</section>
<section id="ansible-agent-list">
<span id="id30"></span><h3><span class="section-number">1.5.9. </span>エージェント管理<a class="headerlink" href="#ansible-agent-list" title="Link to this heading">¶</a></h3>
<ol class="arabic">
<li><div class="line-block">
<div class="line">ITAと接続したAnsible Execution Agentのエージェント名とバージョン情報を閲覧できます。</div>
</div>
<figure class="align-default" id="id81">
<a class="reference internal image-reference" href="../../_images/ansible_agent_list.png"><img alt="サブメニュー画面（エージェント管理）" src="../../_images/ansible_agent_list.png" style="width: 800px;" />
</a>
<figcaption>
<p><span class="caption-number">図 1.106 </span><span class="caption-text">サブメニュー画面（エージェント管理）</span><a class="headerlink" href="#id81" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</li>
<li><div class="line-block">
<div class="line">閲覧画面の項目一覧は以下のとおりです。</div>
</div>
<table class="docutils align-left" id="id82">
<caption><span class="caption-number">表 1.140 </span><span class="caption-text">登録画面項目一覧（エージェント管理）</span><a class="headerlink" href="#id82" title="Link to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>項目</p></th>
<th class="head"><p>説明</p></th>
<th class="head"><p>制約事項</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>項番</p></td>
<td><p>登録時に自動採番した36桁の文字列が表示されます。</p></td>
<td><p>ー</p></td>
</tr>
<tr class="row-odd"><td><p>エージェント名</p></td>
<td><p>Ansible Execution Agentのエージェント名が表示されます。</p></td>
<td><p>ー</p></td>
</tr>
<tr class="row-even"><td><p>バージョン</p></td>
<td><p>Ansible Execution Agentのバージョンが表示されます。</p></td>
<td><p>ー</p></td>
</tr>
<tr class="row-odd"><td><p>ステータス</p></td>
<td><p>ステータスには以下の状態が表示されます。</p>
<ul>
<li><div class="line-block">
<div class="line">正常（最新）</div>
<div class="line">Ansible Execution AgentのパーションとITAのバージョンが一致、Ansible Execution Agentと正常に連携が出来ている状態です。</div>
</div>
</li>
<li><div class="line-block">
<div class="line">正常（更新可能）</div>
<div class="line">Ansible Execution AgentのパーションとITAのバージョンが一致しないが互換性があるので、Ansible Execution Agentと正常に連携が出来ている状態ですが、Ansible Execution Agentのバージョンアップを推奨します。</div>
</div>
</li>
<li><div class="line-block">
<div class="line">連携不可（要更新）</div>
<div class="line">Ansible Execution AgentのパーションとITAのバージョンが一致しなく互換性がない為、Ansible Execution Agentと連携が出来ない状態です。Ansible Execution Agentのバージョンアップを行って下さい。</div>
</div>
</li>
</ul>
</td>
<td><p>ー</p></td>
</tr>
<tr class="row-even"><td><p>備考</p></td>
<td><p>自由記述欄です。</p></td>
<td><p>自由記述欄です。</p></td>
</tr>
</tbody>
</table>
</li>
</ol>
</section>
<section id="ansible-common-unmanaged-var-list">
<span id="id31"></span><h3><span class="section-number">1.5.10. </span>管理対象外変数リスト<a class="headerlink" href="#ansible-common-unmanaged-var-list" title="Link to this heading">¶</a></h3>
<ol class="arabic">
<li><div class="line-block">
<div class="line">「 <a class="reference internal" href="#ansible-common-var-listup"><span class="std std-ref">変数抜出対象資材</span></a> 」で抜出した変数で、 <span class="menuselection">各モード ▶ 代入値自動登録設定</span> の <span class="menuselection">Movement名:変数名</span> に表示したくない変数のメンテナンス（参照/更新/廃止/復活）を行います。</div>
<div class="line">ITAインストール時にansibleマジック変数が登録されます。</div>
</div>
<figure class="align-default" id="id83">
<a class="reference internal image-reference" href="../../_images/unmanaged_var_list.png"><img alt="サブメニュー画面（管理対象外変数リスト）" src="../../_images/unmanaged_var_list.png" style="width: 800px;" />
</a>
<figcaption>
<p><span class="caption-number">図 1.107 </span><span class="caption-text">サブメニュー画面（管理対象外変数リスト）</span><a class="headerlink" href="#id83" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</li>
<li><div class="line-block">
<div class="line"><span class="guilabel">登録</span> ボタンより、管理対象外変数の登録を行います。</div>
</div>
<figure class="align-default" id="id84">
<a class="reference internal image-reference" href="../../_images/unmanaged_var_list.gif"><img alt="登録画面（管理対象外変数リスト）" src="../../_images/unmanaged_var_list.gif" style="width: 800px;" />
</a>
<figcaption>
<p><span class="caption-number">図 1.108 </span><span class="caption-text">登録画面（管理対象外変数リスト）</span><a class="headerlink" href="#id84" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</li>
<li><div class="line-block">
<div class="line">登録画面の項目一覧は以下のとおりです。</div>
</div>
<table class="docutils align-left" id="id85">
<caption><span class="caption-number">表 1.141 </span><span class="caption-text">登録画面項目一覧（管理対象外変数リスト）</span><a class="headerlink" href="#id85" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 50.0%" />
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 12.5%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>項目</p></th>
<th class="head"><p>注意事項</p></th>
<th class="head"><p>入力必須</p></th>
<th class="head"><p>入力方法</p></th>
<th class="head"><p>制約事項</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>項番</p></td>
<td><div class="line-block">
<div class="line">登録時に自動採番した36桁の文字列が表示されます。</div>
</div>
</td>
<td><p>ー</p></td>
<td><p>自動入力</p></td>
<td><p>ー</p></td>
</tr>
<tr class="row-odd"><td><p>変数名</p></td>
<td><div class="line-block">
<div class="line-block">
<div class="line"><span class="menuselection">各モード ▶ 代入値自動登録設定</span> の <span class="menuselection">Movement名:変数名</span> に表示したくない変数名を入力します。</div>
</div>
<div class="line">変数名は正規表現で記載できます。</div>
<div class="line">e.g.) ansible_*  *:ワイルドカード</div>
<div class="line-block">
<div class="line">ansible_[0-9a-zA-Z]*</div>
</div>
</div>
</td>
<td><p>〇</p></td>
<td><p>手動入力</p></td>
<td><p>最大長255バイト</p></td>
</tr>
<tr class="row-even"><td><p>備考</p></td>
<td><p>自由記述欄です。</p></td>
<td><p>ー</p></td>
<td><p>手動入力</p></td>
<td><p>最大長4000バイト</p></td>
</tr>
</tbody>
</table>
</li>
</ol>
</section>
</section>
<section id="id32">
<h2><span class="section-number">1.6. </span>付録<a class="headerlink" href="#id32" title="Link to this heading">¶</a></h2>
<section id="ansible-common-environment-definition-make">
<span id="id33"></span><h3><span class="section-number">1.6.1. </span><span class="menuselection">Ansible共通 ▶ 実行環境定義テンプレート管理</span> に登録するテンプレートファイルと <span class="menuselection">パラメータシート「実行環境パラメータ定義」</span> の使用方法<a class="headerlink" href="#ansible-common-environment-definition-make" title="Link to this heading">¶</a></h3>
<div class="line-block">
<div class="line">ITAをインストールすると、<span class="menuselection">実行環境定義テンプレート管理</span> と <span class="menuselection">パラメータシート「実行環境パラメータ定義」</span> にpythonモジュールやansible galaxyコレクションが追加できるテンプレートファイルとパラメータ値が登録されます。</div>
</div>
<ol class="arabic">
<li><div class="line-block">
<div class="line"><span class="menuselection">Ansible共通 ▶ 実行環境定義テンプレート管理</span> に登録するテンプレートファイルの仕様</div>
<div class="line">ファイルの形式は「Jinjer2型式」です。</div>
<div class="line">ファイルの書式は、ansible-biulderで使用する定義ファイル「execution-environment.yml」に準じます。詳細は、ansible-biulderのマニュアルを参照して下さい。</div>
</div>
</li>
<li><div class="line-block">
<div class="line">ITAインストール時に登録される <span class="menuselection">パラメータシート「実行環境パラメータ定義」</span> の項目一覧は以下のとおりです。</div>
</div>
<figure class="align-default">
<a class="reference internal image-reference" href="../../_images/ansible_common_environment_definition_parameter_sheet.png"><img alt="パラメータシート「実行環境パラメータ定義」" src="../../_images/ansible_common_environment_definition_parameter_sheet.png" style="width: 800px;" />
</a>
</figure>
<table class="docutils align-left" id="id86">
<caption><span class="caption-number">表 1.142 </span><span class="caption-text">パラメータシート「実行環境パラメータ定義」</span><a class="headerlink" href="#id86" title="Link to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>項目</p></th>
<th class="head"><p>説明</p></th>
<th class="head"><p>入力必須</p></th>
<th class="head"><p>入力方法</p></th>
<th class="head"><p>制約事項</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>execution_environment_name</p></td>
<td><p>レコードの名称を入力します。</p></td>
<td><p>〇</p></td>
<td><p>手動入力</p></td>
<td><p>最大長255バイト</p></td>
</tr>
<tr class="row-odd"><td><p>python_requirements_file</p></td>
<td><p>実行環境（コンテナ）にpipコマンドで追加インストールをしたいPythonパッケージを列挙したファイルを入力します。</p></td>
<td><p>〇</p></td>
<td><p>ファイル選択</p></td>
<td><p>最大サイズ 100Mバイト
尚、空ファイルを入力しないで下さい。ansible-builder実行時にエラーになります。</p></td>
</tr>
<tr class="row-even"><td><p>galaxy_requirements_file</p></td>
<td><p>実行環境（コンテナ）にansible-galaxyで追加インストールをしたいコレクションを列挙したファイルを入力します。</p></td>
<td><p>－</p></td>
<td><p>ファイル選択</p></td>
<td><p>最大サイズ 100Mバイト
尚、空ファイルを入力しないで下さい。ansible-builder実行時にエラーになります。</p></td>
</tr>
<tr class="row-odd"><td><p>bindep_file</p></td>
<td><p>実行環境（コンテナ）にdnfコマンドで追加インストールをしたいLinuxモジュールを列挙したファイルを入力します。</p></td>
<td><p>〇</p></td>
<td><p>ファイル選択</p></td>
<td><p>最大サイズ 100Mバイト
尚、空ファイルを入力しないで下さい。ansible-builder実行時にエラーになります。</p></td>
</tr>
<tr class="row-even"><td><p>ansible_runner</p></td>
<td><p>「ansible_runner」を入力します。</p></td>
<td><p>〇</p></td>
<td><p>手動入力</p></td>
<td><p>最大長255バイト</p></td>
</tr>
<tr class="row-odd"><td><p>image</p></td>
<td><p>実行環境（コンテナ）のベースイメージを入力します。
ITA Ver2.5.1では、以下の2個のベースイメージについて動作確認がとれています。</p>
<ul>
<li><div class="line-block">
<div class="line">Redhat有償版のベースイメージの場合</div>
<div class="line">registry.redhat.io/ansible-automation-platform-24/ee-supported-rhel9:latest</div>
</div>
</li>
<li><div class="line-block">
<div class="line">Redhat無償版のベースイメージの場合</div>
<div class="line">registry.access.redhat.com/ubi9/ubi-init:latest</div>
</div>
</li>
</ul>
</td>
<td><p>〇</p></td>
<td><p>手動入力</p></td>
<td><p>最大長255バイト</p></td>
</tr>
<tr class="row-even"><td><p>package_manager_path</p></td>
<td><p>パッケージ管理コマンドのパスを入力します。</p>
<ul>
<li><div class="line-block">
<div class="line">Redhat有償版のベースイメージの場合</div>
<div class="line">/usr/bin/microdnf</div>
</div>
</li>
<li><div class="line-block">
<div class="line">Redhat無償版のベースイメージの場合</div>
<div class="line">/usr/bin/dnf</div>
</div>
</li>
</ul>
</td>
<td><p>〇</p></td>
<td><p>手動入力</p></td>
<td><p>最大長255バイト</p></td>
</tr>
</tbody>
</table>
</li>
<li><div class="line-block">
<div class="line"><span class="menuselection">パラメータシート 「実行環境パラメータ定義」</span> を新規作成したり更新する場合の注意事項</div>
<div class="line"><span class="menuselection">パラメータシート 「実行環境パラメータ定義」</span> を新規作成したり更新する場合の注意事項について以下に列挙します。</div>
</div>
<ol class="arabic">
<li><div class="line-block">
<div class="line">パラメータシート名（rest）は、先頭が「execution_environment_parameter_definition_sheet」で始まる名称にして下さい。</div>
</div>
</li>
<li><div class="line-block">
<div class="line">作成対象は、データシートを選択して下さい。</div>
</div>
</li>
<li><div class="line-block">
<div class="line">パラメータシートの項目に以下の項目を含んで下さい。</div>
</div>
<table class="docutils align-left">
<thead>
<tr class="row-odd"><th class="head"><p>項目</p></th>
<th class="head"><p>説明</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Rest API用項目名</p></td>
<td><p>execution_environment_name</p></td>
</tr>
<tr class="row-odd"><td><p>入力値</p></td>
<td><p>レコード名</p></td>
</tr>
<tr class="row-even"><td><p>項目タイプ</p></td>
<td><p>文字列(単一行)</p></td>
</tr>
<tr class="row-odd"><td><p>最大バイト数</p></td>
<td><p>255</p></td>
</tr>
</tbody>
</table>
</li>
<li><div class="line-block">
<div class="line">パラメータシート名を入力します。</div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<div class="line-block">
<div class="line"><span class="menuselection">Ansible共通 ▶ 実行環境管理</span> の <span class="menuselection">実行環境定義名</span> に表示される情報について補足</div>
<div class="line"><span class="menuselection">実行環境定義名</span> には下記情報が表示されます。</div>
<div class="line">　　④パラメータシート名／③レコード名「Rest API用項目名：execution_environment_name」</div>
</div>
</div>
</li>
<li><div class="line-block">
<div class="line"><span class="menuselection">Ansible共通 ▶ 実行環境定義テンプレート管理</span> に登録したテンプレートファイル内の変数と同名の項目を容易して下さい。</div>
<div class="line">パラメータシートの項目名を変数名、設定値を変数値として、テンプレートファイルに埋め込みます。</div>
</div>
<a class="reference internal image-reference" href="../../_images/ansible_common_environment_definition_make.png"><img alt="実行環境定義テンプレート管理で使用するテンプレートファイルと実行環境パラメータ定義で使用するパラメータシートの関連図" class="align-center" src="../../_images/ansible_common_environment_definition_make.png" style="width: 800px;" />
</a>
<div class="line-block">
<div class="line">実行環境定義テンプレート管理で使用するテンプレートファイルと実行環境パラメータ定義で使用するパラメータシートの関連図</div>
</div>
</li>
</ol>
</li>
</ol>
</section>
<section id="backyard">
<span id="ansible-common-backyard-content"></span><h3><span class="section-number">1.6.2. </span>BackYardコンテンツ<a class="headerlink" href="#backyard" title="Link to this heading">¶</a></h3>
<section id="ansible-common-aac-sync">
<span id="id34"></span><h4>Ansible Automation Controllerデータ同期<a class="headerlink" href="#ansible-common-aac-sync" title="Link to this heading">¶</a></h4>
<div class="line-block">
<div class="line"><span class="menuselection">Ansible共通 ▶ インターフェース情報</span> の <span class="menuselection">実行エンジン</span> で「Ansible Automation Controller」を選択している場合、Ansible Automation Controllerに登録されているリソースを取得します。</div>
</div>
<table class="docutils align-left" id="id87">
<caption><span class="caption-number">表 1.143 </span><span class="caption-text">Ansible Automation Controllerから取得するリソースと使用用途</span><a class="headerlink" href="#id87" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 16.7%" />
<col style="width: 83.3%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>リソース</p></th>
<th class="head"><p>用途</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>組織名</p></td>
<td><div class="line-block">
<div class="line"><span class="menuselection">Ansible共通 ▶ インターフェース情報</span> の <span class="menuselection">組織名</span> のリスト選択で使用されます。</div>
<div class="line"><span class="menuselection">Ansible共通 ▶ インターフェース情報</span> の <span class="menuselection">認証トークン</span> で入力しているユーザが利用可能な組織名がリストに表示されます。</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>インスタンスグループ</p></td>
<td><div class="line-block">
<div class="line"><span class="menuselection">Ansible共通 ▶ 機器一覧</span> の <span class="menuselection">インスタンスグループ</span> のリスト選択で使用されます。</div>
<div class="line-block">
<div class="line"><span class="menuselection">Ansible共通 ▶ インターフェース情報</span> の <span class="menuselection">組織名</span> で選択している組織が利用可能なインスタンスグループがリストに表示されます。</div>
</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p>実行環境</p></td>
<td><div class="line-block">
<div class="line"><span class="menuselection">各モード ▶ Movement一覧</span> の <span class="menuselection">実行環境</span> のリスト選択で使用されます。</div>
<div class="line"><span class="menuselection">Ansible共通 ▶ インターフェース情報</span> の <span class="menuselection">組織名</span> で選択している組織が利用可能な実行環境がリストに表示されます。</div>
</div>
</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="ansible-common-inventory-file">
<span id="id35"></span><h3><span class="section-number">1.6.3. </span>ITAが作成するインベントリファイル<a class="headerlink" href="#ansible-common-inventory-file" title="Link to this heading">¶</a></h3>
<div class="line-block">
<div class="line">ITAが作成するインベントリファイルについて説明します。</div>
<div class="line">ITAが作成するインベントリファイルを以下に示します。</div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">all</span><span class="p">:</span>
<span class="w">  </span><span class="nt">children</span><span class="p">:</span>
<span class="w">    </span><span class="nt">hostgroups</span><span class="p">:</span>
<span class="w">      </span><span class="nt">hosts</span><span class="p">:</span>
<span class="w">        </span><span class="nt">Inventory_host</span><span class="p">:</span>
<span class="w">          </span><span class="nt">Inventory_host_parameters</span><span class="p">:</span>
<span class="w">          </span><span class="nt">Inventory_host_option_parameters</span><span class="p">:</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">Inventory_hostには <span class="menuselection">Ansible共通 ▶ 機器一覧</span> の <span class="menuselection">ホスト名</span> を設定します。</div>
<div class="line">Inventory_host_option_parametersには <span class="menuselection">Ansible共通 ▶ 機器一覧</span> の <span class="menuselection">インベントリファイル追加オプション</span> を設定します。</div>
<div class="line">Inventory_host_parametersに設定するパラメータを以下に示します。</div>
<div class="line">各設定値に対応する項目が未入力のパラメータは、Inventory_host_parametersに設定しません。</div>
</div>
<table class="docutils align-left" id="id88">
<caption><span class="caption-number">表 1.144 </span><span class="caption-text">Inventory_host_parametersに設定するパラメータ一覧</span><a class="headerlink" href="#id88" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 15.0%" />
<col style="width: 10.0%" />
<col style="width: 10.0%" />
<col style="width: 10.0%" />
<col style="width: 10.0%" />
<col style="width: 10.0%" />
<col style="width: 10.0%" />
<col style="width: 25.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>パラメータ名</p></th>
<th class="head" colspan="6"><p><span class="menuselection">Ansible共通 ▶ 機器一覧</span> の <span class="menuselection">認証方式</span></p></th>
<th class="head" rowspan="2"><p>設定値</p></th>
</tr>
<tr class="row-even"><th class="head"><p>パスワード認証</p></th>
<th class="head"><p>鍵認証</p>
<p>（パスフレーズなし）</p>
</th>
<th class="head"><p>鍵認証</p>
<p>（パスフレーズあり）</p>
</th>
<th class="head"><p>鍵認証</p>
<p>（鍵交換済み）</p>
</th>
<th class="head"><p>パスワード認証</p>
<p>認証（winrm）</p>
</th>
<th class="head"><p>証明書認証</p>
<p>（winrm）</p>
</th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>ansible_host</p></td>
<td><p>〇</p></td>
<td><p>〇</p></td>
<td><p>〇</p></td>
<td><p>〇</p></td>
<td><p>〇</p></td>
<td><p>〇</p></td>
<td><p><span class="menuselection">Ansible共通 ▶ 機器一覧</span> の <span class="menuselection">DNSホスト</span> または <span class="menuselection">DNSホストIPアドレス</span>
<span class="menuselection">各モード ▶ Movement一覧</span> の <span class="menuselection">ホスト指定形式</span> で選択されている内容にで決まります。</p></td>
</tr>
<tr class="row-even"><td><p>ansible_user</p></td>
<td><p>〇</p></td>
<td><p>〇</p></td>
<td><p>〇</p></td>
<td><p>〇</p></td>
<td><p>〇</p></td>
<td></td>
<td><p><span class="menuselection">Ansible共通 ▶ 機器一覧</span> の <span class="menuselection">ログインユーザ</span></p></td>
</tr>
<tr class="row-odd"><td><p>ansible_password</p></td>
<td><p>〇</p></td>
<td></td>
<td></td>
<td></td>
<td><p>〇</p></td>
<td></td>
<td><p><span class="menuselection">Ansible共通 ▶ 機器一覧</span> の <span class="menuselection">ログインパスワード</span></p></td>
</tr>
<tr class="row-even"><td><p>ansible_ssh_private_key_file</p></td>
<td></td>
<td><p>〇</p></td>
<td><p>〇</p></td>
<td></td>
<td></td>
<td></td>
<td><p><span class="menuselection">Ansible共通 ▶ 機器一覧</span> の <span class="menuselection">ssh秘密鍵ファイル</span></p></td>
</tr>
<tr class="row-odd"><td><p>ansible_ssh_extra_args</p></td>
<td><p>〇</p></td>
<td><p>〇</p></td>
<td><p>〇</p></td>
<td><p>〇</p></td>
<td></td>
<td></td>
<td><p><span class="menuselection">Ansible共通 ▶ 機器一覧</span> の <span class="menuselection">接続オプション</span></p></td>
</tr>
<tr class="row-even"><td><p>ansible_connection:</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td><p>〇</p></td>
<td><p>〇</p></td>
<td><p>winrm</p></td>
</tr>
<tr class="row-odd"><td><p>ansible_port</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td><p>〇</p></td>
<td><p>〇</p></td>
<td><p><span class="menuselection">Ansible共通 ▶ 機器一覧</span> の <span class="menuselection">WinRM接続情報 ▶ ポート番号</span></p></td>
</tr>
<tr class="row-even"><td><p>ansible_winrm_cert_pem</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td><p>〇</p></td>
<td><p>〇</p></td>
<td><p><span class="menuselection">Ansible共通 ▶ 機器一覧</span> の <span class="menuselection">WinRM接続情報 ▶ winrm公開鍵ファイル</span></p></td>
</tr>
<tr class="row-odd"><td><p>ansible_winrm_cert_key_pem</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td><p>〇</p></td>
<td><p>〇</p></td>
<td><p><span class="menuselection">Ansible共通 ▶ 機器一覧</span> の <span class="menuselection">WinRM接続情報 ▶ winrm秘密鍵ファイル</span></p></td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<div class="line-block">
<div class="line">〇: 設定対象</div>
</div>
</div>
</section>
<section id="ansible-common-option-parameter-list">
<span id="id36"></span><h3><span class="section-number">1.6.4. </span>オプションパラメータ一覧<a class="headerlink" href="#ansible-common-option-parameter-list" title="Link to this heading">¶</a></h3>
<div class="line-block">
<div class="line"><span class="menuselection">Ansible共通 ▶ インターフェース情報</span> と <span class="menuselection">各モード ▶ Movement一覧</span> の <span class="menuselection">オプションパラメータ</span> について説明します。</div>
<div class="line">ITAでは、以下の優先順位でオプションパラメータを設定します。単一の値しか許容していないパラメータを複数定義した場合、 <span class="menuselection">各モード ▶ Movement一覧</span> の <span class="menuselection">オプションパラメータ</span> が有効になります。</div>
</div>
<ol class="arabic">
<li><div class="line-block">
<div class="line"><span class="menuselection">各モード ▶ Movement一覧</span> の <span class="menuselection">オプションパラメータ</span></div>
</div>
</li>
<li><div class="line-block">
<div class="line"><span class="menuselection">Ansible共通 ▶ インターフェース情報</span> の <span class="menuselection">オプションパラメータ</span></div>
</div>
</li>
</ol>
<div class="line-block">
<div class="line">▼ <span class="menuselection">Ansible共通 ▶ インターフェース情報</span> の <span class="menuselection">実行エンジン</span> が「Ansible Core」と「Ansible Execution Agent」の場合</div>
<div class="line">　　ansible-playbookコマンドのオプションパラメータを入力します。</div>
<div class="line">　　ansible-playbookコマンドのオプションパラメータの仕様については、以下のコマンドを実行して表示されたヘルプを参照してください。</div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>ansible-playbook -h
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
<div class="line">▼ <span class="menuselection">Ansible共通 ▶ インターフェース情報</span> の <span class="menuselection">実行エンジン</span> が「Ansible Automation Controller」の場合に</div>
<div class="line">　　入力可能なオプションパラメータは以下のとおりです。</div>
<div class="line"><br /></div>
</div>
<table class="docutils align-left" id="id89">
<caption><span class="caption-number">表 1.145 </span><span class="caption-text">Ansible Automation Controllerの場合に指定可能なオプションパラメータ一覧</span><a class="headerlink" href="#id89" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 14.3%" />
<col style="width: 21.4%" />
<col style="width: 28.6%" />
<col style="width: 35.7%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>オプションパラメータ</p></th>
<th class="head"><p>指定方法</p></th>
<th class="head"><p>Ansible Automation Controllerの設定箇所</p></th>
<th class="head"><p>備考</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><div class="line-block">
<div class="line">-v</div>
<div class="line">--verbose</div>
</div>
</td>
<td><div class="line-block">
<div class="line">-v</div>
<div class="line">-vv</div>
<div class="line">-vvv</div>
<div class="line">-vvvv</div>
<div class="line">-vvvvv</div>
<div class="line">--verbose</div>
</div>
</td>
<td><p><span class="menuselection">テンプレート</span> の <span class="menuselection">詳細</span> に v の数が設定される。</p></td>
<td><div class="line-block">
<div class="line">・vの合計値を適用</div>
<div class="line">・--verboseは、-vと同様</div>
<div class="line">例：--verbose -vvv の場合、-vvvvと同様</div>
<div class="line">・vを6以上指定した場合 、vは5の指定となる</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="line-block">
<div class="line">-f</div>
<div class="line">--forks</div>
</div>
</td>
<td><div class="line-block">
<div class="line">-f FORKS</div>
<div class="line">--forks=FORKS</div>
</div>
</td>
<td><p><span class="menuselection">テンプレート</span> の <span class="menuselection">フォーク</span> にFORKSの値が設定される。</p></td>
<td><div class="line-block">
<div class="line">・FORKSには数値を指定</div>
<div class="line">・複数定義した場合、最後に定義したパラメータが有効</div>
<div class="line">例：-f 1-forks=10の場合、--forks=10が有効となる</div>
<div class="line">・数値以外が指定された場合、エラーとなる</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="line-block">
<div class="line">-l</div>
<div class="line">--limit</div>
</div>
</td>
<td><div class="line-block">
<div class="line">-l SUBSET</div>
<div class="line">--limit=SUBSET</div>
</div>
</td>
<td><p><span class="menuselection">テンプレート</span> の <span class="menuselection">制限</span> にSUBMITの値が設定される。</p></td>
<td><div class="line-block">
<div class="line">・SUBSET:機器一覧にあるホスト名</div>
<div class="line">・複数定義した場合、最後に定義したパラメータが有効</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="line-block">
<div class="line">-e</div>
<div class="line">--extra-vars</div>
</div>
</td>
<td><div class="line-block">
<div class="line">-e EXTRA_VARS</div>
<div class="line">--extra-vars=EXTRA_VARS</div>
</div>
</td>
<td><p><span class="menuselection">テンプレート</span> の <span class="menuselection">追加変数</span> にEXTRA_VARSの値が設定される。</p></td>
<td><div class="line-block">
<div class="line">・EXTRA_VARS:変数名、具体値をjson形式またはyaml形式</div>
<div class="line">e.g.) json形式の場合</div>
<div class="line">　-extra-vars={&quot;VAR_1&quot;:&quot;directory&quot;}</div>
<div class="line">e.g.) yaml形式の場合</div>
<div class="line">　-extra-vars=VAR_1:directory</div>
<div class="line">・複数定義した場合、最後に定義したパラメータが有効</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="line-block">
<div class="line">-t</div>
<div class="line">--tags</div>
</div>
</td>
<td><div class="line-block">
<div class="line">-t TAGS</div>
<div class="line">--tags=TAGS</div>
</div>
</td>
<td><p><span class="menuselection">テンプレート</span> の <span class="menuselection">ジョブタグ</span> にTAGSの値が設定される。</p></td>
<td><div class="line-block">
<div class="line">・TAGS:タグ名</div>
<div class="line">・複数個のパラメータを許容</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="line-block">
<div class="line">-b</div>
<div class="line">--become</div>
</div>
</td>
<td><div class="line-block">
<div class="line">-b</div>
<div class="line">--become</div>
</div>
</td>
<td><p><span class="menuselection">テンプレート</span> の <span class="menuselection">権限昇格の有効化</span> がチェックされる。</p></td>
<td><p>・少なくとも1つ指定すればパラメータが有効</p></td>
</tr>
<tr class="row-even"><td><div class="line-block">
<div class="line">-D</div>
<div class="line">--diff</div>
</div>
</td>
<td><div class="line-block">
<div class="line">-D</div>
<div class="line">--diff</div>
</div>
</td>
<td><p><span class="menuselection">テンプレート</span> の <span class="menuselection">変更</span> の表示が有効化される。</p></td>
<td><p>・少なくとも1つ指定すればパラメータが有効</p></td>
</tr>
<tr class="row-odd"><td><p>--skip-tags</p></td>
<td><p>--skip-tags=SKIP_TAGS</p></td>
<td><p><span class="menuselection">テンプレート</span> の <span class="menuselection">スキップタグ</span> にSKIP_TAGSの値が設定される。</p></td>
<td><div class="line-block">
<div class="line">・SKIP_TAGS:スキップタグ名</div>
<div class="line">・複数個のパラメータを許容</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p>--start-at-task</p></td>
<td><p>--start-at-task=START_AT_TASK</p></td>
<td><div class="line-block">
<div class="line">※Ansible Automation ControllerのWebUI には--start-at-taskの表示はありません。</div>
<div class="line">ansible-playbookコマンドの--start-at-taskと同様の扱いになります。</div>
</div>
</td>
<td><p>・複数定義した場合、最後に定義したパラメータが有効</p></td>
</tr>
<tr class="row-odd"><td><div class="line-block">
<div class="line">-ufc</div>
<div class="line">--use _fact_cache</div>
</div>
</td>
<td><div class="line-block">
<div class="line">-ufc</div>
<div class="line">--use_fact_cache</div>
</div>
</td>
<td><p><span class="menuselection">テンプレート</span> の <span class="menuselection">ファクトキャッシュの有効化</span> がチェックされる。</p></td>
<td><p>・少なくとも1つ指定すればパラメータが有効</p></td>
</tr>
<tr class="row-even"><td><div class="line-block">
<div class="line">-as</div>
<div class="line">--allow_simultaneous</div>
</div>
</td>
<td><div class="line-block">
<div class="line">-as</div>
<div class="line">--allow_simultaneous</div>
</div>
</td>
<td><p><span class="menuselection">テンプレート</span> の <span class="menuselection">同時実行ジョブの有効化</span> がチェックされる。</p></td>
<td><p>・少なくとも1つ指定すればパラメータが有効</p></td>
</tr>
<tr class="row-odd"><td><div class="line-block">
<div class="line">-jsc</div>
<div class="line">--jobslice_count</div>
</div>
</td>
<td><div class="line-block">
<div class="line">-jsc ジョブスライス数</div>
<div class="line">--job_slice_count=ジョブスライス数</div>
</div>
</td>
<td><p><span class="menuselection">テンプレート</span> の <span class="menuselection">ジョブスライス数</span> にジョブスライス数の値が設定される。</p></td>
<td><div class="line-block">
<div class="line">・ジョブスライス数には数値を指定</div>
<div class="line">・複数定義した場合、最後に定義したパラメータが有効</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line">※Ansible Automation Controllerのオプションパラメータの仕様については、Ansible Automation Controller公式マニュアルのユーザガイドのジョブテンプレートを参照してください。</div>
</div>
</section>
<section id="ansible-common-aac-resources-list">
<span id="id37"></span><h3><span class="section-number">1.6.5. </span>実行時データ削除で削除されるデータリソース<a class="headerlink" href="#ansible-common-aac-resources-list" title="Link to this heading">¶</a></h3>
<div class="line-block">
<div class="line"><span class="menuselection">Ansible共通 ▶ インターフェース情報</span> の <span class="menuselection">実行時データ削除</span> で「true」を選択した場合に、削除されるデータリソースは以下のとおりです。</div>
</div>
<section id="ansible-ansible-automation-controller">
<h4><span class="menuselection">Ansible共通 ▶ インターフェース情報</span> の <span class="menuselection">実行エンジン</span> が「Ansible Automation Controller」の場合<a class="headerlink" href="#ansible-ansible-automation-controller" title="Link to this heading">¶</a></h4>
<table class="docutils align-left" id="id90">
<caption><span class="caption-number">表 1.146 </span><span class="caption-text">実行時データ削除で削除されるデータリソース一覧(Ansible Automation Controller側)</span><a class="headerlink" href="#id90" title="Link to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>データリソース</p></th>
<th class="head"><p>リソースタイプ</p></th>
<th class="head"><p>備考</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ITA作業用ディレクトリ</p>
<p>/var/lib/exastro/ita_&lt;区分&gt;_executions_作業番号</p>
</td>
<td><p>ディレクトリ</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>SCM管理ディレクトリ</p>
<p>/var/lib/awx/projects/ita_&lt;区分&gt;_executions_作業番号</p>
</td>
<td><p>ディレクトリ</p></td>
<td><p>※プロジェクトリソースの削除により削除される</p></td>
</tr>
<tr class="row-even"><td><p>インベントリ</p>
<p>リソース名: ita_&lt;区分&gt;_executions_inventory_作業番号_通番</p>
</td>
<td><p>リソース</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>認証情報</p>
<p>リソース名: ita_&lt;区分&gt;_executions_credential_作業番号_通番</p>
<p>　　　　　　ita_&lt;区分&gt;_executions_vault_credential_作業番号</p>
<p>　　　　　　ita_&lt;区分&gt;_executions_git_credential_作業番号</p>
</td>
<td><p>リソース</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>プロジェクト</p>
<p>リソース名: ita_&lt;区分&gt;_executions_project_作業番号</p>
</td>
<td><p>リソース</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>ジョブテンプレート</p>
<p>リソース名: ita_&lt;区分&gt;_executions_jobtpl_作業番号_通番</p>
</td>
<td><p>リソース</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>ワークフロージョブテンプレート</p>
<p>リソース名: ita_&lt;区分&gt;_executions_workflowtpl_作業番号</p>
</td>
<td><p>リソース</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>ジョブ</p>
<p>リソース名: Job番号—ita_&lt;区分&gt;_executions_workflowtpl_作業番号</p>
<p>　　　　　　Job番号—ita_&lt;区分&gt;_executions_jobtpl_作業番号</p>
</td>
<td><p>リソース</p></td>
<td></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<div class="line-block">
<div class="line">&lt;区分&gt;: 作業実行したモード</div>
<div class="line">　　　　　legacy: legacy</div>
<div class="line">　　　　　legacy role: legacy_role</div>
<div class="line">　　　　　pioneer: pioneer</div>
</div>
</div>
<table class="docutils align-left" id="id91">
<caption><span class="caption-number">表 1.147 </span><span class="caption-text">実行時データ削除で削除されるデータリソース一覧(ITA側)</span><a class="headerlink" href="#id91" title="Link to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>データリソース</p></th>
<th class="head"><p>リソースタイプ</p></th>
<th class="head"><p>備考</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Git リポジトリ</p>
<p>/tmp/git_repositories/&lt;区分&gt;_作業番号</p>
</td>
<td><p>Gitリポジトリ</p></td>
<td><p>ディレクトリごと削除</p>
<p>※ <span class="menuselection">実行時データ削除</span> の
設定値に関係なく削除される。</p>
</td>
</tr>
</tbody>
</table>
</section>
<section id="ansible-ansible-execution-agent">
<h4><span class="menuselection">Ansible共通 ▶ インターフェース情報</span> の <span class="menuselection">実行エンジン</span> が「Ansible Execution Agent」の場合<a class="headerlink" href="#ansible-ansible-execution-agent" title="Link to this heading">¶</a></h4>
<table class="docutils align-left" id="id92">
<caption><span class="caption-number">表 1.148 </span><span class="caption-text">実行時データ削除で削除されるデータリソース一覧(Ansible Execution Agent側)</span><a class="headerlink" href="#id92" title="Link to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>データリソース</p></th>
<th class="head"><p>リソースタイプ</p></th>
<th class="head"><p>備考</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ITA作業用ディレクトリ</p>
<p>&lt;storage&gt;/&lt;org&gt;/&lt;ws&gt;/driver/ag_ansible_execution/&lt;区分&gt;/作業番号</p>
<p>&lt;storage&gt;/&lt;org&gt;/&lt;ws&gt;/ag_ansible_execution/status</p>
</td>
<td><p>ディレクトリ</p></td>
<td></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<div class="line-block">
<div class="line">&lt;storage&gt;: Ansible Execution Agentインストール時にSpecify full path for the data storage locationで設定したバス</div>
<div class="line">&lt;org&gt;:Ansible Execution Agentインストール時にInput ORGANIZATION_ID.で設定したORGANIZATION ID</div>
<div class="line">&lt;ws&gt;:Ansible Execution Agentインストール時にInput WORKSPACE_ID.で設定したWORKSPACE ID</div>
</div>
</div>
</section>
</section>
<section id="ansible-automation-controllerita">
<span id="ansible-common-ita-org-var-ipoint-note"></span><h3><span class="section-number">1.6.6. </span>Ansible Automation ControllerでITA独自変数を利用する場合の留意事項<a class="headerlink" href="#ansible-automation-controllerita" title="Link to this heading">¶</a></h3>
<div class="line-block">
<div class="line">下記ITA独自変数を利用してファイル出力をするPlyabookを含むMovementをクラスタ構成のAnsible Automation Controllerで作業実行した場合の留意事項について記載します。</div>
<div class="line"><br /></div>
<div class="line">　対象のITA独自変数</div>
<div class="line">　・ __workflowdir__</div>
<div class="line">　・ __conductor_workflowdir__</div>
<div class="line">　・ __movement_status_filepath__</div>
<div class="line">　・ __parameters_dir_for_epc__</div>
<div class="line">　・ __parameters_file_dir_for_epc__</div>
<div class="line">　・ __parameter_dir__</div>
<div class="line">　・ __parameters_file_dir__</div>
<div class="line"><br /></div>
</div>
<section id="id38">
<h4>ITA独自変数を利用して作成したファイルの取り扱い<a class="headerlink" href="#id38" title="Link to this heading">¶</a></h4>
<div class="line-block">
<div class="line">ITA独自変数を利用して作成したファイルの出力先ディレクトリパスはAnsible Automation ControllerのITA作業用ディレクトリ配下「/var/lib/exastro」に設定されます。Movement実行前に結果データをAnsible Automation Controller（各実行ノード）のITA作業用ディレクトリ配下「/var/lib/exastro」にファイル転送します。Movement実行でここに作成されたファイルは、Movement実行後に各Ansible Automation Controller（各実行ノード）より結果データに上書きモードでファイル転送します。同一ファイル名でファイルを作成している場合、更新したファイルが結果データに正しく反映されない場合があります。</div>
</div>
<figure class="align-center">
<a class="reference internal image-reference" href="../../_images/original_hensu.png"><img alt="../../_images/original_hensu.png" src="../../_images/original_hensu.png" style="width: 7.49606in; height: 5.84593in;" />
</a>
</figure>
<ol class="arabic">
<li><div class="line-block">
<div class="line">Movementをconductorから実行している場合、Movement実行前に該当conductorインスタンス配下のファイルをAnsible Automation Controller（各実行ノード）のITA作業用ディレクトリ配下にファイル転送</div>
</div>
</li>
<li><div class="line-block">
<div class="line">Movement実行前に該当Movement配下のファイルをAnsible Automation Controller（各実行ノード）のITA作業用ディレクトリにファイル転送</div>
</div>
</li>
<li><div class="line-block">
<div class="line">Movementをconductorから実行している場合、Movement実行後にAnsible Automation Controller（各実行ノード）のITA作業用ディレクトリの該当Movementで作成したファイルを結果データにファイル転送</div>
</div>
</li>
<li><div class="line-block">
<div class="line">Movement実行後にAnsible Automation Controller（各実行ノード）のITA作業用ディレクトリの該当conductorインスタンス配下に作成したファイルを結果データにファイル転送</div>
</div>
</li>
</ol>
</section>
<section id="id39">
<h4>留意事項<a class="headerlink" href="#id39" title="Link to this heading">¶</a></h4>
<ol class="arabic">
<li><div class="line-block">
<div class="line">ファイル名はansible「inventory_hostname」を含めるなどして、Movementに紐づいている作業対象ホスト毎に同一ファイル名に出力しないように工夫してください。</div>
</div>
</li>
<li><div class="line-block">
<div class="line">conductorから実行する場合、複数のMovementで同一ファイル名への出力しないよう工夫してください。</div>
</div>
</li>
</ol>
</section>
</section>
</section>
</section>


</div>


<div id="articleNavigation">
  <ul>
    <li class="prev"><a href="index.html" title="前のトピックへ"><span>前のトピックへ</span>Ansible ドライバ</a></li>
    <li class="next"><a href="ansible_legacy.html" title="次のトピックへ"><span>次のトピックへ</span><span class="section-number">2. </span>Ansible-Legacy</a></li>
  </ul>
</div>


<div id="pageTopLink">
  <a href="#container"><i>↑</i> Page Top</a>
</div>

</article>
</div>
</main>
</div><!-- End #contents -->
<div id="footer">
  <footer class="divInner">
    <small>Copyright © 2019-2025 NEC Corporation</small>
    <small><a href="/ja/2.5/terms/ja.html">サイト規約</a></small>
  </footer>
</div><!-- End #footer -->

<div id="overlay"></div>
<div id="grayBack"></div>

</div><!-- End #container -->
  </body>
</html>