# Exastro IT Automation 2.7.0

リリース日: 2025年12月05日

## 機能追加

### OASE受信アラート通知のメッセージキューイング機能 ([#2825](https://github.com/exastro-suite/exastro-it-automation/issues/2825))
OASEにおいて、外部システムから受信したアラート通知を効率的に処理するためのメッセージキューイング機能を実装しました。
この機能により、大量のアラート通知が同時に発生した場合でも、システムの負荷を分散し、確実に全ての通知を処理できるようになりました。
メッセージキューを活用することで、通知の取りこぼしを防ぎ、システム全体の安定性と信頼性が大幅に向上し、特に高負荷環境での運用において効果を発揮します。

### OASEエージェント予約変数の拡張とToken用変数追加 ([#2705](https://github.com/exastro-suite/exastro-it-automation/issues/2705), [#2655](https://github.com/exastro-suite/exastro-it-automation/issues/2655))
OASEエージェントで使用できる予約変数の種類を大幅に拡張し、より柔軟な設定が可能になりました。
例えば、認証トークン用の予約変数を使った場合、安全でセキュアな管理と連携が可能となります。
また、前回取得したイベント属性を利用することができるようになり、外部システムとの連携時に、今までは前回取得日時を基準にイベント取得をしていたことにより、取得の隙間で取りこぼしていたイベントを、もれなく取得できるようになりました。
これらの変数拡張により、様々な運用シナリオに対応でき、エージェントの設定作業が大幅に効率化されるとともに、運用の自動化レベルが向上します。

### ServiceNowとの連携機能
ServiceNowへの連携機能を新たに追加しました。この機能により、OASEのイベント情報をServiceNowに自動的に連携できるようになります。これによりインシデント管理の運用業務の効率化を実現します。連携内容はテンプレート機能を使用してカスタマイズでき、組織のニーズに合わせた柔軟な運用が実現できます。

### イベント種別・通知先組み合わせ別テンプレート管理機能 ([#2798](https://github.com/exastro-suite/exastro-it-automation/issues/2798))
OASEにおいて、イベント種別と通知先の組み合わせごとに個別の通知テンプレートを管理できる機能を追加しました。
この機能により、通知先（メール、Teams、ServiceNow等）に応じて異なる通知フォーマットを設定でき、受信者にとってより理解しやすい通知を送信することが可能になりました。

### イベントグルーピングとアクションデバウンス機能 ([#2577](https://github.com/exastro-suite/exastro-it-automation/issues/2577),[#2848](https://github.com/exastro-suite/exastro-it-automation/issues/2848))
短時間に発生する複数の関連イベントを集約し、一つのアクションとして実行するグルーピング・デバウンス機能を実装しました。
この機能により、類似する障害イベントが連続発生した場合でも、重複するアクションの実行を防ぎ、システムリソースの無駄遣いを削減できます。
設定した期間内に発生した関連イベントは自動的に集約され、最初のイベント発生から一度だけアクションが実行されるため、より効率的で安定した自動化運用が実現します。

### Ansible オーガナイゼーションID・ワークスペースID・オペレーション関連独自変数追加 ([#2731](https://github.com/exastro-suite/exastro-it-automation/issues/2731))
Ansible実行時に使用できる独自変数として、オーガナイゼーションID、ワークスペースID、およびオペレーション関連の変数を新たに追加しました。
これらの変数により、実行中のプレイブックからExastro IT Automation内部の識別情報にアクセスでき、より高度な自動化シナリオの実装が可能になりました。

### 参照系リソースの遷移機能 ([#2700](https://github.com/exastro-suite/exastro-it-automation/issues/2700))
実行履歴からオペレーションの詳細設定画面に直接アクセスできるようになり、設定確認や問題調査の際のユーザビリティが大幅に改善されます。
この機能により、関連する設定項目間の移動が簡単になり、設定内容の確認や修正作業の効率が大幅に向上しました。

### Ansible Automation Platform 2.5対応 ([#2610](https://github.com/exastro-suite/exastro-it-automation/issues/2610))
Ansible Automation Platform（AAP）の最新バージョン2.5への対応を実装しました。
この対応により、AAP 2.5の新機能や改善された機能を活用でき、より安定したAnsible実行環境が提供されます。
既存のAAP環境からのアップグレードもスムーズに行えるよう、互換性の確保と移行支援機能も含まれています。

### 重複排除([#2792](https://github.com/exastro-suite/exastro-it-automation/issues/2792)）
受信したイベントに対して重複排除を行うことにより複数のイベントを単一イベントとして統合する機能を追加しました。<br>
監視ツールやOASEエージェントで冗長構成をとる場合に、ユーザが指定した任意の条件を指定することによって、実質的に同一の複数イベントを、単一のものとして扱えるようになります。<br>
この機能により複数の通知が届くのを防ぎ、不要なルールの定義や重複した対応を回避できるため、運用担当者の混乱と負担を大幅に軽減、問題の根本原因を迅速に特定できるようになります。

## バグ修正

### Ansible変数の復活処理とグローバル変数単体利用の修正 ([#2622](https://github.com/exastro-suite/exastro-it-automation/issues/2622), [#2823](https://github.com/exastro-suite/exastro-it-automation/issues/2823))
Ansible変数管理において、廃止された変数を復活させる際に新規作成されてしまう問題と、グローバル変数（センシティブ）を単体で使用できない問題を修正しました。
これらの修正により、変数の再利用が適切に行われるようになり、既存の変数との関連性が保持され、運用の継続性が確保されます。
また、センシティブ情報を含むグローバル変数の単体利用が可能になったことで、セキュアな変数管理がより柔軟に行えるようになりました。

### Ansible実行エージェントのファイル読み書き問題修正 ([#2850](https://github.com/exastro-suite/exastro-it-automation/issues/2850))
一部のストレージの環境において、ita-api-ansible-execution-receiverでファイルの読み込み・書き込みができない問題を修正しました。
この修正により、Ansible実行時のファイル操作が正常に動作するようになり、プレイブック実行中のファイル処理に関する障害が解消されました。
特に大容量ファイルの処理や、実行エージェント環境でのファイル操作の安定性が向上し、より信頼性の高いAnsible実行が実現します。

### エクスポート・インポート機能のファイル参照問題修正 ([#2855](https://github.com/exastro-suite/exastro-it-automation/issues/2855), [#2858](https://github.com/exastro-suite/exastro-it-automation/issues/2858), [#2859](https://github.com/exastro-suite/exastro-it-automation/issues/2859))
メニューインポート後にファイルが参照できない問題、MySQL環境での履歴無しメニューエクスポート失敗、廃止レコードのファイルアップロード項目によるエクスポート異常を修正しました。
これらの修正により、エクスポート・インポート機能の信頼性が大幅に向上し、データベース環境に依存しない安定した動作が保証されます。
特に本番環境でのデータ移行や、バックアップ・リストア処理において、より安全で確実な操作が可能になりました。

### OASEルール判定ロジックの修正 ([#2472](https://github.com/exastro-suite/exastro-it-automation/issues/2472), [#2750](https://github.com/exastro-suite/exastro-it-automation/issues/2750), [#2833](https://github.com/exastro-suite/exastro-it-automation/issues/2833))
OASEのルール判定において、イベントの順序や優先度の処理が想定と異なる動作をしていた問題を修正しました。
A→Bの順序ルール設定時にBが先に到着した場合の処理や、想定外のイベント取り込み時の動作が正常化されました。
これらの修正により、より正確で予測可能なルール判定が行われるようになり、自動化アクションの信頼性が向上しました。

### OASE通知テンプレートバージョン不整合の修正 ([#2785](https://github.com/exastro-suite/exastro-it-automation/issues/2785), [#2854](https://github.com/exastro-suite/exastro-it-automation/issues/2854))
ドライバ追加時の通知テンプレートが旧バージョンになる問題や、バージョンアップ後にOASE未インストール環境で通知テンプレートが残る問題を修正しました。
これらの修正により、システム構成に応じた適切なテンプレート管理が行われ、不要なデータの残存が防止されます。
バージョンアップ時の整合性が保たれることで、システムの保守性とデータの一貫性が向上しました。

### マイグレーション処理の安定化 ([#2803](https://github.com/exastro-suite/exastro-it-automation/issues/2803), [#2813](https://github.com/exastro-suite/exastro-it-automation/issues/2813), [#2821](https://github.com/exastro-suite/exastro-it-automation/issues/2821))
2.5.4マイグレーション処理の失敗やMySQL環境でのマイグレーション失敗、バージョンアップと新規ワークスペースでのSQL差分問題を修正しました。
これらの修正により、データベース環境に依存しない安定したマイグレーション処理が実現され、バージョンアップ作業の信頼性が向上しました。
特に本番環境でのバージョンアップ時のリスクが大幅に軽減されます。

### その他のシステム安定性向上修正 ([#2714](https://github.com/exastro-suite/exastro-it-automation/issues/2714), [#2717](https://github.com/exastro-suite/exastro-it-automation/issues/2717), [#2831](https://github.com/exastro-suite/exastro-it-automation/issues/2831), [#2811](https://github.com/exastro-suite/exastro-it-automation/issues/2811), [#2816](https://github.com/exastro-suite/exastro-it-automation/issues/2816), [#2840](https://github.com/exastro-suite/exastro-it-automation/issues/2840), [#2806](https://github.com/exastro-suite/exastro-it-automation/issues/2806), [#2791](https://github.com/exastro-suite/exastro-it-automation/issues/2791))
メニュー画面の文言修正、イベント収集設定の認証トークン登録エラー、実行エージェント環境でのドライラン失敗、ファイル比較時の改行問題、REST API処理失敗、UI初期値問題、Terraform変数刈り取り失敗、ストレージパス設定不整合など、多数の細かなバグを修正しました。
これらの修正により、日常的な運用における様々な問題が解消され、システム全体の安定性と使いやすさが向上しました。

## 改善

### Ansible実行エージェントパフォーマンス向上 ([#2805](https://github.com/exastro-suite/exastro-it-automation/issues/2805))
Ansible実行エージェントの処理性能を大幅に改善し、大規模な自動化処理や並列実行時のスループットが向上しました。
これにより、大規模環境での運用において全体的な運用効率が向上します。

### OASEルール条件のXOR対応 ([#2849](https://github.com/exastro-suite/exastro-it-automation/issues/2849))
OASEのルール設定において、従来の「A or B」条件の表記を、従来からの動作に合わせ「A xor B」（排他的論理和）に修正しました。表記による仕様の誤解を防ぐことができるようになりました。

### OASEルール判定処理の高速化 ([#2822](https://github.com/exastro-suite/exastro-it-automation/issues/2822))
OASEのルール判定処理のアルゴリズムを最適化し、大量のイベント処理時のパフォーマンスが大幅に向上しました。
特に複雑なルール設定や大規模なイベント流入がある環境において、システムの応答性とスループットが大幅に改善されます。

### エージェント管理機能の改善 ([#2774](https://github.com/exastro-suite/exastro-it-automation/issues/2774), [#2835](https://github.com/exastro-suite/exastro-it-automation/issues/2835))
エージェント管理をエクスポート・インポート対象外に変更し、システム固有の設定として適切に管理されるようになりました。
また、Ansible実行エージェントのインストーラにsystemdユーザーサービスの永続実行設定を追加し、ユーザーログアウト後も永続的にエージェントが実行されるようになりました。
これらの改善により、エージェント運用の安定性と保守性が向上し、運用管理の負荷が軽減されます。

### OASEユーザーインターフェース改善 ([#2839](https://github.com/exastro-suite/exastro-it-automation/issues/2839), [#2838](https://github.com/exastro-suite/exastro-it-automation/issues/2838), [#2852](https://github.com/exastro-suite/exastro-it-automation/issues/2852))
フィルター条件設定画面での操作性向上、通知テンプレートでのITA独自変数表示、イベントフロー画面の軽量化など、ユーザーインターフェースを改善しました。
これらの改善により、設定作業の効率性と画面の応答性が向上し、日常的な運用作業の負荷が軽減されます。
特にイベントフロー画面の軽量化により、大量のイベント表示時でも快適な操作性が維持されます。

### Conductor通知先定義のURL項目長拡張 ([#2814](https://github.com/exastro-suite/exastro-it-automation/issues/2814))
Conductorの通知先定義で設定できるURLの最大文字数を拡張し、より長いURLの設定が可能になりました。
この改善により、複雑なクエリパラメータを含むWebhook URLや、長いドメイン名を持つ通知先URLも設定できるようになりました。
特にクラウドサービスのWebhook URLや、詳細なパラメータを含む通知先を使用する場合に、設定の制約が大幅に緩和されます。

### システム基盤の改善 ([#2853](https://github.com/exastro-suite/exastro-it-automation/issues/2853), [#2836](https://github.com/exastro-suite/exastro-it-automation/issues/2836), [#2842](https://github.com/exastro-suite/exastro-it-automation/issues/2842), [#2799](https://github.com/exastro-suite/exastro-it-automation/issues/2799), [#2856](https://github.com/exastro-suite/exastro-it-automation/issues/2856))
setuptoolsインストール失敗時のビルド安定化、エージェントリクエストタイムアウト設定追加、API通信タイムアウト設定、GitLabのLiveness Probe対応、deepdiffバージョンアップなど、システム基盤の改善を実施しました。
これらの改善により、システムの安定性、可用性、保守性が向上し、運用時のトラブル発生リスクが軽減されました。

### 非推奨API案内 ([#2720](https://github.com/exastro-suite/exastro-it-automation/issues/2720))
システムの保守性向上とユーザーの安全な移行を支援するため、非推奨となったAPIをドキュメント内で明示するようにしました。
